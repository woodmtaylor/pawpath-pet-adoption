=== ./backend/src/middleware/AuthMiddleware.php ===
<?php
// backend/src/middleware/AuthMiddleware.php

namespace PawPath\middleware;

use Psr\Http\Message\ServerRequestInterface as Request;
use Psr\Http\Server\RequestHandlerInterface as RequestHandler;
use Slim\Psr7\Response;
use PawPath\services\AuthService;  // Changed from PawPath\Services\AuthService

class AuthMiddleware
{
    private AuthService $authService;
    
    public function __construct()
    {
        $this->authService = new AuthService();
    }
    
    public function __invoke(Request $request, RequestHandler $handler): Response
    {
        error_log('Processing auth middleware');
        
        $token = $this->extractToken($request);
        
        if (!$token) {
            error_log('No token provided - returning 401');
            $response = new Response();
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'No token provided'
            ]));
            return $response
                ->withStatus(401)
                ->withHeader('Content-Type', 'application/json');
        }
        
        try {
            $payload = $this->authService->validateToken($token);
            if (!$payload) {
                throw new \Exception('Invalid token');
            }
            
            error_log('Token validated successfully for user: ' . ($payload['user_id'] ?? 'unknown'));
            $request = $request->withAttribute('user_id', $payload['user_id']);
            return $handler->handle($request);
            
        } catch (\Exception $e) {
            error_log('Token validation failed: ' . $e->getMessage());
            $response = new Response();
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Invalid token'
            ]));
            return $response
                ->withStatus(401)
                ->withHeader('Content-Type', 'application/json');
        }
    }
    
    private function extractToken(Request $request): ?string
    {
        $header = $request->getHeaderLine('Authorization');
        
        if (empty($header)) {
            error_log('No Authorization header found');
            return null;
        }
        
        if (preg_match('/Bearer\s+(.*)$/i', $header, $matches)) {
            error_log('Token extracted: ' . substr($matches[1], 0, 10) . '...');
            return $matches[1];
        }
        
        error_log('Invalid Authorization header format');
        return null;
    }
}
=== ./backend/src/middleware/RoleMiddleware.php ===
<?php
namespace PawPath\middleware;

use Psr\Http\Message\ServerRequestInterface as Request;
use Psr\Http\Server\RequestHandlerInterface as RequestHandler;
use Slim\Psr7\Response;
use PawPath\config\Permissions;

class RoleMiddleware
{
    private string $requiredRole;
    
    public function __construct(string $role)
    {
        $this->requiredRole = $role;
    }
    
    public function __invoke(Request $request, RequestHandler $handler): Response
    {
        $userId = $request->getAttribute('user_id');
        
        // Get user from the database
        $db = \PawPath\config\database\DatabaseConfig::getConnection();
        $stmt = $db->prepare("SELECT role FROM User WHERE user_id = ?");
        $stmt->execute([$userId]);
        $user = $stmt->fetch();
        
        if (!$user) {
            $response = new Response();
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Authentication required'
            ]));
            return $response->withStatus(401)
                           ->withHeader('Content-Type', 'application/json');
        }
        
        // Get role hierarchy
        $roleHierarchy = [
            'admin' => ['admin'],
            'shelter_staff' => ['admin', 'shelter_staff'],
            'adopter' => ['admin', 'shelter_staff', 'adopter']
        ];
        
        // Check if user's role has permission
        if (!in_array($user['role'], $roleHierarchy[$this->requiredRole] ?? [])) {
            $response = new Response();
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Insufficient permissions'
            ]));
            return $response->withStatus(403)
                           ->withHeader('Content-Type', 'application/json');
        }
        
        // Add user to request attributes
        $request = $request->withAttribute('user', [
            'user_id' => $userId,
            'role' => $user['role']
        ]);
        
        return $handler->handle($request);
    }
}
=== ./backend/src/config/Permissions.php ===
<?php
namespace PawPath\config;

class Permissions {
    // User roles
    public const ROLE_ADMIN = 'admin';
    public const ROLE_SHELTER_STAFF = 'shelter_staff';
    public const ROLE_ADOPTER = 'adopter';
    
    // Permission sets by role
    public const PERMISSIONS = [
        self::ROLE_ADMIN => [
            'users:manage',
            'shelters:manage',
            'pets:manage',
            'applications:manage',
            'blog:manage',
            'products:manage'
        ],
        self::ROLE_SHELTER_STAFF => [
            'pets:create',
            'pets:update',
            'pets:delete',
            'applications:view',
            'applications:process'
        ],
        self::ROLE_ADOPTER => [
            'pets:view',
            'applications:create',
            'applications:view-own',
            'profile:manage-own'
        ]
    ];
    
    public static function hasPermission(string $role, string $permission): bool {
        return isset(self::PERMISSIONS[$role]) && 
               in_array($permission, self::PERMISSIONS[$role]);
    }
    
    public static function validateRole(string $role): bool {
        return in_array($role, [self::ROLE_ADMIN, self::ROLE_SHELTER_STAFF, self::ROLE_ADOPTER]);
    }
}
=== ./backend/src/config/email/EmailConfig.php ===
<?php
namespace PawPath\config\email;

class EmailConfig {
    public static function getConfig(): array {
        $env = $_ENV['APP_ENV'] ?? 'development';
        
        if ($env === 'development') {
            // Use Mailtrap in development
            return [
                'host' => 'sandbox.smtp.mailtrap.io',
                'port' => 2525,
                'username' => $_ENV['MAILTRAP_USERNAME'],
                'password' => $_ENV['MAILTRAP_PASSWORD'],
                'encryption' => 'tls',
                'from_address' => 'testing@pawpath.com',
                'from_name' => 'PawPath Testing'
            ];
        } else {
            // Use production settings (Gmail or other SMTP)
            return [
                'host' => $_ENV['MAIL_HOST'],
                'port' => $_ENV['MAIL_PORT'],
                'username' => $_ENV['MAIL_USERNAME'],
                'password' => $_ENV['MAIL_PASSWORD'],
                'encryption' => 'tls',
                'from_address' => $_ENV['MAIL_FROM_ADDRESS'],
                'from_name' => $_ENV['MAIL_FROM_NAME']
            ];
        }
    }
}
=== ./backend/src/config/database/DatabaseConfig.php ===
<?php
// backend/src/config/database/DatabaseConfig.php

namespace PawPath\config\database;

use PDO;
use PDOException;

class DatabaseConfig {
    private static ?PDO $connection = null;
    
    public static function getConnection(): PDO {
        if (self::$connection === null) {
            try {
                // Get environment variables
                $dotenv = \Dotenv\Dotenv::createImmutable(__DIR__ . '/../../../');
                $dotenv->load();

                // Debug environment variables
                error_log("Environment variables:");
                error_log("DB_HOST: " . ($_ENV['DB_HOST'] ?? 'not set'));
                error_log("DB_PORT: " . ($_ENV['DB_PORT'] ?? 'not set'));
                error_log("DB_DATABASE: " . ($_ENV['DB_DATABASE'] ?? 'not set'));
                error_log("DB_USERNAME: " . ($_ENV['DB_USERNAME'] ?? 'not set'));
                error_log("DB_PASSWORD is set: " . (isset($_ENV['DB_PASSWORD']) ? 'Yes' : 'No'));
                
                // Use exact matches to your .env file
                $host = $_ENV['DB_HOST'] ?? 'localhost';
                $port = $_ENV['DB_PORT'] ?? '3306';
                $dbName = $_ENV['DB_DATABASE'] ?? 'pawpath';
                $username = $_ENV['DB_USERNAME'] ?? 'root';
                $password = $_ENV['DB_PASSWORD'] ?? '';
                
                $dsn = "mysql:host=$host;port=$port;dbname=$dbName;charset=utf8mb4";
                
                error_log("Attempting to connect with DSN: $dsn");
                error_log("Username: $username");
                
                self::$connection = new PDO(
                    $dsn,
                    $username,
                    $password,
                    [
                        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
                        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
                        PDO::ATTR_EMULATE_PREPARES => false
                    ]
                );
                
                error_log("Database connection successful");
            } catch (PDOException $e) {
                error_log("Database connection failed: " . $e->getMessage());
                throw new PDOException("Connection failed: " . $e->getMessage());
            }
        }
        
        return self::$connection;
    }
}
=== ./backend/src/api/PetController.php ===
<?php
namespace PawPath\api;

use PawPath\services\PetService;
use PawPath\services\ImageUploadService;
use PawPath\models\PetImage;
use PawPath\config\database\DatabaseConfig;
use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;
use PawPath\utils\ResponseHelper;
use PDO;

class PetController {
    private PetService $petService;
    private ImageUploadService $imageService;
    private PetImage $petImageModel;
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
        $this->petService = new PetService();
        $this->imageService = new ImageUploadService();
        $this->petImageModel = new PetImage();
    }

    public function createPet(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            error_log('Creating pet with data: ' . print_r($data, true));
            
            if (!is_array($data)) {
                $body = (string) $request->getBody();
                $data = json_decode($body, true);
                error_log('Parsed JSON data: ' . print_r($data, true));
                
                if (json_last_error() !== JSON_ERROR_NONE) {
                    throw new \RuntimeException('Invalid JSON data provided: ' . json_last_error_msg());
                }
            }
            
            if (empty($data)) {
                throw new \RuntimeException('No data provided');
            }
            
            $result = $this->petService->createPet($data);
            error_log('Pet creation result: ' . print_r($result, true));
            
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => $result
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(201);
        } catch (\Exception $e) {
            error_log('Error creating pet: ' . $e->getMessage() . "\n" . $e->getTraceAsString());
            
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => $e->getMessage(),
                'trace' => $e->getTraceAsString() // Remove in production
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
       

    public function getPet(Request $request, Response $response, array $args): Response {
        try {
            $petId = (int) $args['id'];
            
            // Add debugging for image lookup
            $stmt = $this->db->prepare("SELECT * FROM Pet_Image WHERE pet_id = ?");
            $stmt->execute([$petId]);
            $images = $stmt->fetchAll();
            error_log("Images for pet $petId: " . print_r($images, true));
            
            $result = $this->petService->getPet($petId);
            error_log("Complete pet data: " . print_r($result, true));
            
            return ResponseHelper::sendResponse($response, $result);
        } catch (\Exception $e) {
            error_log('Error getting pet: ' . $e->getMessage());
            return ResponseHelper::sendError($response, $e->getMessage(), 404);
        }
    }
        
    public function listPets(Request $request, Response $response): Response {
        try {
            $queryParams = $request->getQueryParams();
            error_log("Received request params: " . print_r($queryParams, true));
            
            $page = isset($queryParams['page']) ? (int)$queryParams['page'] : 1;
            $perPage = isset($queryParams['perPage']) ? (int)$queryParams['perPage'] : 12;
            $offset = ($page - 1) * $perPage;

            $queryParams['offset'] = $offset;
            $queryParams['limit'] = $perPage;
            
            $result = $this->petService->listPets($queryParams);
            error_log("Pet list result: " . print_r($result, true));
            
            return ResponseHelper::sendResponse($response, [
                'items' => $result['pets'],
                'total' => $result['total'],
                'page' => $page,
                'perPage' => $perPage
            ]);
        } catch (\Exception $e) {
            error_log("Error in listPets: " . $e->getMessage());
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }
    
    public function updatePet(Request $request, Response $response, array $args): Response {
        try {
            $petId = (int) $args['id'];
            $data = $request->getParsedBody();
            
            if (!is_array($data)) {
                $body = (string) $request->getBody();
                $data = json_decode($body, true);
                
                if (json_last_error() !== JSON_ERROR_NONE) {
                    throw new \RuntimeException('Invalid JSON data provided');
                }
            }
            
            $result = $this->petService->updatePet($petId, $data);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error updating pet: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
    
    public function deletePet(Request $request, Response $response, array $args): Response {
        try {
            $petId = (int) $args['id'];
            $this->petService->deletePet($petId);
            
            return $response->withStatus(204);
        } catch (\Exception $e) {
            error_log('Error deleting pet: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
    
    public function createTrait(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            
            if (!is_array($data) || !isset($data['trait_name'])) {
                throw new \RuntimeException('trait_name is required');
            }
            
            $result = $this->petService->addTrait($data['trait_name']);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(201);
        } catch (\Exception $e) {
            error_log('Error creating trait: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
    
    public function listTraits(Request $request, Response $response): Response {
        try {
            $traits = $this->petService->listTraits();
            
            // Transform the data to match the frontend's expectations
            $traitsData = array_map(function($trait) {
                return [
                    'trait_id' => $trait['trait_id'],
                    'trait_name' => $trait['trait_name']
                ];
            }, $traits);
            
            return ResponseHelper::sendResponse($response, [
                'traits' => $traitsData
            ]);
        } catch (\Exception $e) {
            error_log('Error listing traits: ' . $e->getMessage());
            return ResponseHelper::sendError($response, 'Failed to fetch traits', 500);
        }
    }

    public function uploadImages(Request $request, Response $response, array $args): Response {
        try {
            $petId = (int) $args['id'];
            $uploadedFiles = $request->getUploadedFiles();
            
            if (empty($uploadedFiles['images'])) {
                throw new \RuntimeException('No images uploaded');
            }
            
            $images = $uploadedFiles['images'];
            if (!is_array($images)) {
                $images = [$images];
            }
            
            $uploadedImages = [];
            foreach ($images as $index => $image) {
                $imageUrl = $this->imageService->uploadImage([
                    'tmp_name' => $image->getStream()->getMetadata('uri'),
                    'error' => $image->getError(),
                    'type' => $image->getClientMediaType()
                ]);
                
                $imageId = $this->petImageModel->create(
                    $petId, 
                    $imageUrl, 
                    $index === 0 && empty($this->petImageModel->findByPetId($petId))
                );
                
                $uploadedImages[] = [
                    'image_id' => $imageId,
                    'url' => $imageUrl
                ];
            }
            
            return ResponseHelper::sendResponse($response, $uploadedImages, 201);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage(), 400);
        }
    }
    
    public function deleteImage(Request $request, Response $response, array $args): Response {
        try {
            $petId = (int) $args['id'];
            $imageId = (int) $args['imageId'];
            
            $images = $this->petImageModel->findByPetId($petId);
            $imageToDelete = array_filter($images, fn($img) => $img['image_id'] === $imageId);
            
            if (empty($imageToDelete)) {
                throw new \RuntimeException('Image not found');
            }
            
            $image = reset($imageToDelete);
            $this->imageService->deleteImage($image['image_url']);
            $this->petImageModel->delete($imageId, $petId);
            
            return ResponseHelper::sendResponse($response, ['message' => 'Image deleted successfully']);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage(), 400);
        }
    }
    
    public function setPrimaryImage(Request $request, Response $response, array $args): Response {
        try {
            $petId = (int) $args['id'];
            $imageId = (int) $args['imageId'];
            
            $this->petImageModel->setPrimary($imageId, $petId);
            
            return ResponseHelper::sendResponse($response, ['message' => 'Primary image updated successfully']);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage(), 400);
        }
    }
}
=== ./backend/src/api/UserProfileController.php ===
<?php
namespace PawPath\api;

use PawPath\models\UserProfile;
use PawPath\utils\ResponseHelper;
use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;

class UserProfileController {
    private UserProfile $profileModel;
    
    public function __construct() {
        $this->profileModel = new UserProfile();
    }
    
    public function getProfile(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $profile = $this->profileModel->findByUserId($userId);
            
            if (!$profile) {
                return ResponseHelper::sendError($response, "Profile not found", 404);
            }
            
            return ResponseHelper::sendResponse($response, $profile);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }
    
    public function updateProfile(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $data = $request->getParsedBody();
            
            // Validate required fields
            $requiredFields = ['first_name', 'last_name', 'phone'];
            foreach ($requiredFields as $field) {
                if (empty($data[$field])) {
                    return ResponseHelper::sendError(
                        $response, 
                        "Missing required field: $field",
                        400
                    );
                }
            }
            
            // Check if profile exists
            $existingProfile = $this->profileModel->findByUserId($userId);
            
            if ($existingProfile) {
                $success = $this->profileModel->update($userId, $data);
            } else {
                $data['user_id'] = $userId;
                $profileId = $this->profileModel->create($data);
                $success = $profileId > 0;
            }
            
            if (!$success) {
                return ResponseHelper::sendError(
                    $response,
                    "Failed to update profile",
                    400
                );
            }
            
            $updatedProfile = $this->profileModel->findByUserId($userId);
            return ResponseHelper::sendResponse($response, $updatedProfile);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }
}
=== ./backend/src/api/BlogController.php ===
<?php
// src/api/BlogController.php
namespace PawPath\api;

use PawPath\services\BlogService;
use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;

class BlogController {
    private BlogService $blogService;
    
    public function __construct() {
        $this->blogService = new BlogService();
    }
    
    public function createPost(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            $data['author_id'] = $request->getAttribute('user_id');
            
            $result = $this->blogService->createPost($data);
            
            $response->getBody()->write(json_encode($result));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(201);
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
    
    public function getPost(Request $request, Response $response, array $args): Response {
        try {
            $postId = (int) $args['id'];
            $result = $this->blogService->getPost($postId);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(404);
        }
    }
    
    public function listPosts(Request $request, Response $response): Response {
        try {
            $filters = $request->getQueryParams();
            $result = $this->blogService->listPosts($filters);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
    
    public function updatePost(Request $request, Response $response, array $args): Response {
        try {
            $postId = (int) $args['id'];
            $data = $request->getParsedBody();
            
            // Verify user is the author
            $userId = $request->getAttribute('user_id');
            $result = $this->blogService->updatePost($postId, $data, $userId);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
    
    public function deletePost(Request $request, Response $response, array $args): Response {
        try {
            $postId = (int) $args['id'];
            $userId = $request->getAttribute('user_id');
            
            $this->blogService->deletePost($postId, $userId);
            
            return $response->withStatus(204);
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
}
=== ./backend/src/api/QuizController.php ===
<?php
namespace PawPath\api;

use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;
use PawPath\services\QuizService;
use PawPath\models\StartingQuiz;

class QuizController {
    private QuizService $quizService;
    private StartingQuiz $startingQuiz;
    
    public function __construct() {
        $this->quizService = new QuizService();
        $this->startingQuiz = new StartingQuiz();
    }
    
    /**
     * Initialize a new quiz and return questions
     */
    public function startQuiz(Request $request, Response $response): Response {
        try {
            $questions = $this->quizService->getQuizQuestions();
            
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => [
                    'questions' => $questions,
                    'total_sections' => count($questions['sections']),
                    'estimated_time' => '5-10 minutes'
                ]
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(200);
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Failed to initialize quiz',
                'message' => $e->getMessage()
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(500);
        }
    }
    
    /**
     * Submit quiz answers and get recommendations
     */
    public function submitQuiz(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $data = json_decode((string)$request->getBody(), true);
            
            if (json_last_error() !== JSON_ERROR_NONE) {
                throw new \InvalidArgumentException('Invalid JSON data: ' . json_last_error_msg());
            }
            
            if (empty($data['answers'])) {
                throw new \InvalidArgumentException('Quiz answers are required');
            }
            
            // Process quiz and get recommendations
            $result = $this->quizService->processQuiz($userId, $data['answers']);
            
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => [
                    'quiz_id' => $result['quiz_id'],
                    'recommendations' => [
                        'species' => $result['recommendations']['recommended_species'],
                        'breed' => $result['recommendations']['recommended_breed'],
                        'traits' => $result['recommendations']['trait_preferences']
                    ],
                    'confidence_score' => $result['confidence_score'],
                    'matching_pets' => $result['matching_pets']
                ]
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(200);
        } catch (\InvalidArgumentException $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Invalid quiz submission',
                'message' => $e->getMessage()
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        } catch (\Exception $e) {
            // Add error logging
            error_log("Quiz submission error: " . $e->getMessage());
            error_log("Stack trace: " . $e->getTraceAsString());
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Failed to process quiz',
                'message' => $e->getMessage()
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(500);
        }
    }
    
    /**
     * Get quiz history for a user
     */
    public function getQuizHistory(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $history = $this->startingQuiz->findByUser($userId);
            
            // Process history to include more readable data
            $processedHistory = array_map(function($entry) {
                return [
                    'quiz_id' => $entry['quiz_id'],
                    'date_taken' => $entry['quiz_date'],
                    'recommendations' => [
                        'species' => $entry['recommended_species'],
                        'breed' => $entry['recommended_breed'],
                        'traits' => json_decode($entry['trait_preferences'] ?? '{}', true)
                    ]
                ];
            }, $history);
            
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => [
                    'history' => $processedHistory,
                    'total_quizzes' => count($history)
                ]
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(200);
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Failed to retrieve quiz history',
                'message' => $e->getMessage()
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(500);
        }
    }
    
    /**
     * Get specific quiz result
     */
    public function getQuizResult(Request $request, Response $response, array $args): Response {
        try {
            $quizId = (int) $args['id'];
            $userId = $request->getAttribute('user_id');
            
            // Get quiz and verify it belongs to the user
            $quiz = $this->startingQuiz->findById($quizId);
            
            if (!$quiz) {
                throw new \InvalidArgumentException('Quiz not found');
            }
            
            if ($quiz['user_id'] !== $userId) {
                throw new \InvalidArgumentException('Unauthorized access to quiz result');
            }
            
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => [
                    'quiz_id' => $quiz['quiz_id'],
                    'date_taken' => $quiz['quiz_date'],
                    'recommendations' => [
                        'species' => $quiz['recommended_species'],
                        'breed' => $quiz['recommended_breed'],
                        'traits' => json_decode($quiz['trait_preferences'] ?? '{}', true)
                    ]
                ]
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(200);
        } catch (\InvalidArgumentException $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Invalid quiz request',
                'message' => $e->getMessage()
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => 'Failed to retrieve quiz result',
                'message' => $e->getMessage()
            ]));
            
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(500);
        }
    }
}
=== ./backend/src/api/ProductController.php ===
<?php
// src/api/ProductController.php
namespace PawPath\api;

use PawPath\services\ProductService;
use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;

class ProductController {
    private ProductService $productService;
    
    public function __construct() {
        $this->productService = new ProductService();
    }
    
    public function createProduct(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            
            $result = $this->productService->createProduct($data);
            
            $response->getBody()->write(json_encode($result));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(201);
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
    
    public function getProduct(Request $request, Response $response, array $args): Response {
        try {
            $productId = (int) $args['id'];
            $result = $this->productService->getProduct($productId);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(404);
        }
    }
    
    public function listProducts(Request $request, Response $response): Response {
        try {
            $filters = $request->getQueryParams();
            $result = $this->productService->listProducts($filters);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
    
    public function updateProduct(Request $request, Response $response, array $args): Response {
        try {
            $productId = (int) $args['id'];
            $data = $request->getParsedBody();
            
            $result = $this->productService->updateProduct($productId, $data);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
    
    public function deleteProduct(Request $request, Response $response, array $args): Response {
        try {
            $productId = (int) $args['id'];
            $this->productService->deleteProduct($productId);
            
            return $response->withStatus(204);
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response
                ->withHeader('Content-Type', 'application/json')
                ->withStatus(400);
        }
    }
}
=== ./backend/src/api/ShelterController.php ===
<?php
// backend/src/api/ShelterController.php

namespace PawPath\api;

use PawPath\services\ShelterService;
use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;

class ShelterController {
    private ShelterService $shelterService;
    
    public function __construct() {
        $this->shelterService = new ShelterService();
    }
    
    public function createShelter(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            error_log('Creating shelter with data: ' . print_r($data, true));
            
            if (!is_array($data)) {
                $body = (string) $request->getBody();
                $data = json_decode($body, true);
                
                if (json_last_error() !== JSON_ERROR_NONE) {
                    throw new \RuntimeException('Invalid JSON data provided');
                }
            }
            
            $result = $this->shelterService->createShelter($data);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(201);
        } catch (\Exception $e) {
            error_log('Error creating shelter: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
    
    public function getShelter(Request $request, Response $response, array $args): Response {
        try {
            $shelterId = (int) $args['id'];
            $result = $this->shelterService->getShelter($shelterId);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error getting shelter: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(404);
        }
    }
    
    public function listShelters(Request $request, Response $response): Response {
        try {
            $queryParams = $request->getQueryParams();
            $filters = [];
            
            // Handle search parameter
            if (!empty($queryParams['search'])) {
                $filters['search'] = $queryParams['search'];
            }
            
            // Handle no-kill filter
            if (isset($queryParams['is_no_kill'])) {
                $filters['is_no_kill'] = (bool) $queryParams['is_no_kill'];
            }
            
            $result = $this->shelterService->listShelters($filters);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error listing shelters: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(500);
        }
    }
    
    public function updateShelter(Request $request, Response $response, array $args): Response {
        try {
            $shelterId = (int) $args['id'];
            $data = $request->getParsedBody();
            
            if (!is_array($data)) {
                $body = (string) $request->getBody();
                $data = json_decode($body, true);
                
                if (json_last_error() !== JSON_ERROR_NONE) {
                    throw new \RuntimeException('Invalid JSON data provided');
                }
            }
            
            $result = $this->shelterService->updateShelter($shelterId, $data);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error updating shelter: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
    
    public function deleteShelter(Request $request, Response $response, array $args): Response {
        try {
            $shelterId = (int) $args['id'];
            $this->shelterService->deleteShelter($shelterId);
            
            return $response->withStatus(204);
        } catch (\Exception $e) {
            error_log('Error deleting shelter: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
}
=== ./backend/src/api/AdoptionController.php ===
<?php
// backend/src/api/AdoptionController.php

namespace PawPath\api;

use PawPath\utils\ResponseHelper;
use PawPath\services\AdoptionService;
use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;

class AdoptionController {
    private AdoptionService $adoptionService;
    
    public function __construct() {
        $this->adoptionService = new AdoptionService();
    }
    
    public function submitApplication(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $data = $request->getParsedBody();
            
            if (!isset($data['pet_id'])) {
                throw new \RuntimeException('pet_id is required');
            }
            
            // Add application details to the database
            $result = $this->adoptionService->createApplication([
                'user_id' => $userId,
                'pet_id' => (int) $data['pet_id'],
                'reason' => $data['reason'] ?? null,
                'experience' => $data['experience'] ?? null,
                'living_situation' => $data['living_situation'] ?? null,
                'has_other_pets' => $data['has_other_pets'] ?? false,
                'other_pets_details' => $data['other_pets_details'] ?? null,
                'daily_schedule' => $data['daily_schedule'] ?? null,
                'veterinarian' => $data['veterinarian'] ?? null,
                'status' => 'pending'
            ]);
            
            return ResponseHelper::sendResponse($response, $result, 201);
        } catch (\Exception $e) {
            return ResponseHelper::sendError(
                $response, 
                $e->getMessage(),
                400
            );
        }
    }
    
    public function getUserApplications(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $applications = $this->adoptionService->getUserApplications($userId);
            
            return ResponseHelper::sendResponse($response, $applications);
        } catch (\Exception $e) {
            error_log('Error getting user applications: ' . $e->getMessage());
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }
    
    public function getShelterApplications(Request $request, Response $response, array $args): Response {
        try {
            $shelterId = (int) $args['shelter_id'];
            $result = $this->adoptionService->getShelterApplications($shelterId);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error getting shelter applications: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
    
    public function getApplication(Request $request, Response $response, array $args): Response {
        try {
            $applicationId = (int) $args['id'];
            $result = $this->adoptionService->getApplication($applicationId);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error getting application: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(404);
        }
    }
    
    public function updateApplicationStatus(Request $request, Response $response, array $args): Response {
        try {
            $applicationId = (int) $args['id'];
            $data = $request->getParsedBody();
            
            if (!isset($data['status'])) {
                throw new \RuntimeException('status is required');
            }
            
            $result = $this->adoptionService->updateApplicationStatus(
                $applicationId,
                $data['status']
            );
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error updating application status: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
    
    public function getPetApplications(Request $request, Response $response, array $args): Response {
        try {
            $petId = (int) $args['pet_id'];
            $result = $this->adoptionService->getPetApplications($petId);
            
            $response->getBody()->write(json_encode($result));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            error_log('Error getting pet applications: ' . $e->getMessage());
            
            $response->getBody()->write(json_encode([
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    }
}
=== ./backend/src/api/AuthController.php ===
<?php
namespace PawPath\api;

use PawPath\services\AuthService;
use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;
use PawPath\utils\ResponseHelper;

class AuthController {
    private AuthService $authService;
    
    public function __construct() {
        $this->authService = new AuthService();
    }

    public function register(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            error_log('Registration attempt: ' . print_r($data, true));
            
            if (empty($data['email']) || empty($data['password']) || empty($data['username'])) {
                return ResponseHelper::sendError($response, 'Missing required fields', 400);
            }
            
            $result = $this->authService->register($data);
            
            // Try to send verification email
            try {
                $emailService = new EmailService();
                $emailService->sendVerificationEmail(
                    $data['email'],
                    $data['username'],
                    $result['user']['email_verification_token']
                );
            } catch (\Exception $e) {
                // Log email error but don't fail registration
                error_log('Failed to send verification email: ' . $e->getMessage());
            }
            
            return ResponseHelper::sendResponse($response, $result, 201);
            
        } catch (\Exception $e) {
            error_log('Registration error: ' . $e->getMessage());
            return ResponseHelper::sendError(
                $response, 
                $e->getMessage(), 
                $e instanceof RuntimeException ? 400 : 500
            );
        }
    }
    
    public function login(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            error_log('Login attempt for email: ' . ($data['email'] ?? 'not provided'));
            
            if (empty($data['email']) || empty($data['password'])) {
                return ResponseHelper::sendError($response, 'Email and password are required', 400);
            }
            
            $result = $this->authService->login($data);
            return ResponseHelper::sendResponse($response, $result);
            
        } catch (\Exception $e) {
            error_log('Login error: ' . $e->getMessage());
            error_log('Stack trace: ' . $e->getTraceAsString());
            return ResponseHelper::sendError(
                $response, 
                'An error occurred during login. Please try again.', 
                500
            );
        }
    }

    public function getCurrentUser(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $user = $this->authService->getUser($userId);
            
            if (!$user) {
                throw new \RuntimeException('User not found');
            }
            
            return ResponseHelper::sendResponse($response, [
                'user' => $user
            ]);
        } catch (\Exception $e) {
            error_log('Error getting current user: ' . $e->getMessage());
            return ResponseHelper::sendError(
                $response, 
                'Failed to get user information', 
                500
            );
        }
    }

    public function verifyEmail(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            
            if (empty($data['token'])) {
                return ResponseHelper::sendError($response, 'Verification token is required', 400);
            }
            
            $result = $this->authService->verifyEmailToken($data['token']);
            return ResponseHelper::sendResponse($response, [
                'message' => 'Email verified successfully'
            ]);
        } catch (\Exception $e) {
            error_log('Email verification error: ' . $e->getMessage());
            return ResponseHelper::sendError($response, 'Failed to verify email', 500);
        }
    }

    public function resendVerification(Request $request, Response $response): Response {
        try {
            $userId = $request->getAttribute('user_id');
            $result = $this->authService->resendVerificationEmail($userId);
            
            return ResponseHelper::sendResponse($response, [
                'message' => 'Verification email sent successfully'
            ]);
        } catch (\Exception $e) {
            error_log('Resend verification error: ' . $e->getMessage());
            return ResponseHelper::sendError(
                $response, 
                'Failed to resend verification email', 
                500
            );
        }
    }
}
=== ./backend/src/api/AdminController.php ===
<?php
namespace PawPath\api;

use Psr\Http\Message\ResponseInterface as Response;
use Psr\Http\Message\ServerRequestInterface as Request;
use PawPath\models\User;
use PawPath\models\Shelter;
use PawPath\services\EmailService;
use PawPath\utils\ResponseHelper;
use PawPath\config\database\DatabaseConfig;
use PDO;

class AdminController {
    private User $userModel;
    private EmailService $emailService;
    private PDO $db;
    private Shelter $shelterModel;

    public function __construct() {
        $this->userModel = new User();
        $this->emailService = new EmailService();
        $this->db = DatabaseConfig::getConnection();
        $this->shelterModel = new Shelter();
    }

    public function getStats(Request $request, Response $response): Response {
        try {
            $stats = [
                'totalUsers' => $this->userModel->countUsers(),
                'totalShelters' => $this->userModel->countByRole('shelter_staff'),
                'totalPets' => count($this->userModel->findAll(['role' => 'admin'])),
                'totalApplications' => 0, // Implement this with your applications model
                'pendingApplications' => 0,
                'activeUsers' => $this->userModel->countByStatus('active'),
                'recentActivity' => [] // Implement activity logging if needed
            ];

            return ResponseHelper::sendResponse($response, $stats);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }

    public function listUsers(Request $request, Response $response): Response {
        try {
            $queryParams = $request->getQueryParams();
            $filters = [];

            // Handle search
            if (!empty($queryParams['search'])) {
                $filters['search'] = $queryParams['search'];
            }

            // Handle role filter
            if (!empty($queryParams['role']) && $queryParams['role'] !== 'all') {
                $filters['role'] = $queryParams['role'];
            }

            // Handle status filter
            if (!empty($queryParams['status']) && $queryParams['status'] !== 'all') {
                $filters['account_status'] = $queryParams['status'];
            }

            $users = $this->userModel->findAll($filters);

            return ResponseHelper::sendResponse($response, $users);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }

    public function updateUserRole(Request $request, Response $response, array $args): Response {
        try {
            $userId = (int) $args['id'];
            $data = $request->getParsedBody();

            if (empty($data['role'])) {
                throw new \InvalidArgumentException('Role is required');
            }

            $success = $this->userModel->updateRole($userId, $data['role']);

            if (!$success) {
                throw new \RuntimeException('Failed to update user role');
            }

            $updatedUser = $this->userModel->findById($userId);
            return ResponseHelper::sendResponse($response, $updatedUser);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }

    public function updateUserStatus(Request $request, Response $response, array $args): Response {
        try {
            $userId = (int) $args['id'];
            $data = $request->getParsedBody();

            if (empty($data['status'])) {
                throw new \InvalidArgumentException('Status is required');
            }

            $success = $this->userModel->updateAccountStatus($userId, $data['status']);

            if (!$success) {
                throw new \RuntimeException('Failed to update user status');
            }

            $updatedUser = $this->userModel->findById($userId);
            return ResponseHelper::sendResponse($response, $updatedUser);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }

    public function listShelters(Request $request, Response $response): Response {
        try {
            $queryParams = $request->getQueryParams();
            $filters = [];

            // Handle search
            if (!empty($queryParams['search'])) {
                $filters['search'] = $queryParams['search'];
            }

            // Handle no-kill filter
            if (isset($queryParams['is_no_kill'])) {
                $filters['is_no_kill'] = (bool)$queryParams['is_no_kill'];
            }

            $shelterModel = new \PawPath\models\Shelter();
            $shelters = $shelterModel->findAll($filters);

            // Get additional stats for each shelter
            foreach ($shelters as &$shelter) {
                // Get total pets
                $stmt = $this->db->prepare("
                    SELECT COUNT(*) FROM Pet 
                    WHERE shelter_id = ?
                ");
                $stmt->execute([$shelter['shelter_id']]);
                $shelter['total_pets'] = (int)$stmt->fetchColumn();

                // Get active applications
                $stmt = $this->db->prepare("
                    SELECT COUNT(*) FROM Adoption_Application aa
                    JOIN Pet p ON aa.pet_id = p.pet_id
                    WHERE p.shelter_id = ? 
                    AND aa.status IN ('pending', 'under_review')
                ");
                $stmt->execute([$shelter['shelter_id']]);
                $shelter['active_applications'] = (int)$stmt->fetchColumn();
            }

            return ResponseHelper::sendResponse($response, $shelters);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }

    public function createShelter(Request $request, Response $response): Response {
        try {
            $data = $request->getParsedBody();
            
            if (empty($data['name']) || empty($data['address']) || empty($data['phone']) || empty($data['email'])) {
                throw new \InvalidArgumentException('Missing required shelter information');
            }

            $shelterModel = new \PawPath\models\Shelter();
            $shelterId = $shelterModel->create($data);
            $shelter = $shelterModel->findById($shelterId);

            return ResponseHelper::sendResponse($response, $shelter);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }

    public function deleteShelter(Request $request, Response $response, array $args): Response {
        try {
            $shelterId = (int)$args['id'];
            $shelterModel = new \PawPath\models\Shelter();
            
            // Check if shelter has any pets
            $stmt = $this->db->prepare("SELECT COUNT(*) FROM Pet WHERE shelter_id = ?");
            $stmt->execute([$shelterId]);
            if ($stmt->fetchColumn() > 0) {
                throw new \RuntimeException('Cannot delete shelter with existing pets');
            }

            $success = $shelterModel->delete($shelterId);
            
            if (!$success) {
                throw new \RuntimeException('Failed to delete shelter');
            }

            return ResponseHelper::sendResponse($response, ['message' => 'Shelter deleted successfully']);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }

    public function resendVerification(Request $request, Response $response, array $args): Response {
        try {
            $userId = (int) $args['id'];
            $user = $this->userModel->findById($userId);

            if (!$user) {
                throw new \RuntimeException('User not found');
            }

            $token = $this->userModel->createEmailVerificationToken($userId);
            $this->emailService->sendVerificationEmail($user['email'], $user['username'], $token);

            return ResponseHelper::sendResponse($response, [
                'message' => 'Verification email sent successfully'
            ]);
        } catch (\Exception $e) {
            return ResponseHelper::sendError($response, $e->getMessage());
        }
    }
}
=== ./backend/src/utils/ResponseHelper.php ===
<?php
namespace PawPath\utils;

use Psr\Http\Message\ResponseInterface;

class ResponseHelper {
    public static function sendResponse(ResponseInterface $response, $data, int $status = 200): ResponseInterface {
        $body = json_encode([
            'success' => true,
            'data' => $data
        ]);
        
        if (json_last_error() !== JSON_ERROR_NONE) {
            error_log("JSON encode error: " . json_last_error_msg());
            return self::sendError($response, "Internal server error", 500);
        }
        
        $response->getBody()->write($body);
        
        return $response
            ->withHeader('Content-Type', 'application/json')
            ->withStatus($status);
    }

    public static function sendError(ResponseInterface $response, string $message, int $status = 400): ResponseInterface {
        $body = json_encode([
            'success' => false,
            'error' => $message
        ]);
        
        $response->getBody()->write($body);
        
        return $response
            ->withHeader('Content-Type', 'application/json')
            ->withStatus($status);
    }
}
=== ./backend/src/models/Pet.php ===
<?php
namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class Pet {
    private PDO $db;
    private static array $validSpecies = ['Dog', 'Cat', 'Bird', 'Rabbit', 'Other'];

    private function formatTraits(array $traits): array {
        $formatted = [];
        foreach ($traits as $trait) {
            $category = $trait['category'] ?? 'General';
            if (!isset($formatted[$category])) {
                $formatted[$category] = [];
            }
            $formatted[$category][] = $trait['trait_name'];
        }
        return $formatted;
    }

    private function validatePetData(array $data): void {
        $requiredFields = ['name', 'species', 'shelter_id'];
        foreach ($requiredFields as $field) {
            if (empty($data[$field])) {
                throw new \InvalidArgumentException("Missing required field: $field");
            }
        }
        
        if (!in_array(ucfirst(strtolower($data['species'])), self::$validSpecies)) {
            throw new \InvalidArgumentException("Invalid species. Must be one of: " . implode(', ', self::$validSpecies));
        }
    }
 
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function findAll(array $filters = []): array {
        try {
            $query = "
                SELECT p.*, s.name as shelter_name 
                FROM Pet p
                LEFT JOIN Shelter s ON p.shelter_id = s.shelter_id
                WHERE 1=1
            ";
            $params = [];
            
            if (isset($filters['species'])) {
                $query .= " AND p.species = ?";
                $params[] = $filters['species'];
            }
            
            if (isset($filters['shelter_id'])) {
                $query .= " AND p.shelter_id = ?";
                $params[] = $filters['shelter_id'];
            }

            if (isset($filters['breed'])) {
                $query .= " AND p.breed LIKE ?";
                $params[] = '%' . $filters['breed'] . '%';
            }

            if (isset($filters['age_min'])) {
                $query .= " AND p.age >= ?";
                $params[] = $filters['age_min'];
            }

            if (isset($filters['age_max'])) {
                $query .= " AND p.age <= ?";
                $params[] = $filters['age_max'];
            }

            if (isset($filters['gender'])) {
                $query .= " AND p.gender = ?";
                $params[] = $filters['gender'];
            }
            
            $stmt = $this->db->prepare($query);
            $stmt->execute($params);
            $pets = $stmt->fetchAll();
        
        foreach ($pets as &$pet) {
            $stmt = $this->db->prepare("
                SELECT t.trait_id, t.trait_name, tc.name as category
                FROM Pet_Trait_Relation ptr
                JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
                LEFT JOIN Trait_Category tc ON t.category_id = tc.category_id
                WHERE ptr.pet_id = ?
            ");
            $stmt->execute([$pet['pet_id']]);
            $traits = $stmt->fetchAll();
            $pet['traits'] = $this->formatTraits($traits);
            }
            
            return $pets;
        } catch (PDOException $e) {
            error_log("Error finding pets: " . $e->getMessage());
            throw $e;
        }
    }

    public function findById(int $id): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT p.*, s.name as shelter_name
                FROM Pet p
                LEFT JOIN Shelter s ON p.shelter_id = s.shelter_id
                WHERE p.pet_id = ?
            ");
            
            $stmt->execute([$id]);
            $pet = $stmt->fetch();
            
            if (!$pet) {
                return null;
            }
            
            // Get pet traits with categories
            $stmt = $this->db->prepare("
                SELECT t.trait_id, t.trait_name, tc.name as category
                FROM Pet_Trait_Relation ptr
                JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
                LEFT JOIN Trait_Category tc ON t.category_id = tc.category_id
                WHERE ptr.pet_id = ?
            ");
            $stmt->execute([$id]);
            $traits = $stmt->fetchAll();
            
            $pet['traits'] = $this->formatTraits($traits);
            
            return $pet;
        } catch (PDOException $e) {
            error_log("Error finding pet by ID: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function create(array $data): int {
        try {
            $this->db->beginTransaction();
            
            error_log("Starting pet creation with data: " . print_r($data, true));
            
            // Validate required fields
            $this->validatePetData($data);
            
            $stmt = $this->db->prepare("
                INSERT INTO Pet (name, species, breed, age, gender, description, shelter_id)
                VALUES (?, ?, ?, ?, ?, ?, ?)
            ");
            
            $result = $stmt->execute([
                $data['name'],
                $data['species'],
                $data['breed'] ?? null,
                $data['age'] ?? null,
                $data['gender'] ?? null,
                $data['description'] ?? null,
                $data['shelter_id']
            ]);
            
            if (!$result) {
                error_log("SQL Error: " . print_r($stmt->errorInfo(), true));
                throw new \PDOException("Failed to insert pet");
            }
            
            $petId = (int) $this->db->lastInsertId();
            error_log("Created pet with ID: $petId");
            
            // Add traits if provided
            if (!empty($data['traits']) && is_array($data['traits'])) {
                $this->addTraitsToPet($petId, $data['traits']);
            }
            
            $this->db->commit();
            return $petId;
        } catch (\Exception $e) {
            $this->db->rollBack();
            error_log("Error in Pet::create: " . $e->getMessage() . "\n" . $e->getTraceAsString());
            throw $e;
        }
    }
    
    public function update(int $id, array $data): bool {
        try {
            $this->db->beginTransaction();
            
            $fields = [];
            $params = [];
            
            foreach ($data as $key => $value) {
                if (in_array($key, ['name', 'species', 'breed', 'age', 'gender', 'description', 'shelter_id'])) {
                    $fields[] = "$key = ?";
                    $params[] = $value;
                }
            }
            
            if (!empty($fields)) {
                $params[] = $id;
                $query = "UPDATE Pet SET " . implode(', ', $fields) . " WHERE pet_id = ?";
                
                $stmt = $this->db->prepare($query);
                $stmt->execute($params);
            }
            
            // Update traits if provided
            if (isset($data['traits']) && is_array($data['traits'])) {
                // Remove existing traits
                $stmt = $this->db->prepare("DELETE FROM Pet_Trait_Relation WHERE pet_id = ?");
                $stmt->execute([$id]);
                
                // Add new traits
                $this->addTraitsToPet($id, $data['traits']);
            }
            
            $this->db->commit();
            return true;
        } catch (PDOException $e) {
            $this->db->rollBack();
            error_log("Error updating pet: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function delete(int $id): bool {
        try {
            $this->db->beginTransaction();
            
            // Delete trait relations first
            $stmt = $this->db->prepare("DELETE FROM Pet_Trait_Relation WHERE pet_id = ?");
            $stmt->execute([$id]);
            
            // Delete pet
            $stmt = $this->db->prepare("DELETE FROM Pet WHERE pet_id = ?");
            $result = $stmt->execute([$id]);
            
            $this->db->commit();
            return $result;
        } catch (PDOException $e) {
            $this->db->rollBack();
            error_log("Error deleting pet: " . $e->getMessage());
            throw $e;
        }
    }

    public function findAllWithTraits(array $filters = []): array {
        try {
            error_log("Finding pets with filters: " . json_encode($filters, JSON_PRETTY_PRINT));
            
            // First, let's verify what traits exist in the database
            $stmt = $this->db->query("
                SELECT t.trait_id, t.trait_name, tc.name as category 
                FROM Pet_Trait t 
                LEFT JOIN Trait_Category tc ON t.category_id = tc.category_id
            ");
            error_log("Available traits: " . json_encode($stmt->fetchAll(), JSON_PRETTY_PRINT));
            
            // Then verify what pets and their traits exist
            $stmt = $this->db->query("
                SELECT p.pet_id, p.name, t.trait_name 
                FROM Pet p 
                LEFT JOIN Pet_Trait_Relation ptr ON p.pet_id = ptr.pet_id 
                LEFT JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
            ");
            error_log("Existing pets and traits: " . json_encode($stmt->fetchAll(), JSON_PRETTY_PRINT));
            
            $query = "
                SELECT 
                    p.*,
                    s.name as shelter_name,
                    GROUP_CONCAT(DISTINCT t.trait_name) as trait_names,
                    COUNT(DISTINCT CASE 
                        WHEN t.trait_name IN (" . $this->buildTraitNameList($filters) . ") 
                        THEN t.trait_id 
                    END) as matching_trait_count
                FROM Pet p
                LEFT JOIN Shelter s ON p.shelter_id = s.shelter_id
                LEFT JOIN Pet_Trait_Relation ptr ON p.pet_id = ptr.pet_id
                LEFT JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
                WHERE 1=1
            ";
            
            $params = [];
            
            if (!empty($filters['species'])) {
                $query .= " AND p.species = ?";
                $params[] = $filters['species'];
            }
            
            $query .= " GROUP BY p.pet_id";
            
            if (!empty($filters['traits'])) {
                $query .= " HAVING matching_trait_count > 0";
            }
            
            $query .= " ORDER BY matching_trait_count DESC, p.name";
            
            error_log("Executing query: " . $query);
            error_log("With params: " . json_encode($params));
            
            $stmt = $this->db->prepare($query);
            $stmt->execute($params);
            $pets = $stmt->fetchAll();
            
            error_log("Found pets: " . json_encode($pets, JSON_PRETTY_PRINT));
            
            foreach ($pets as &$pet) {
                $stmt = $this->db->prepare("
                    SELECT t.trait_name, tc.name as category
                    FROM Pet_Trait_Relation ptr
                    JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
                    LEFT JOIN Trait_Category tc ON t.category_id = tc.category_id
                    WHERE ptr.pet_id = ?
                ");
                $stmt->execute([$pet['pet_id']]);
                $traits = $stmt->fetchAll();
                
                $pet['traits'] = [];
                foreach ($traits as $trait) {
                    $category = $trait['category'] ?? 'Uncategorized';
                    if (!isset($pet['traits'][$category])) {
                        $pet['traits'][$category] = [];
                    }
                    $pet['traits'][$category][] = $trait['trait_name'];
                }
            }
            
            return $pets;
        } catch (PDOException $e) {
            error_log("Error finding pets with traits: " . $e->getMessage());
            throw $e;
        }
    }

    private function addTraitsToPet(int $petId, array $traitIds): void {
        // First verify all traits exist
        $placeholders = str_repeat('?,', count($traitIds) - 1) . '?';
        $stmt = $this->db->prepare("
            SELECT trait_id FROM Pet_Trait 
            WHERE trait_id IN ($placeholders)
        ");
        $stmt->execute($traitIds);
        $validTraits = $stmt->fetchAll(PDO::FETCH_COLUMN);
        
        error_log("Valid traits found for pet $petId: " . implode(', ', $validTraits));
        
        if (count($validTraits) !== count($traitIds)) {
            throw new \InvalidArgumentException("Some trait IDs are invalid");
        }
        
        // Insert valid traits
        $stmt = $this->db->prepare("
            INSERT INTO Pet_Trait_Relation (pet_id, trait_id)
            VALUES (?, ?)
        ");
        
        foreach ($validTraits as $traitId) {
            $stmt->execute([$petId, $traitId]);
            error_log("Added trait $traitId to pet $petId");
        }
    }

    private function buildTraitNameList(array $filters): string {
        if (empty($filters['traits'])) {
            return "''";
        }
        
        $traitNames = array_map(function($trait) {
            return $this->db->quote($trait['trait']);
        }, $filters['traits']);
        
        // Add debugging
        error_log("Building trait list from: " . json_encode($filters['traits']));
        error_log("Generated trait list: " . implode(',', $traitNames));
        
        return implode(',', $traitNames);
    }

    private function processTraits(?string $traitsJson): array {
        if (empty($traitsJson)) {
            return [];
        }
        
        $formatted = [];
        $traits = array_filter(explode('},{', trim($traitsJson, '[]')));
        
        foreach ($traits as $trait) {
            if (!str_ends_with($trait, '}')) $trait .= '}';
            if (!str_starts_with($trait, '{')) $trait = '{' . $trait;
            
            $traitData = json_decode($trait, true);
            if ($traitData) {
                $category = $traitData['category'];
                if (!isset($formatted[$category])) {
                    $formatted[$category] = [];
                }
                $formatted[$category][] = $traitData['name'];
            }
        }
        
        return $formatted;
    }
}
=== ./backend/src/models/Shelter.php ===
<?php
// backend/src/models/Shelter.php

namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class Shelter {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        try {
            error_log("Creating new shelter: " . $data['name']);
            
            $stmt = $this->db->prepare("
                INSERT INTO Shelter (name, address, phone, email, is_no_kill)
                VALUES (?, ?, ?, ?, ?)
            ");
            
            $success = $stmt->execute([
                $data['name'],
                $data['address'],
                $data['phone'],
                $data['email'],
                $data['is_no_kill'] ?? false
            ]);
            
            if (!$success) {
                error_log("Failed to create shelter: " . print_r($stmt->errorInfo(), true));
                throw new PDOException("Failed to create shelter");
            }
            
            $shelterId = (int) $this->db->lastInsertId();
            error_log("Created shelter with ID: " . $shelterId);
            
            return $shelterId;
        } catch (PDOException $e) {
            error_log("Error creating shelter: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findById(int $id): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT shelter_id, name, address, phone, email, is_no_kill
                FROM Shelter
                WHERE shelter_id = ?
            ");
            
            $stmt->execute([$id]);
            $shelter = $stmt->fetch();
            
            return $shelter ?: null;
        } catch (PDOException $e) {
            error_log("Error finding shelter: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findAll(array $filters = []): array {
        try {
            $query = "SELECT shelter_id, name, address, phone, email, is_no_kill FROM Shelter WHERE 1=1";
            $params = [];
            
            // Add filter for no-kill shelters
            if (isset($filters['is_no_kill'])) {
                $query .= " AND is_no_kill = ?";
                $params[] = $filters['is_no_kill'];
            }
            
            // Add search by name
            if (!empty($filters['search'])) {
                $query .= " AND name LIKE ?";
                $params[] = '%' . $filters['search'] . '%';
            }
            
            $stmt = $this->db->prepare($query);
            $stmt->execute($params);
            
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding shelters: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function update(int $id, array $data): bool {
        try {
            $fields = [];
            $params = [];
            
            // Build update fields dynamically
            foreach (['name', 'address', 'phone', 'email', 'is_no_kill'] as $field) {
                if (isset($data[$field])) {
                    $fields[] = "$field = ?";
                    $params[] = $data[$field];
                }
            }
            
            if (empty($fields)) {
                return false;
            }
            
            $params[] = $id;
            $query = "UPDATE Shelter SET " . implode(', ', $fields) . " WHERE shelter_id = ?";
            
            $stmt = $this->db->prepare($query);
            return $stmt->execute($params);
        } catch (PDOException $e) {
            error_log("Error updating shelter: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function delete(int $id): bool {
        try {
            // First check if there are any pets associated with this shelter
            $stmt = $this->db->prepare("SELECT COUNT(*) FROM Pet WHERE shelter_id = ?");
            $stmt->execute([$id]);
            $petCount = $stmt->fetchColumn();
            
            if ($petCount > 0) {
                throw new \RuntimeException("Cannot delete shelter with existing pets");
            }
            
            $stmt = $this->db->prepare("DELETE FROM Shelter WHERE shelter_id = ?");
            return $stmt->execute([$id]);
        } catch (PDOException $e) {
            error_log("Error deleting shelter: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/Product.php ===
<?php

namespace PawPath\models;

use PDOException;
use PDO;
use PawPath\config\database\DatabaseConfig;

class Product {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        try {
            $stmt = $this->db->prepare("
                INSERT INTO Product (
                    name,
                    description,
                    price,
                    affiliate_link
                ) VALUES (?, ?, ?, ?)
            ");
            
            $stmt->execute([
                $data['name'],
                $data['description'] ?? null,
                $data['price'],
                $data['affiliate_link'] ?? null
            ]);
            
            return (int) $this->db->lastInsertId();
        } catch (PDOException $e) {
            error_log("Error creating product: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findById(int $id): ?array {
        try {
            $stmt = $this->db->prepare("SELECT * FROM Product WHERE product_id = ?");
            $stmt->execute([$id]);
            return $stmt->fetch() ?: null;
        } catch (PDOException $e) {
            error_log("Error finding product: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findAll(array $filters = []): array {
        try {
            $query = "SELECT * FROM Product WHERE 1=1";
            $params = [];
            
            if (!empty($filters['search'])) {
                $query .= " AND (name LIKE ? OR description LIKE ?)";
                $searchTerm = '%' . $filters['search'] . '%';
                $params[] = $searchTerm;
                $params[] = $searchTerm;
            }
            
            if (isset($filters['price_min'])) {
                $query .= " AND price >= ?";
                $params[] = $filters['price_min'];
            }
            
            if (isset($filters['price_max'])) {
                $query .= " AND price <= ?";
                $params[] = $filters['price_max'];
            }
            
            $stmt = $this->db->prepare($query);
            $stmt->execute($params);
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding products: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function update(int $id, array $data): bool {
        try {
            $fields = [];
            $params = [];
            
            foreach (['name', 'description', 'price', 'affiliate_link'] as $field) {
                if (isset($data[$field])) {
                    $fields[] = "$field = ?";
                    $params[] = $data[$field];
                }
            }
            
            if (empty($fields)) {
                return false;
            }
            
            $params[] = $id;
            $query = "UPDATE Product SET " . implode(', ', $fields) . " WHERE product_id = ?";
            
            $stmt = $this->db->prepare($query);
            return $stmt->execute($params);
        } catch (PDOException $e) {
            error_log("Error updating product: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function delete(int $id): bool {
        try {
            $this->db->beginTransaction();
            
            // Delete blog relations first
            $stmt = $this->db->prepare("DELETE FROM Blog_Product_Relation WHERE product_id = ?");
            $stmt->execute([$id]);
            
            // Delete product
            $stmt = $this->db->prepare("DELETE FROM Product WHERE product_id = ?");
            $result = $stmt->execute([$id]);
            
            $this->db->commit();
            return $result;
        } catch (PDOException $e) {
            $this->db->rollBack();
            error_log("Error deleting product: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/User.php ===
<?php
// backend/src/models/User.php

namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class User {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        try {
            error_log("Attempting to create user with username: " . $data['username']);
            
            $stmt = $this->db->prepare("
                INSERT INTO User (username, email, password_hash, registration_date)
                VALUES (?, ?, ?, CURDATE())
            ");
            
            $success = $stmt->execute([
                $data['username'],
                $data['email'],
                password_hash($data['password'], PASSWORD_DEFAULT)
            ]);
            
            if (!$success) {
                error_log("Failed to execute user creation query");
                error_log(print_r($stmt->errorInfo(), true));
                throw new PDOException("Failed to create user");
            }
            
            $userId = (int) $this->db->lastInsertId();
            error_log("Successfully created user with ID: " . $userId);
            
            return $userId;
        } catch (PDOException $e) {
            error_log("Error creating user: " . $e->getMessage());
            throw $e;
        }
    }

    public function findById(int $id): ?array {
        try {
            error_log("Looking up user with ID: " . $id);
            
            $stmt = $this->db->prepare("
                SELECT user_id, username, email, registration_date 
                FROM User 
                WHERE user_id = ?
            ");
            
            $stmt->execute([$id]);
            $user = $stmt->fetch();
            
            if ($user === false) {
                error_log("No user found with ID: " . $id);
                return null;
            }
            
            error_log("Found user: " . print_r($user, true));
            return $user;
        } catch (PDOException $e) {
            error_log("Error finding user: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findByEmail(string $email): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT user_id, username, email, password_hash, registration_date 
                FROM User 
                WHERE email = ?
            ");
            
            $stmt->execute([$email]);
            $user = $stmt->fetch();
            
            return $user === false ? null : $user;
        } catch (PDOException $e) {
            error_log("Error finding user by email: " . $e->getMessage());
            throw $e;
        }
    }

    public function updateRole(int $userId, string $role): bool {
        try {
            $stmt = $this->db->prepare("
                UPDATE User 
                SET role = ? 
                WHERE user_id = ?
            ");
            
            return $stmt->execute([$role, $userId]);
        } catch (PDOException $e) {
            error_log("Error updating user role: " . $e->getMessage());
            throw $e;
        }
    }

    public function findAll(array $filters = []): array {
        try {
            $query = "
                SELECT user_id, username, email, role, account_status, 
                       registration_date, last_login, email_verified_at
                FROM User
                WHERE 1=1
            ";
            $params = [];

            if (!empty($filters['search'])) {
                $query .= " AND (username LIKE ? OR email LIKE ?)";
                $searchTerm = '%' . $filters['search'] . '%';
                $params[] = $searchTerm;
                $params[] = $searchTerm;
            }

            if (!empty($filters['role'])) {
                $query .= " AND role = ?";
                $params[] = $filters['role'];
            }

            if (!empty($filters['account_status'])) {
                $query .= " AND account_status = ?";
                $params[] = $filters['account_status'];
            }

            $query .= " ORDER BY registration_date DESC";

            $stmt = $this->db->prepare($query);
            $stmt->execute($params);
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error in findAll: " . $e->getMessage());
            throw $e;
        }
    }

    public function countUsers(): int {
        try {
            $stmt = $this->db->query("SELECT COUNT(*) FROM User");
            return (int) $stmt->fetchColumn();
        } catch (PDOException $e) {
            error_log("Error counting users: " . $e->getMessage());
            throw $e;
        }
    }

    public function countByRole(string $role): int {
        try {
            $stmt = $this->db->prepare("SELECT COUNT(*) FROM User WHERE role = ?");
            $stmt->execute([$role]);
            return (int) $stmt->fetchColumn();
        } catch (PDOException $e) {
            error_log("Error counting users by role: " . $e->getMessage());
            throw $e;
        }
    }

    public function countByStatus(string $status): int {
        try {
            $stmt = $this->db->prepare("SELECT COUNT(*) FROM User WHERE account_status = ?");
            $stmt->execute([$status]);
            return (int) $stmt->fetchColumn();
        } catch (PDOException $e) {
            error_log("Error counting users by status: " . $e->getMessage());
            throw $e;
        }
    }

    public function verifyEmail(int $userId): bool {
        try {
            $stmt = $this->db->prepare("
                UPDATE User 
                SET email_verified_at = CURRENT_TIMESTAMP,
                    email_verification_token = NULL,
                    account_status = 'active'
                WHERE user_id = ?
            ");
            
            return $stmt->execute([$userId]);
        } catch (PDOException $e) {
            error_log("Error verifying email: " . $e->getMessage());
            throw $e;
        }
    }

    public function updateAccountStatus(int $userId, string $status): bool {
        try {
            $stmt = $this->db->prepare("
                UPDATE User 
                SET account_status = ? 
                WHERE user_id = ?
            ");
            
            return $stmt->execute([$status, $userId]);
        } catch (PDOException $e) {
            error_log("Error updating account status: " . $e->getMessage());
            throw $e;
        }
    }

    public function createEmailVerificationToken(int $userId): string {
        try {
            $token = bin2hex(random_bytes(32));
            $expires = date('Y-m-d H:i:s', strtotime('+24 hours'));
            
            $stmt = $this->db->prepare("
                UPDATE User 
                SET email_verification_token = ?,
                    email_token_expires_at = ?
                WHERE user_id = ?
            ");
            
            $stmt->execute([$token, $expires, $userId]);
            return $token;
        } catch (PDOException $e) {
            error_log("Error creating email verification token: " . $e->getMessage());
            throw $e;
        }
    }

    public function updateLastLogin(int $userId): bool {
        try {
            $stmt = $this->db->prepare("
                UPDATE User 
                SET last_login = CURRENT_TIMESTAMP 
                WHERE user_id = ?
            ");
            
            return $stmt->execute([$userId]);
        } catch (PDOException $e) {
            error_log("Error updating last login: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/AdoptionApplication.php ===
<?php
namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class AdoptionApplication {
    private PDO $db;
    
    public const STATUS_PENDING = 'pending';
    public const STATUS_UNDER_REVIEW = 'under_review';
    public const STATUS_APPROVED = 'approved';
    public const STATUS_REJECTED = 'rejected';
    public const STATUS_WITHDRAWN = 'withdrawn';
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        try {
            $stmt = $this->db->prepare("
                INSERT INTO Adoption_Application (
                    user_id, pet_id, application_date, status,
                    status_history, reason, experience, living_situation,
                    has_other_pets, other_pets_details, daily_schedule,
                    veterinarian
                ) VALUES (
                    :user_id, :pet_id, :application_date, :status,
                    :status_history, :reason, :experience, :living_situation,
                    :has_other_pets, :other_pets_details, :daily_schedule,
                    :veterinarian
                )
            ");
            
            $stmt->execute([
                'user_id' => $data['user_id'],
                'pet_id' => $data['pet_id'],
                'application_date' => $data['application_date'],
                'status' => $data['status'],
                'status_history' => $data['status_history'],
                'reason' => $data['reason'] ?? null,
                'experience' => $data['experience'] ?? null,
                'living_situation' => $data['living_situation'] ?? null,
                'has_other_pets' => $data['has_other_pets'] ? 1 : 0,
                'other_pets_details' => $data['other_pets_details'] ?? null,
                'daily_schedule' => $data['daily_schedule'] ?? null,
                'veterinarian' => $data['veterinarian'] ?? null
            ]);
            
            return (int) $this->db->lastInsertId();
        } catch (PDOException $e) {
            error_log("Error creating adoption application: " . $e->getMessage());
            throw $e;
        }
    }

    public function findById(int $id): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT aa.*, p.name as pet_name, p.species as pet_species,
                       p.breed as pet_breed, s.name as shelter_name
                FROM Adoption_Application aa
                JOIN Pet p ON aa.pet_id = p.pet_id
                JOIN Shelter s ON p.shelter_id = s.shelter_id
                WHERE aa.application_id = ?
            ");
            
            $stmt->execute([$id]);
            $result = $stmt->fetch();
            
            return $result ?: null;
        } catch (PDOException $e) {
            error_log("Error finding adoption application: " . $e->getMessage());
            throw $e;
        }
    }

    public function findByUser(int $userId): array {
        try {
            $stmt = $this->db->prepare("
                SELECT 
                    aa.application_id,
                    aa.pet_id,
                    aa.status,
                    aa.application_date,
                    p.name as pet_name,
                    p.species as pet_species,
                    p.breed as pet_breed,
                    s.name as shelter_name
                FROM Adoption_Application aa
                JOIN Pet p ON aa.pet_id = p.pet_id
                JOIN Shelter s ON p.shelter_id = s.shelter_id
                WHERE aa.user_id = ?
                ORDER BY aa.application_date DESC
            ");
            
            $stmt->execute([$userId]);
            return $stmt->fetchAll(PDO::FETCH_ASSOC);
        } catch (PDOException $e) {
            error_log("Error finding user's applications: " . $e->getMessage());
            throw $e;
        }
    }

    public function findByShelter(int $shelterId): array {
        try {
            $stmt = $this->db->prepare("
                SELECT aa.*, p.name as pet_name,
                       u.username as applicant_name
                FROM Adoption_Application aa
                JOIN Pet p ON aa.pet_id = p.pet_id
                JOIN User u ON aa.user_id = u.user_id
                WHERE p.shelter_id = ?
                ORDER BY aa.application_date DESC
            ");
            
            $stmt->execute([$shelterId]);
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding shelter's applications: " . $e->getMessage());
            throw $e;
        }
    }

    public function findByPet(int $petId): array {
        try {
            $stmt = $this->db->prepare("
                SELECT aa.*, u.username as applicant_name
                FROM Adoption_Application aa
                JOIN User u ON aa.user_id = u.user_id
                WHERE aa.pet_id = ?
                ORDER BY aa.application_date DESC
            ");
            
            $stmt->execute([$petId]);
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding pet's applications: " . $e->getMessage());
            throw $e;
        }
    }

    public function hasUserAppliedForPet(int $userId, int $petId): bool {
        try {
            $stmt = $this->db->prepare("
                SELECT COUNT(*) FROM Adoption_Application
                WHERE user_id = ? AND pet_id = ?
                AND status NOT IN (?, ?)
            ");
            
            $stmt->execute([
                $userId, 
                $petId, 
                self::STATUS_WITHDRAWN, 
                self::STATUS_REJECTED
            ]);
            
            return (bool) $stmt->fetchColumn();
        } catch (PDOException $e) {
            error_log("Error checking user's pet application: " . $e->getMessage());
            throw $e;
        }
    }

    public function updateStatus(int $id, string $status): bool {
        try {
            $stmt = $this->db->prepare("
                UPDATE Adoption_Application
                SET status = ?,
                    last_updated = CURRENT_TIMESTAMP
                WHERE application_id = ?
            ");
            
            return $stmt->execute([$status, $id]);
        } catch (PDOException $e) {
            error_log("Error updating application status: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/QuizResult.php ===
<?php

namespace PawPath\Models;

class QuizResult {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        $stmt = $this->db->prepare("
            INSERT INTO Quiz_Result (quiz_id, recommended_species, recommended_breed)
            VALUES (?, ?, ?)
        ");
        
        $stmt->execute([
            $data['quiz_id'],
            $data['recommended_species'] ?? null,
            $data['recommended_breed'] ?? null
        ]);
        
        return (int) $this->db->lastInsertId();
    }
    
    public function findByQuizId(int $quizId): ?array {
        $stmt = $this->db->prepare("
            SELECT * FROM Quiz_Result WHERE quiz_id = ?
        ");
        
        $stmt->execute([$quizId]);
        $result = $stmt->fetch();
        return $result !== false ? $result : null;
    }
}
=== ./backend/src/models/PetTrait.php ===
<?php
// backend/src/models/PetTrait.php

namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class PetTrait {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(string $traitName): int {
        try {
            $stmt = $this->db->prepare("
                INSERT INTO Pet_Trait (trait_name)
                VALUES (?)
            ");
            
            $stmt->execute([$traitName]);
            return (int) $this->db->lastInsertId();
        } catch (PDOException $e) {
            error_log("Error creating pet trait: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findAll(): array {
        try {
            $stmt = $this->db->prepare("
                SELECT trait_id, trait_name
                FROM Pet_Trait
                ORDER BY trait_name
            ");
            
            $stmt->execute();
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding pet traits: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findById(int $id): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT trait_id, trait_name
                FROM Pet_Trait
                WHERE trait_id = ?
            ");
            
            $stmt->execute([$id]);
            $result = $stmt->fetch();
            
            return $result ?: null;
        } catch (PDOException $e) {
            error_log("Error finding pet trait: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function update(int $id, string $traitName): bool {
        try {
            $stmt = $this->db->prepare("
                UPDATE Pet_Trait
                SET trait_name = ?
                WHERE trait_id = ?
            ");
            
            return $stmt->execute([$traitName, $id]);
        } catch (PDOException $e) {
            error_log("Error updating pet trait: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function delete(int $id): bool {
        try {
            // Check if trait is in use
            $stmt = $this->db->prepare("
                SELECT COUNT(*) FROM Pet_Trait_Relation
                WHERE trait_id = ?
            ");
            $stmt->execute([$id]);
            
            if ($stmt->fetchColumn() > 0) {
                throw new \RuntimeException("Cannot delete trait that is in use");
            }
            
            $stmt = $this->db->prepare("
                DELETE FROM Pet_Trait
                WHERE trait_id = ?
            ");
            
            return $stmt->execute([$id]);
        } catch (PDOException $e) {
            error_log("Error deleting pet trait: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/UserProfile.php ===
<?php
namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class UserProfile {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        try {
            $stmt = $this->db->prepare("
                INSERT INTO UserProfile (
                    user_id, first_name, last_name, phone, 
                    address, city, state, zip_code,
                    housing_type, has_yard, other_pets, household_members
                ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
            ");
            
            $stmt->execute([
                $data['user_id'],
                $data['first_name'] ?? null,
                $data['last_name'] ?? null,
                $data['phone'] ?? null,
                $data['address'] ?? null,
                $data['city'] ?? null,
                $data['state'] ?? null,
                $data['zip_code'] ?? null,
                $data['housing_type'] ?? null,
                $data['has_yard'] ?? null,
                $data['other_pets'] ?? null,
                $data['household_members'] ?? null
            ]);
            
            return (int) $this->db->lastInsertId();
        } catch (PDOException $e) {
            error_log("Error creating user profile: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findByUserId(int $userId): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT up.*, u.email, u.username, u.role, u.account_status
                FROM UserProfile up
                JOIN User u ON up.user_id = u.user_id
                WHERE up.user_id = ?
            ");
            
            $stmt->execute([$userId]);
            return $stmt->fetch() ?: null;
        } catch (PDOException $e) {
            error_log("Error finding user profile: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function update(int $userId, array $data): bool {
        try {
            $fields = [];
            $params = [];
            
            foreach ($data as $key => $value) {
                if (in_array($key, [
                    'first_name', 'last_name', 'phone', 'address', 'city',
                    'state', 'zip_code', 'housing_type', 'has_yard',
                    'other_pets', 'household_members'
                ])) {
                    $fields[] = "$key = ?";
                    $params[] = $value;
                }
            }
            
            if (empty($fields)) {
                return false;
            }
            
            $params[] = $userId;
            $query = "UPDATE UserProfile SET " . implode(', ', $fields) . " WHERE user_id = ?";
            
            $stmt = $this->db->prepare($query);
            return $stmt->execute($params);
        } catch (PDOException $e) {
            error_log("Error updating user profile: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/StartingQuiz.php ===
<?php
// src/models/StartingQuiz.php
namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class StartingQuiz {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(int $userId): int {
        try {
            $stmt = $this->db->prepare("
                INSERT INTO Starting_Quiz (user_id, quiz_date)
                VALUES (?, CURRENT_TIMESTAMP)
            ");
            
            $stmt->execute([$userId]);
            return (int) $this->db->lastInsertId();
        } catch (PDOException $e) {
            error_log("Error creating quiz: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findByUser(int $userId): array {
        try {
            $stmt = $this->db->prepare("
                SELECT sq.*, qr.recommended_species, qr.recommended_breed,
                       qr.trait_preferences
                FROM Starting_Quiz sq
                LEFT JOIN Quiz_Result qr ON sq.quiz_id = qr.quiz_id
                WHERE sq.user_id = ?
                ORDER BY sq.quiz_date DESC
            ");
            
            $stmt->execute([$userId]);
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding user quizzes: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findById(int $quizId): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT sq.*, qr.recommended_species, qr.recommended_breed,
                       qr.trait_preferences
                FROM Starting_Quiz sq
                LEFT JOIN Quiz_Result qr ON sq.quiz_id = qr.quiz_id
                WHERE sq.quiz_id = ?
            ");
            
            $stmt->execute([$quizId]);
            $result = $stmt->fetch();
            
            return $result ?: null;
        } catch (PDOException $e) {
            error_log("Error finding quiz: " . $e->getMessage());
            throw $e;
        }
    }
}

// src/models/QuizResult.php
class QuizResult {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        try {
            $stmt = $this->db->prepare("
                INSERT INTO Quiz_Result (
                    quiz_id, 
                    recommended_species, 
                    recommended_breed,
                    trait_preferences,
                    confidence_score
                ) VALUES (?, ?, ?, ?, ?)
            ");
            
            $stmt->execute([
                $data['quiz_id'],
                $data['recommended_species'],
                $data['recommended_breed'],
                json_encode($data['trait_preferences'] ?? []),
                $data['confidence_score'] ?? 0
            ]);
            
            return (int) $this->db->lastInsertId();
        } catch (PDOException $e) {
            error_log("Error creating quiz result: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findByQuizId(int $quizId): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT * FROM Quiz_Result WHERE quiz_id = ?
            ");
            
            $stmt->execute([$quizId]);
            $result = $stmt->fetch();
            
            if ($result && isset($result['trait_preferences'])) {
                $result['trait_preferences'] = json_decode($result['trait_preferences'], true);
            }
            
            return $result ?: null;
        } catch (PDOException $e) {
            error_log("Error finding quiz result: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/PetImage.php ===
<?php
namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class PetImage {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(int $petId, string $imageUrl, bool $isPrimary = false): int {
        try {
            // If this is a primary image, unset any existing primary images
            if ($isPrimary) {
                $stmt = $this->db->prepare("
                    UPDATE Pet_Image 
                    SET is_primary = FALSE 
                    WHERE pet_id = ?
                ");
                $stmt->execute([$petId]);
            }
            
            $stmt = $this->db->prepare("
                INSERT INTO Pet_Image (pet_id, image_url, is_primary)
                VALUES (?, ?, ?)
            ");
            
            $stmt->execute([$petId, $imageUrl, $isPrimary]);
            return (int) $this->db->lastInsertId();
        } catch (PDOException $e) {
            error_log("Error creating pet image: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findByPetId(int $petId): array {
        try {
            $stmt = $this->db->prepare("
                SELECT * FROM Pet_Image 
                WHERE pet_id = ? 
                ORDER BY is_primary DESC, created_at ASC
            ");
            
            $stmt->execute([$petId]);
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding pet images: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function setPrimary(int $imageId, int $petId): bool {
        try {
            $this->db->beginTransaction();
            
            // Unset existing primary image
            $stmt = $this->db->prepare("
                UPDATE Pet_Image 
                SET is_primary = FALSE 
                WHERE pet_id = ?
            ");
            $stmt->execute([$petId]);
            
            // Set new primary image
            $stmt = $this->db->prepare("
                UPDATE Pet_Image 
                SET is_primary = TRUE 
                WHERE image_id = ? AND pet_id = ?
            ");
            $result = $stmt->execute([$imageId, $petId]);
            
            $this->db->commit();
            return $result;
        } catch (PDOException $e) {
            $this->db->rollBack();
            error_log("Error setting primary image: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function delete(int $imageId, int $petId): bool {
        try {
            $stmt = $this->db->prepare("
                DELETE FROM Pet_Image 
                WHERE image_id = ? AND pet_id = ?
            ");
            return $stmt->execute([$imageId, $petId]);
        } catch (PDOException $e) {
            error_log("Error deleting pet image: " . $e->getMessage());
            throw $e;
        }
    }
}
=== ./backend/src/models/BlogPost.php ===
<?php
// src/models/BlogPost.php
namespace PawPath\models;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig;

class BlogPost {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function create(array $data): int {
        try {
            $stmt = $this->db->prepare("
                INSERT INTO Blog_Post (
                    title,
                    content,
                    publication_date,
                    author_id
                ) VALUES (?, ?, CURDATE(), ?)
            ");
            
            $stmt->execute([
                $data['title'],
                $data['content'],
                $data['author_id']
            ]);
            
            $postId = (int) $this->db->lastInsertId();
            
            // Handle product relationships if provided
            if (!empty($data['product_ids'])) {
                $this->updateProductRelations($postId, $data['product_ids']);
            }
            
            return $postId;
        } catch (PDOException $e) {
            error_log("Error creating blog post: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findById(int $id): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT 
                    bp.*,
                    u.username as author_name
                FROM Blog_Post bp
                JOIN User u ON bp.author_id = u.user_id
                WHERE bp.post_id = ?
            ");
            
            $stmt->execute([$id]);
            $post = $stmt->fetch();
            
            if ($post) {
                // Get related products
                $stmt = $this->db->prepare("
                    SELECT p.*
                    FROM Product p
                    JOIN Blog_Product_Relation bpr ON p.product_id = bpr.product_id
                    WHERE bpr.post_id = ?
                ");
                $stmt->execute([$id]);
                $post['products'] = $stmt->fetchAll();
            }
            
            return $post ?: null;
        } catch (PDOException $e) {
            error_log("Error finding blog post: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function findAll(array $filters = []): array {
        try {
            $query = "
                SELECT 
                    bp.*,
                    u.username as author_name
                FROM Blog_Post bp
                JOIN User u ON bp.author_id = u.user_id
                WHERE 1=1
            ";
            $params = [];
            
            if (!empty($filters['search'])) {
                $query .= " AND (
                    bp.title LIKE ? OR 
                    bp.content LIKE ? OR 
                    bp.title LIKE ?
                )";
                $searchTerm = '%' . $filters['search'] . '%';
                $params[] = $searchTerm;
                $params[] = $searchTerm;
                $params[] = $searchTerm;
            }
            
            // Always order by newest first
            $query .= " ORDER BY bp.post_id DESC";
            
            $stmt = $this->db->prepare($query);
            $stmt->execute($params);
            return $stmt->fetchAll();
        } catch (PDOException $e) {
            error_log("Error finding blog posts: " . $e->getMessage());
            throw $e;
        }
    }
        
    public function update(int $id, array $data): bool {
        try {
            $this->db->beginTransaction();
            
            $fields = [];
            $params = [];
            
            if (isset($data['title'])) {
                $fields[] = "title = ?";
                $params[] = $data['title'];
            }
            
            if (isset($data['content'])) {
                $fields[] = "content = ?";
                $params[] = $data['content'];
            }
            
            if (!empty($fields)) {
                $params[] = $id;
                $query = "UPDATE Blog_Post SET " . implode(', ', $fields) . " WHERE post_id = ?";
                
                $stmt = $this->db->prepare($query);
                $stmt->execute($params);
            }
            
            // Update product relations if provided
            if (isset($data['product_ids'])) {
                $this->updateProductRelations($id, $data['product_ids']);
            }
            
            $this->db->commit();
            return true;
        } catch (PDOException $e) {
            $this->db->rollBack();
            error_log("Error updating blog post: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function delete(int $id): bool {
        try {
            $this->db->beginTransaction();
            
            // Delete product relations first
            $stmt = $this->db->prepare("DELETE FROM Blog_Product_Relation WHERE post_id = ?");
            $stmt->execute([$id]);
            
            // Delete blog post
            $stmt = $this->db->prepare("DELETE FROM Blog_Post WHERE post_id = ?");
            $result = $stmt->execute([$id]);
            
            $this->db->commit();
            return $result;
        } catch (PDOException $e) {
            $this->db->rollBack();
            error_log("Error deleting blog post: " . $e->getMessage());
            throw $e;
        }
    }
    
    private function updateProductRelations(int $postId, array $productIds): void {
        // Remove existing relations
        $stmt = $this->db->prepare("DELETE FROM Blog_Product_Relation WHERE post_id = ?");
        $stmt->execute([$postId]);
        
        // Add new relations
        $stmt = $this->db->prepare("
            INSERT INTO Blog_Product_Relation (post_id, product_id)
            VALUES (?, ?)
        ");
        
        foreach ($productIds as $productId) {
            $stmt->execute([$postId, $productId]);
        }
    }
}
=== ./backend/src/services/EmailTemplateService.php ===
<?php
namespace PawPath\services;

class EmailTemplateService {
    public static function getVerificationEmail(string $name, string $link): string {
        return self::getTemplate('verification', [
            'name' => $name,
            'link' => $link
        ]);
    }
    
    public static function getPasswordResetEmail(string $name, string $link): string {
        return self::getTemplate('password-reset', [
            'name' => $name,
            'link' => $link
        ]);
    }
    
    public static function getWelcomeEmail(string $name): string {
        return self::getTemplate('welcome', [
            'name' => $name
        ]);
    }
    
    public static function getAdoptionApplicationEmail(array $data): string {
        return self::getTemplate('adoption-application', $data);
    }
    
    private static function getTemplate(string $name, array $data): string {
        $template = file_get_contents(__DIR__ . "/../templates/emails/{$name}.html");
        
        foreach ($data as $key => $value) {
            $template = str_replace("{{" . $key . "}}", $value, $template);
        }
        
        return $template;
    }
}
=== ./backend/src/services/ProductService.php ===
<?php

namespace PawPath\services;

use PawPath\models\Product;
use RuntimeException;

class ProductService {
    private Product $productModel;
    
    public function __construct() {
        $this->productModel = new Product();
    }
    
    public function createProduct(array $data): array {
        // Validate required fields
        if (empty($data['name']) || !isset($data['price'])) {
            throw new RuntimeException("Name and price are required");
        }
        
        // Validate price
        if ($data['price'] < 0) {
            throw new RuntimeException("Price cannot be negative");
        }
        
        // Create product
        $productId = $this->productModel->create($data);
        return $this->productModel->findById($productId);
    }
    
    public function getProduct(int $id): array {
        $product = $this->productModel->findById($id);
        if (!$product) {
            throw new RuntimeException("Product not found");
        }
        return $product;
    }
    
    public function listProducts(array $filters = []): array {
        // Validate price filters
        if (isset($filters['price_min']) && $filters['price_min'] < 0) {
            throw new RuntimeException("Minimum price cannot be negative");
        }
        
        if (isset($filters['price_max']) && $filters['price_max'] < 0) {
            throw new RuntimeException("Maximum price cannot be negative");
        }
        
        if (isset($filters['price_min'], $filters['price_max']) 
            && $filters['price_min'] > $filters['price_max']) {
            throw new RuntimeException("Minimum price cannot be greater than maximum price");
        }
        
        return $this->productModel->findAll($filters);
    }
    
    public function updateProduct(int $id, array $data): array {
        // Verify product exists
        $product = $this->productModel->findById($id);
        if (!$product) {
            throw new RuntimeException("Product not found");
        }
        
        // Validate price if provided
        if (isset($data['price']) && $data['price'] < 0) {
            throw new RuntimeException("Price cannot be negative");
        }
        
        // Update product
        $this->productModel->update($id, $data);
        return $this->productModel->findById($id);
    }
    
    public function deleteProduct(int $id): void {
        // Verify product exists
        $product = $this->productModel->findById($id);
        if (!$product) {
            throw new RuntimeException("Product not found");
        }
        
        // Delete product
        if (!$this->productModel->delete($id)) {
            throw new RuntimeException("Failed to delete product");
        }
    }
}
=== ./backend/src/services/ImageUploadService.php ===
<?php
namespace PawPath\services;

class ImageUploadService {
    private string $uploadPath;
    
     public function __construct() {
        // Set absolute path to uploads directory
        $this->uploadPath = '/home/woodmtaylor/pawpath-pet-adoption/backend/public/uploads/images';
        
        error_log("Upload path set to: " . $this->uploadPath);
        
        // Check if directory exists and is writable
        if (!file_exists($this->uploadPath)) {
            try {
                error_log("Attempting to create directory: " . $this->uploadPath);
                $result = mkdir($this->uploadPath, 0755, true);
                if (!$result) {
                    error_log("Failed to create upload directory using mkdir");
                }
            } catch (\Exception $e) {
                error_log("Error creating upload directory: " . $e->getMessage());
            }
        }
        
        if (file_exists($this->uploadPath) && !is_writable($this->uploadPath)) {
            error_log("Upload directory exists but is not writable: " . $this->uploadPath);
        }
    }   

    public function uploadImage(array $file): string {
        // Verify upload directory is usable before proceeding
        if (!file_exists($this->uploadPath) || !is_writable($this->uploadPath)) {
            throw new \RuntimeException('Upload directory is not writable. Please check permissions.');
        }

        if ($file['error'] !== UPLOAD_ERR_OK) {
            throw new \RuntimeException('File upload failed with error code: ' . $file['error']);
        }
        
        $fileInfo = new \finfo(FILEINFO_MIME_TYPE);
        $mimeType = $fileInfo->file($file['tmp_name']);
        
        if (!in_array($mimeType, ['image/jpeg', 'image/png', 'image/webp'])) {
            throw new \RuntimeException('Invalid file type. Only JPEG, PNG, and WebP images are allowed.');
        }
        
        $extension = match($mimeType) {
            'image/jpeg' => 'jpg',
            'image/png' => 'png',
            'image/webp' => 'webp',
            default => throw new \RuntimeException('Unsupported image type')
        };
        
        $filename = bin2hex(random_bytes(16)) . '.' . $extension;
        $filepath = $this->uploadPath . '/' . $filename;
        
        if (!move_uploaded_file($file['tmp_name'], $filepath)) {
            throw new \RuntimeException('Failed to move uploaded file');
        }
        
        return '/uploads/images/' . $filename;
    }
    
    public function deleteImage(string $imageUrl): bool {
        $filepath = $this->uploadPath . '/' . basename($imageUrl);
        if (file_exists($filepath)) {
            return unlink($filepath);
        }
        return false;
    }
}
=== ./backend/src/services/AdoptionService.php ===
<?php
// backend/src/services/AdoptionService.php

namespace PawPath\services;

use PawPath\models\AdoptionApplication;
use PawPath\models\Pet;
use PawPath\models\User;
use RuntimeException;

class AdoptionService {
    private AdoptionApplication $applicationModel;
    private Pet $petModel;
    private User $userModel;
    
    public function __construct() {
        $this->applicationModel = new AdoptionApplication();
        $this->petModel = new Pet();
        $this->userModel = new User();
    }
    

    public function createApplication(array $data): array {
        try {
            // Verify required fields
            if (!isset($data['user_id']) || !isset($data['pet_id'])) {
                throw new RuntimeException("User ID and Pet ID are required");
            }

            // Verify user exists
            $user = $this->userModel->findById($data['user_id']);
            if (!$user) {
                throw new RuntimeException("User not found");
            }
            
            // Verify pet exists
            $pet = $this->petModel->findById($data['pet_id']);
            if (!$pet) {
                throw new RuntimeException("Pet not found");
            }
            
            // Check if user has already applied for this pet
            if ($this->applicationModel->hasUserAppliedForPet($data['user_id'], $data['pet_id'])) {
                throw new RuntimeException("You have already applied to adopt this pet");
            }
            
            // Create application with all provided fields
            $applicationData = [
                'user_id' => $data['user_id'],
                'pet_id' => $data['pet_id'],
                'status' => 'pending',
                'application_date' => date('Y-m-d'),
                'reason' => $data['reason'] ?? null,
                'experience' => $data['experience'] ?? null,
                'living_situation' => $data['living_situation'] ?? null,
                'has_other_pets' => $data['has_other_pets'] ?? false,
                'other_pets_details' => $data['other_pets_details'] ?? null,
                'daily_schedule' => $data['daily_schedule'] ?? null,
                'veterinarian' => $data['veterinarian'] ?? null,
                'status_history' => json_encode([
                    [
                        'status' => 'pending',
                        'date' => date('Y-m-d H:i:s'),
                        'note' => 'Application submitted'
                    ]
                ])
            ];
            
            // Create application
            $applicationId = $this->applicationModel->create($applicationData);
            
            // Get and format the created application
            $application = $this->applicationModel->findById($applicationId);
            if (!$application) {
                throw new RuntimeException("Failed to create application");
            }

            return [
                'success' => true,
                'data' => $application
            ];
            
        } catch (\Exception $e) {
            error_log("Error in createApplication: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function getUserApplications(int $userId): array {
        // Verify user exists
        $user = $this->userModel->findById($userId);
        if (!$user) {
            throw new RuntimeException("User not found");
        }
        
        return $this->applicationModel->findByUser($userId);
    }
    
    public function getShelterApplications(int $shelterId): array {
        return $this->applicationModel->findByShelter($shelterId);
    }
    
    public function getApplication(int $applicationId): ?array {
        $application = $this->applicationModel->findById($applicationId);
        if (!$application) {
            throw new RuntimeException("Application not found");
        }
        return $application;
    }
    
    public function updateApplicationStatus(int $applicationId, string $status): array {
        // Verify application exists
        $application = $this->applicationModel->findById($applicationId);
        if (!$application) {
            throw new RuntimeException("Application not found");
        }
        
        // Validate status
        $validStatuses = [
            AdoptionApplication::STATUS_PENDING,
            AdoptionApplication::STATUS_UNDER_REVIEW,
            AdoptionApplication::STATUS_APPROVED,
            AdoptionApplication::STATUS_REJECTED,
            AdoptionApplication::STATUS_WITHDRAWN
        ];
        
        if (!in_array($status, $validStatuses)) {
            throw new RuntimeException("Invalid application status");
        }
        
        // Update status
        $this->applicationModel->updateStatus($applicationId, $status);
        
        return $this->applicationModel->findById($applicationId);
    }
    
    public function getPetApplications(int $petId): array {
        // Verify pet exists
        $pet = $this->petModel->findById($petId);
        if (!$pet) {
            throw new RuntimeException("Pet not found");
        }
        
        return $this->applicationModel->findByPet($petId);
    }
}
=== ./backend/src/services/FavoriteService.php ===
<?php
namespace PawPath\services;

use PDO;
use RuntimeException;
use PawPath\config\database\DatabaseConfig;

class FavoriteService {
    private PDO $db;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
    }
    
    public function addFavorite(int $userId, int $petId): array {
        try {
            // Check if favorite already exists
            $stmt = $this->db->prepare("
                SELECT favorite_id FROM Pet_Favorite
                WHERE user_id = ? AND pet_id = ?
            ");
            $stmt->execute([$userId, $petId]);
            
            if ($stmt->fetch()) {
                throw new RuntimeException('Pet is already favorited');
            }
            
            // Add favorite
            $stmt = $this->db->prepare("
                INSERT INTO Pet_Favorite (user_id, pet_id)
                VALUES (?, ?)
            ");
            
            $stmt->execute([$userId, $petId]);
            
            return [
                'favorite_id' => $this->db->lastInsertId(),
                'user_id' => $userId,
                'pet_id' => $petId
            ];
        } catch (\PDOException $e) {
            throw new RuntimeException('Failed to add favorite: ' . $e->getMessage());
        }
    }
    
    public function removeFavorite(int $userId, int $petId): bool {
        try {
            $stmt = $this->db->prepare("
                DELETE FROM Pet_Favorite
                WHERE user_id = ? AND pet_id = ?
            ");
            
            $stmt->execute([$userId, $petId]);
            return $stmt->rowCount() > 0;
        } catch (\PDOException $e) {
            throw new RuntimeException('Failed to remove favorite: ' . $e->getMessage());
        }
    }
    
    public function getUserFavorites(int $userId): array {
        try {
            // First get the basic pet information
            $stmt = $this->db->prepare("
                SELECT DISTINCT 
                    p.*,
                    s.name as shelter_name,
                    pf.created_at as favorited_at
                FROM Pet_Favorite pf
                JOIN Pet p ON pf.pet_id = p.pet_id
                JOIN Shelter s ON p.shelter_id = s.shelter_id
                WHERE pf.user_id = ?
                ORDER BY pf.created_at DESC
            ");
            
            $stmt->execute([$userId]);
            $pets = $stmt->fetchAll();
            
            // For each pet, get its traits
            foreach ($pets as &$pet) {
                $stmt = $this->db->prepare("
                    SELECT t.trait_name, tc.name as category
                    FROM Pet_Trait_Relation ptr
                    JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
                    LEFT JOIN Trait_Category tc ON t.category_id = tc.category_id
                    WHERE ptr.pet_id = ?
                ");
                
                $stmt->execute([$pet['pet_id']]);
                $traits = $stmt->fetchAll();
                
                // Format traits by category
                $formattedTraits = [];
                foreach ($traits as $trait) {
                    $category = $trait['category'] ?? 'General';
                    if (!isset($formattedTraits[$category])) {
                        $formattedTraits[$category] = [];
                    }
                    $formattedTraits[$category][] = $trait['trait_name'];
                }
                
                $pet['traits'] = $formattedTraits;
            }
            
            return $pets;
        } catch (\PDOException $e) {
            throw new RuntimeException('Failed to get favorites: ' . $e->getMessage());
        }
    }
    
    public function isFavorited(int $userId, int $petId): bool {
        try {
            $stmt = $this->db->prepare("
                SELECT 1 FROM Pet_Favorite
                WHERE user_id = ? AND pet_id = ?
            ");
            
            $stmt->execute([$userId, $petId]);
            return (bool) $stmt->fetch();
        } catch (\PDOException $e) {
            throw new RuntimeException('Failed to check favorite status: ' . $e->getMessage());
        }
    }
}
=== ./backend/src/services/ShelterService.php ===
<?php
// backend/src/services/ShelterService.php

namespace PawPath\services;

use PawPath\models\Shelter;
use RuntimeException;

class ShelterService {
    private Shelter $shelterModel;
    
    public function __construct() {
        $this->shelterModel = new Shelter();
    }
    
    public function createShelter(array $data): array {
        // Validate required fields
        $requiredFields = ['name', 'address', 'phone', 'email'];
        foreach ($requiredFields as $field) {
            if (empty($data[$field])) {
                throw new RuntimeException("Missing required field: $field");
            }
        }
        
        // Validate email format
        if (!filter_var($data['email'], FILTER_VALIDATE_EMAIL)) {
            throw new RuntimeException("Invalid email format");
        }
        
        // Validate phone number (basic validation)
        if (!preg_match("/^[0-9\-\(\)\/\+\s]*$/", $data['phone'])) {
            throw new RuntimeException("Invalid phone number format");
        }
        
        // Create shelter
        $shelterId = $this->shelterModel->create($data);
        
        // Return the created shelter
        return $this->shelterModel->findById($shelterId);
    }
    
    public function updateShelter(int $id, array $data): array {
        // Verify shelter exists
        $shelter = $this->shelterModel->findById($id);
        if (!$shelter) {
            throw new RuntimeException("Shelter not found");
        }
        
        // Validate email if provided
        if (isset($data['email']) && !filter_var($data['email'], FILTER_VALIDATE_EMAIL)) {
            throw new RuntimeException("Invalid email format");
        }
        
        // Validate phone if provided
        if (isset($data['phone']) && !preg_match("/^[0-9\-\(\)\/\+\s]*$/", $data['phone'])) {
            throw new RuntimeException("Invalid phone number format");
        }
        
        // Update shelter
        $success = $this->shelterModel->update($id, $data);
        if (!$success) {
            throw new RuntimeException("Failed to update shelter");
        }
        
        // Return updated shelter
        return $this->shelterModel->findById($id);
    }
    
    public function deleteShelter(int $id): bool {
        // Verify shelter exists
        $shelter = $this->shelterModel->findById($id);
        if (!$shelter) {
            throw new RuntimeException("Shelter not found");
        }
        
        return $this->shelterModel->delete($id);
    }
    
    public function getShelter(int $id): ?array {
        $shelter = $this->shelterModel->findById($id);
        if (!$shelter) {
            throw new RuntimeException("Shelter not found");
        }
        return $shelter;
    }
    
    public function listShelters(array $filters = []): array {
        return $this->shelterModel->findAll($filters);
    }
}
=== ./backend/src/services/UserRoleService.php ===
<?php
namespace PawPath\services;

use PawPath\config\database\DatabaseConfig;
use PawPath\models\User;
use RuntimeException;
use PDO;

class UserRoleService {
    private PDO $db;
    private User $userModel;
    
    private const VALID_ROLES = ['adopter', 'shelter_staff', 'admin'];
    private const ROLE_HIERARCHY = [
        'admin' => ['admin', 'shelter_staff', 'adopter'],
        'shelter_staff' => ['shelter_staff', 'adopter'],
        'adopter' => ['adopter']
    ];
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
        $this->userModel = new User();
    }
    
    public function changeUserRole(int $userId, string $newRole, int $changedBy, string $reason = null): bool {
        try {
            // Start transaction
            $this->db->beginTransaction();
            
            // Get user's current role
            $user = $this->userModel->findById($userId);
            if (!$user) {
                throw new RuntimeException('User not found');
            }
            
            // Get admin user making the change
            $admin = $this->userModel->findById($changedBy);
            if (!$admin) {
                throw new RuntimeException('Admin user not found');
            }
            
            // Validate role change permissions
            if (!$this->canChangeRole($admin['role'], $user['role'], $newRole)) {
                throw new RuntimeException('Insufficient permissions to change role');
            }
            
            // Update user's role
            $stmt = $this->db->prepare("
                UPDATE User 
                SET role = ? 
                WHERE user_id = ?
            ");
            
            $stmt->execute([$newRole, $userId]);
            
            // Log the role change
            $stmt = $this->db->prepare("
                INSERT INTO RoleChangeLog (
                    user_id, old_role, new_role, 
                    changed_by, reason
                ) VALUES (?, ?, ?, ?, ?)
            ");
            
            $stmt->execute([
                $userId,
                $user['role'],
                $newRole,
                $changedBy,
                $reason
            ]);
            
            // If changing to shelter staff, may need additional setup
            if ($newRole === 'shelter_staff') {
                // Handle shelter staff specific setup here
                // e.g., default shelter assignment
            }
            
            $this->db->commit();
            return true;
            
        } catch (\Exception $e) {
            $this->db->rollBack();
            throw $e;
        }
    }
    
    public function assignToShelter(int $userId, int $shelterId, string $position = 'staff'): bool {
        try {
            $this->db->beginTransaction();
            
            // Verify user is shelter_staff
            $user = $this->userModel->findById($userId);
            if ($user['role'] !== 'shelter_staff') {
                throw new RuntimeException('User must be shelter staff');
            }
            
            // Add shelter staff relationship
            $stmt = $this->db->prepare("
                INSERT INTO ShelterStaff (
                    shelter_id, user_id, position
                ) VALUES (?, ?, ?)
                ON DUPLICATE KEY UPDATE position = ?
            ");
            
            $stmt->execute([$shelterId, $userId, $position, $position]);
            
            $this->db->commit();
            return true;
            
        } catch (\Exception $e) {
            $this->db->rollBack();
            throw $e;
        }
    }
    
    public function getUsersByRole(string $role): array {
        $stmt = $this->db->prepare("
            SELECT user_id, username, email, registration_date, account_status
            FROM User 
            WHERE role = ?
            ORDER BY username
        ");
        
        $stmt->execute([$role]);
        return $stmt->fetchAll();
    }
    
    private function canChangeRole(string $adminRole, string $currentRole, string $newRole): bool {
        // Only admins can change roles
        if ($adminRole !== 'admin') {
            return false;
        }
        
        // Validate role exists
        if (!in_array($newRole, self::VALID_ROLES)) {
            return false;
        }
        
        // Special case: can't change own role or other admins
        if ($currentRole === 'admin') {
            return false;
        }
        
        return true;
    }
}
=== ./backend/src/services/AuthService.php ===
<?php
namespace PawPath\services;

use PDO;
use RuntimeException;
use Firebase\JWT\JWT;
use Firebase\JWT\Key;
use PawPath\config\database\DatabaseConfig;

class AuthService {
    private PDO $db;
    private string $jwtSecret;
    
    public function __construct() {
        $this->db = DatabaseConfig::getConnection();
        $this->jwtSecret = $_ENV['JWT_SECRET'] ?? throw new RuntimeException('JWT_SECRET not set');
    }
    
    public function register(array $data): array {
        try {
            // Validate required fields
            if (empty($data['username']) || empty($data['email']) || empty($data['password'])) {
                throw new RuntimeException('Missing required fields');
            }

            // Check if email already exists
            $stmt = $this->db->prepare("
                SELECT user_id FROM User WHERE email = ?
            ");
            $stmt->execute([$data['email']]);
            if ($stmt->fetch()) {
                throw new RuntimeException('Email already registered');
            }

            // Check if username already exists
            $stmt = $this->db->prepare("
                SELECT user_id FROM User WHERE username = ?
            ");
            $stmt->execute([$data['username']]);
            if ($stmt->fetch()) {
                throw new RuntimeException('Username already taken');
            }

            // Create user
            $stmt = $this->db->prepare("
                INSERT INTO User (
                    username, 
                    email, 
                    password_hash, 
                    registration_date,
                    role,
                    account_status,
                    email_verification_token,
                    email_token_expires_at
                ) VALUES (?, ?, ?, CURRENT_TIMESTAMP, 'adopter', 'pending', ?, DATE_ADD(NOW(), INTERVAL 24 HOUR))
            ");

            $verificationToken = bin2hex(random_bytes(32));
            $passwordHash = password_hash($data['password'], PASSWORD_DEFAULT);

            $stmt->execute([
                $data['username'],
                $data['email'],
                $passwordHash,
                $verificationToken
            ]);

            $userId = (int) $this->db->lastInsertId();

            // Get the created user
            $user = $this->getUser($userId);
            if (!$user) {
                throw new RuntimeException('Failed to create user');
            }

            // Generate JWT token
            $token = $this->generateToken($userId);

            // Return user data and token
            return [
                'user' => $user,
                'token' => $token
            ];

        } catch (\PDOException $e) {
            error_log("Database error during registration: " . $e->getMessage());
            throw new RuntimeException('Registration failed: Database error');
        } catch (\Exception $e) {
            error_log("Registration error: " . $e->getMessage());
            throw $e;
        }
    }

    public function login(array $data): array {
        try {
            if (empty($data['email']) || empty($data['password'])) {
                throw new RuntimeException('Email and password are required');
            }

            // Find user
            $stmt = $this->db->prepare("
                SELECT 
                    user_id, 
                    username, 
                    email, 
                    password_hash, 
                    role, 
                    account_status
                FROM User 
                WHERE email = ?
            ");
            
            $stmt->execute([$data['email']]);
            $user = $stmt->fetch(PDO::FETCH_ASSOC);
            
            if (!$user) {
                throw new RuntimeException('Invalid credentials');
            }

            if (!password_verify($data['password'], $user['password_hash'])) {
                throw new RuntimeException('Invalid credentials');
            }
            
            // Remove sensitive data
            unset($user['password_hash']);
            
            // Generate token
            $token = $this->generateToken($user['user_id']);
            
            // Update last login
            $this->updateLastLogin($user['user_id']);
            
            return [
                'token' => $token,
                'user' => $user
            ];
        } catch (\Exception $e) {
            error_log('Login error in service: ' . $e->getMessage());
            throw $e;
        }
    }
    
    public function getUser(int $userId): ?array {
        try {
            $stmt = $this->db->prepare("
                SELECT 
                    user_id,
                    username,
                    email,
                    role,
                    account_status,
                    registration_date,
                    last_login
                FROM User 
                WHERE user_id = ?
            ");
            
            $stmt->execute([$userId]);
            return $stmt->fetch(PDO::FETCH_ASSOC);
        } catch (\PDOException $e) {
            error_log("Database error while fetching user: " . $e->getMessage());
            throw new RuntimeException('Failed to fetch user data');
        }
    }

    public function createEmailVerificationToken(int $userId): string {
        try {
            $token = bin2hex(random_bytes(32));
            $stmt = $this->db->prepare("
                UPDATE User 
                SET email_verification_token = ?,
                    email_token_expires_at = DATE_ADD(NOW(), INTERVAL 24 HOUR)
                WHERE user_id = ?
            ");
            
            $stmt->execute([$token, $userId]);
            return $token;
        } catch (\Exception $e) {
            error_log("Error creating verification token: " . $e->getMessage());
            throw new RuntimeException('Failed to create verification token');
        }
    }

    public function verifyEmailToken(string $token): bool {
        try {
            $stmt = $this->db->prepare("
                UPDATE User 
                SET email_verified_at = CURRENT_TIMESTAMP,
                    account_status = 'active',
                    email_verification_token = NULL
                WHERE email_verification_token = ?
                AND email_token_expires_at > CURRENT_TIMESTAMP
                AND email_verified_at IS NULL
            ");
            
            $stmt->execute([$token]);
            return $stmt->rowCount() > 0;
        } catch (\PDOException $e) {
            error_log("Database error during email verification: " . $e->getMessage());
            throw new RuntimeException('Failed to verify email');
        }
    }

    public function generateToken(int $userId): string {
        $payload = [
            'user_id' => $userId,
            'iat' => time(),
            'exp' => time() + (24 * 60 * 60) // 24 hours
        ];
        
        return JWT::encode($payload, $this->jwtSecret, 'HS256');
    }
    
    public function validateToken(string $token): ?array {
        try {
            return (array) JWT::decode($token, new Key($this->jwtSecret, 'HS256'));
        } catch (\Exception $e) {
            error_log('Token validation error: ' . $e->getMessage());
            return null;
        }
    }

    public function resendVerificationEmail(int $userId): bool {
        try {
            // Check if user exists and needs verification
            $stmt = $this->db->prepare("
                SELECT email, username, email_verified_at 
                FROM User 
                WHERE user_id = ?
            ");
            $stmt->execute([$userId]);
            $user = $stmt->fetch(PDO::FETCH_ASSOC);

            if (!$user) {
                throw new RuntimeException('User not found');
            }

            if ($user['email_verified_at']) {
                throw new RuntimeException('Email already verified');
            }

            // Create new verification token
            $token = $this->createEmailVerificationToken($userId);

            // Send verification email
            $emailService = new EmailService();
            return $emailService->sendVerificationEmail(
                $user['email'],
                $user['username'],
                $token
            );
        } catch (\Exception $e) {
            error_log("Error resending verification email: " . $e->getMessage());
            throw $e;
        }
    }
    
    private function updateLastLogin(int $userId): void {
        try {
            $stmt = $this->db->prepare("
                UPDATE User 
                SET last_login = CURRENT_TIMESTAMP 
                WHERE user_id = ?
            ");
            $stmt->execute([$userId]);
        } catch (\PDOException $e) {
            error_log("Error updating last login: " . $e->getMessage());
            // Non-critical error, don't throw
        }
    }
}
=== ./backend/src/services/PetService.php ===
<?php
namespace PawPath\services;

use PDO;
use PDOException;
use PawPath\config\database\DatabaseConfig as DbConfig;  // Use an alias to avoid conflict

class PetService {
    private PDO $db;
    
    public function __construct() {
        $this->db = DbConfig::getConnection();  // Use the alias here
    }

    public function getPet(int $id): array {
        try {
            $stmt = $this->db->prepare("
                SELECT p.*, s.name as shelter_name
                FROM Pet p
                LEFT JOIN Shelter s ON p.shelter_id = s.shelter_id
                WHERE p.pet_id = ?
            ");
            
            $stmt->execute([$id]);
            $pet = $stmt->fetch(PDO::FETCH_ASSOC);
            
            if (!$pet) {
                throw new \RuntimeException("Pet not found");
            }
            
            // Get images
            $stmt = $this->db->prepare("
                SELECT image_id, image_url as url, is_primary
                FROM Pet_Image
                WHERE pet_id = ?
                ORDER BY is_primary DESC, image_id ASC
            ");
            $stmt->execute([$id]);
            $pet['images'] = $stmt->fetchAll(PDO::FETCH_ASSOC);
            
            error_log("Pet data with images: " . print_r($pet, true));
            
            // Get traits
            $stmt = $this->db->prepare("
                SELECT t.trait_name, tc.name as category
                FROM Pet_Trait_Relation ptr
                JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
                LEFT JOIN Trait_Category tc ON t.category_id = tc.category_id
                WHERE ptr.pet_id = ?
            ");
            $stmt->execute([$id]);
            $traits = $stmt->fetchAll(PDO::FETCH_ASSOC);
            
            $formattedTraits = [];
            foreach ($traits as $trait) {
                $category = $trait['category'] ?? 'General';
                if (!isset($formattedTraits[$category])) {
                    $formattedTraits[$category] = [];
                }
                $formattedTraits[$category][] = $trait['trait_name'];
            }
            
            $pet['traits'] = $formattedTraits;
            
            return $pet;
        } catch (PDOException $e) {
            error_log("Database error finding pet: " . $e->getMessage());
            throw new \RuntimeException("Failed to fetch pet data");
        }
    }
    
    public function createPet(array $data): array {
        try {
            error_log("Creating pet with data: " . json_encode($data));
            
            // Validate required fields
            $requiredFields = ['name', 'species', 'shelter_id'];
            foreach ($requiredFields as $field) {
                if (empty($data[$field])) {
                    throw new RuntimeException("Missing required field: $field");
                }
            }
            
            // Create pet
            $petId = $this->petModel->create($data);
            error_log("Created pet with ID: $petId");
            
            $pet = $this->petModel->findById($petId);
            if (!$pet) {
                throw new RuntimeException("Failed to retrieve created pet");
            }
            
            return $pet;
        } catch (\Exception $e) {
            error_log("Error in PetService::createPet: " . $e->getMessage());
            throw $e;
        }
    }
    
    public function updatePet(int $id, array $data): array {
        // Verify pet exists
        $pet = $this->petModel->findById($id);
        if (!$pet) {
            throw new RuntimeException("Pet not found");
        }
        
        // Validate species if provided
        if (isset($data['species'])) {
            $validSpecies = ['Dog', 'Cat', 'Bird', 'Rabbit', 'Other'];
            if (!in_array($data['species'], $validSpecies)) {
                throw new RuntimeException("Invalid species");
            }
        }
        
        // Validate age if provided
        if (isset($data['age']) && ($data['age'] < 0 || $data['age'] > 30)) {
            throw new RuntimeException("Invalid age");
        }
        
        // Validate gender if provided
        if (isset($data['gender'])) {
            $validGenders = ['Male', 'Female'];
            if (!in_array($data['gender'], $validGenders)) {
                throw new RuntimeException("Invalid gender");
            }
        }
        
        // Validate shelter if provided
        if (isset($data['shelter_id'])) {
            if (!$this->shelterModel->findById($data['shelter_id'])) {
                throw new RuntimeException("Invalid shelter ID");
            }
        }
        
        // Validate traits if provided
        if (isset($data['traits'])) {
            foreach ($data['traits'] as $traitId) {
                if (!$this->traitModel->findById($traitId)) {
                    throw new RuntimeException("Invalid trait ID: $traitId");
                }
            }
        }
        
        // Update pet
        $this->petModel->update($id, $data);
        return $this->petModel->findById($id);
    }

    private function formatTraits(array $traits): array {
        $formatted = [];
        foreach ($traits as $trait) {
            $category = $trait['category'] ?? 'General';
            if (!isset($formatted[$category])) {
                $formatted[$category] = [];
            }
            if (!in_array($trait['trait_name'], $formatted[$category])) {
                $formatted[$category][] = $trait['trait_name'];
            }
        }
        return $formatted;
    }
    
    public function deletePet(int $id): bool {
        // Verify pet exists
        $pet = $this->petModel->findById($id);
        if (!$pet) {
            throw new RuntimeException("Pet not found");
        }
        
        // Check if pet has any pending adoption applications
        // This would be implemented when we add the adoption system
        
        return $this->petModel->delete($id);
    }
    
    public function listPets(array $filters = []): array {
        try {
            $query = "
                SELECT p.*, s.name as shelter_name,
                COUNT(*) OVER() as total_count
                FROM Pet p
                LEFT JOIN Shelter s ON p.shelter_id = s.shelter_id
                WHERE 1=1
            ";
            $params = [];
            
            // Add filter conditions...
            if (!empty($filters['search'])) {
                $query .= " AND (p.name LIKE ? OR p.breed LIKE ? OR p.description LIKE ?)";
                $searchTerm = '%' . $filters['search'] . '%';
                $params = array_merge($params, [$searchTerm, $searchTerm, $searchTerm]);
            }
            
            // Add pagination
            if (isset($filters['limit'])) {
                $query .= " LIMIT ?";
                $params[] = (int)$filters['limit'];
                
                if (isset($filters['offset'])) {
                    $query .= " OFFSET ?";
                    $params[] = (int)$filters['offset'];
                }
            }
            
            $stmt = $this->db->prepare($query);
            $stmt->execute($params);
            $pets = $stmt->fetchAll(PDO::FETCH_ASSOC);
            
            $total = $pets[0]['total_count'] ?? 0;
            
            // Get images for each pet
            foreach ($pets as &$pet) {
                // Get images
                $stmt = $this->db->prepare("
                    SELECT image_id, image_url as url, is_primary
                    FROM Pet_Image
                    WHERE pet_id = ?
                    ORDER BY is_primary DESC, image_id ASC
                ");
                $stmt->execute([$pet['pet_id']]);
                $pet['images'] = $stmt->fetchAll(PDO::FETCH_ASSOC);
                
                // Get traits
                $stmt = $this->db->prepare("
                    SELECT t.trait_name, tc.name as category
                    FROM Pet_Trait_Relation ptr
                    JOIN Pet_Trait t ON ptr.trait_id = t.trait_id
                    LEFT JOIN Trait_Category tc ON t.category_id = tc.category_id
                    WHERE ptr.pet_id = ?
                ");
                $stmt->execute([$pet['pet_id']]);
                $traits = $stmt->fetchAll(PDO::FETCH_ASSOC);
                
                // Format traits
                $formattedTraits = [];
                foreach ($traits as $trait) {
                    $category = $trait['category'] ?? 'General';
                    if (!isset($formattedTraits[$category])) {
                        $formattedTraits[$category] = [];
                    }
                    $formattedTraits[$category][] = $trait['trait_name'];
                }
                $pet['traits'] = $formattedTraits;
                
                // Remove the count from individual pets
                unset($pet['total_count']);
            }
            
            return [
                'pets' => $pets,
                'total' => $total
            ];
        } catch (PDOException $e) {
            error_log("Error in listPets: " . $e->getMessage());
            throw new \RuntimeException("Failed to fetch pets");
        }
    }
    
    public function addTrait(string $traitName): array {
        // Validate trait name
        if (empty(trim($traitName))) {
            throw new RuntimeException("Trait name cannot be empty");
        }
        
        $traitId = $this->traitModel->create($traitName);
        return $this->traitModel->findById($traitId);
    }
    
    public function listTraits(): array {
        return $this->traitModel->findAll();
    }
}
=== ./backend/src/services/EmailService.php ===
<?php
namespace PawPath\services;

use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;
use PHPMailer\PHPMailer\SMTP;
use RuntimeException;

class EmailService {
    private ?PHPMailer $mailer = null;
    
    public function __construct() {
        // Defer mailer initialization until needed
    }
    
    private function initializeMailer(): void {
        if ($this->mailer !== null) {
            return;
        }

        try {
            $this->mailer = new PHPMailer(true);
            
            if (!empty($_ENV['MAIL_HOST'])) {
                $this->mailer->isSMTP();
                $this->mailer->Host = $_ENV['MAIL_HOST'];
                $this->mailer->SMTPAuth = true;
                $this->mailer->Username = $_ENV['MAIL_USERNAME'] ?? '';
                $this->mailer->Password = $_ENV['MAIL_PASSWORD'] ?? '';
                $this->mailer->SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS;
                $this->mailer->Port = $_ENV['MAIL_PORT'] ?? 587;
            } else {
                $this->mailer->isMail();
            }
            
            $this->mailer->setFrom(
                $_ENV['MAIL_FROM_ADDRESS'] ?? 'noreply@pawpath.com',
                $_ENV['MAIL_FROM_NAME'] ?? 'PawPath'
            );
            
            if ($_ENV['APP_ENV'] === 'development') {
                $this->mailer->SMTPDebug = SMTP::DEBUG_SERVER;
            }
        } catch (Exception $e) {
            error_log("Failed to initialize mailer: " . $e->getMessage());
            throw new RuntimeException("Email service configuration error");
        }
    }
    
    public function sendVerificationEmail(string $email, string $name, string $token): bool {
        try {
            $this->initializeMailer();
            
            $this->mailer->clearAddresses();
            $this->mailer->addAddress($email, $name);
            $this->mailer->isHTML(true);
            
            $verificationLink = $_ENV['APP_URL'] . "/verify-email?token=" . $token;
            
            $this->mailer->Subject = 'Verify your PawPath account';
            $this->mailer->Body = $this->getVerificationEmailTemplate($name, $verificationLink);
            $this->mailer->AltBody = strip_tags(str_replace('<br>', "\n", $this->mailer->Body));
            
            return $this->mailer->send();
        } catch (Exception $e) {
            error_log("Failed to send verification email: " . $e->getMessage());
            return false;
        }
    }

    public function sendPasswordResetEmail(string $email, string $name, string $token): bool {
        try {
            $this->initializeMailer();
            
            $this->mailer->clearAddresses();
            $this->mailer->addAddress($email, $name);
            $this->mailer->isHTML(true);
            
            $resetLink = $_ENV['APP_URL'] . "/reset-password?token=" . $token;
            
            $this->mailer->Subject = 'Reset Your PawPath Password';
            $this->mailer->Body = $this->getPasswordResetEmailTemplate($name, $resetLink);
            $this->mailer->AltBody = strip_tags(str_replace('<br>', "\n", $this->mailer->Body));
            
            return $this->mailer->send();
        } catch (Exception $e) {
            error_log("Failed to send password reset email: " . $e->getMessage());
            return false;
        }
    }

    public function sendWelcomeEmail(string $email, string $name): bool {
        try {
            $this->initializeMailer();
            
            $this->mailer->clearAddresses();
            $this->mailer->addAddress($email, $name);
            $this->mailer->isHTML(true);
            
            $this->mailer->Subject = 'Welcome to PawPath!';
            $this->mailer->Body = $this->getWelcomeEmailTemplate($name);
            $this->mailer->AltBody = strip_tags(str_replace('<br>', "\n", $this->mailer->Body));
            
            return $this->mailer->send();
        } catch (Exception $e) {
            error_log("Failed to send welcome email: " . $e->getMessage());
            return false;
        }
    }
    
    private function getVerificationEmailTemplate(string $name, string $link): string {
        return "
            <div style='font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;'>
                <h2>Welcome to PawPath!</h2>
                <p>Hi {$name},</p>
                <p>Thanks for signing up. Please verify your email address to complete your registration.</p>
                <p style='margin: 25px 0;'>
                    <a href='{$link}' 
                       style='background-color: #4F46E5; color: white; padding: 12px 24px; 
                              text-decoration: none; border-radius: 4px;'>
                        Verify Email Address
                    </a>
                </p>
                <p>If you did not create an account, no further action is required.</p>
                <p>Best regards,<br>The PawPath Team</p>
            </div>
        ";
    }
    
    private function getPasswordResetEmailTemplate(string $name, string $link): string {
        return "
            <div style='font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;'>
                <h2>Reset Your Password</h2>
                <p>Hi {$name},</p>
                <p>You recently requested to reset your password. Click the button below to proceed:</p>
                <p style='margin: 25px 0;'>
                    <a href='{$link}' 
                       style='background-color: #4F46E5; color: white; padding: 12px 24px; 
                              text-decoration: none; border-radius: 4px;'>
                        Reset Password
                    </a>
                </p>
                <p>If you did not request a password reset, please ignore this email.</p>
                <p>Best regards,<br>The PawPath Team</p>
            </div>
        ";
    }
    
    private function getWelcomeEmailTemplate(string $name): string {
        return "
            <div style='font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;'>
                <h2>Welcome to PawPath!</h2>
                <p>Hi {$name},</p>
                <p>We're excited to have you join our community of pet lovers!</p>
                <p>With PawPath, you can:</p>
                <ul>
                    <li>Find your perfect pet companion</li>
                    <li>Connect with local shelters</li>
                    <li>Access resources about pet care</li>
                    <li>Join our community of pet lovers</li>
                </ul>
                <p>Ready to get started?</p>
                <p style='margin: 25px 0;'>
                    <a href='{$_ENV['APP_URL']}/quiz' 
                       style='background-color: #4F46E5; color: white; padding: 12px 24px; 
                              text-decoration: none; border-radius: 4px;'>
                        Take Our Pet Match Quiz
                    </a>
                </p>
                <p>Best regards,<br>The PawPath Team</p>
            </div>
        ";
    }
}
=== ./backend/src/services/BlogService.php ===
<?php
// src/services/BlogService.php
namespace PawPath\services;

use PawPath\models\BlogPost;
use PawPath\models\User;
use RuntimeException;

class BlogService {
    private BlogPost $blogModel;
    private User $userModel;
    
    public function __construct() {
        $this->blogModel = new BlogPost();
        $this->userModel = new User();
    }
    
    public function createPost(array $data): array {
        // Validate required fields
        if (empty($data['title']) || empty($data['content'])) {
            throw new RuntimeException("Title and content are required");
        }
        
        // Verify author exists
        if (!$this->userModel->findById($data['author_id'])) {
            throw new RuntimeException("Invalid author");
        }
        
        // Create post
        $postId = $this->blogModel->create($data);
        return $this->blogModel->findById($postId);
    }
    
    public function getPost(int $id): array {
        $post = $this->blogModel->findById($id);
        if (!$post) {
            throw new RuntimeException("Post not found");
        }
        return $post;
    }
    
    public function listPosts(array $filters = []): array {
        return $this->blogModel->findAll($filters);
    }
    
    public function updatePost(int $id, array $data, int $userId): array {
        // Verify post exists and user is the author
        $post = $this->blogModel->findById($id);
        if (!$post) {
            throw new RuntimeException("Post not found");
        }
        
        if ($post['author_id'] !== $userId) {
            throw new RuntimeException("Unauthorized to update this post");
        }
        
        // Update post
        $this->blogModel->update($id, $data);
        return $this->blogModel->findById($id);
    }
    
    public function deletePost(int $id, int $userId): void {
        // Verify post exists and user is the author
        $post = $this->blogModel->findById($id);
        if (!$post) {
            throw new RuntimeException("Post not found");
        }
        
        if ($post['author_id'] !== $userId) {
            throw new RuntimeException("Unauthorized to delete this post");
        }
        
        // Delete post
        if (!$this->blogModel->delete($id)) {
            throw new RuntimeException("Failed to delete post");
        }
    }
}
=== ./backend/src/services/QuizService.php ===
<?php
// src/services/QuizService.php
namespace PawPath\services;

use PawPath\models\StartingQuiz;
use PawPath\models\QuizResult;
use PawPath\models\Pet;

class QuizService {
    private StartingQuiz $startingQuiz;
    private QuizResult $quizResult;
    private Pet $petModel;
    
    // Question weights for scoring
    private const QUESTION_WEIGHTS = [
        'living_space' => 2.0,    // High impact on pet suitability
        'activity_level' => 1.5,  // Important for energy matching
        'time_available' => 1.5,  // Critical for care requirements
        'experience' => 1.0,      // Influences training needs
        'children' => 1.8,        // Important for safety
        'other_pets' => 1.0,      // Affects compatibility
        'budget' => 1.3,          // Practical consideration
        'allergies' => 2.0,       // Critical health factor
        'noise_tolerance' => 1.2  // Environmental factor
    ];
    
    public function __construct() {
        $this->startingQuiz = new StartingQuiz();
        $this->quizResult = new QuizResult();
        $this->petModel = new Pet();
    }
    
    public function getQuizQuestions(): array {
        return [
            'sections' => [
                [
                    'id' => 'living_situation',
                    'title' => 'Living Situation',
                    'questions' => [
                        [
                            'id' => 'living_space',
                            'text' => 'What type of home do you live in?',
                            'type' => 'single_choice',
                            'options' => [
                                'apartment_small' => 'Small Apartment',
                                'apartment_large' => 'Large Apartment',
                                'house_small' => 'Small House',
                                'house_large' => 'Large House with Yard'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['living_space']
                        ],
                        [
                            'id' => 'outdoor_access',
                            'text' => 'Do you have access to outdoor space?',
                            'type' => 'multiple_choice',
                            'options' => [
                                'private_yard' => 'Private Yard',
                                'shared_yard' => 'Shared Yard/Garden',
                                'nearby_park' => 'Nearby Park',
                                'no_outdoor' => 'Limited Outdoor Access'
                            ]
                        ],
                        [
                            'id' => 'rental_restrictions',
                            'text' => 'Do you have any pet restrictions where you live?',
                            'type' => 'multiple_choice',
                            'options' => [
                                'no_restrictions' => 'No Restrictions',
                                'size_limits' => 'Size/Weight Limits',
                                'breed_restrictions' => 'Breed Restrictions',
                                'no_dogs' => 'No Dogs Allowed',
                                'no_cats' => 'No Cats Allowed'
                            ]
                        ]
                    ]
                ],
                [
                    'id' => 'lifestyle',
                    'title' => 'Your Lifestyle',
                    'questions' => [
                        [
                            'id' => 'activity_level',
                            'text' => 'How would you describe your activity level?',
                            'type' => 'single_choice',
                            'options' => [
                                'very_active' => 'Very Active (Daily Exercise)',
                                'moderate' => 'Moderately Active',
                                'somewhat' => 'Somewhat Active',
                                'sedentary' => 'Mostly Sedentary'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['activity_level']
                        ],
                        [
                            'id' => 'time_available',
                            'text' => 'How much time can you dedicate to pet care daily?',
                            'type' => 'single_choice',
                            'options' => [
                                'very_limited' => 'Less than 1 hour',
                                'limited' => '1-2 hours',
                                'moderate' => '2-4 hours',
                                'extensive' => '4+ hours'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['time_available']
                        ],
                        [
                            'id' => 'work_schedule',
                            'text' => 'What best describes your work/daily schedule?',
                            'type' => 'single_choice',
                            'options' => [
                                'home_all_day' => 'Home Most of the Day',
                                'regular_hours' => 'Regular 9-5 Schedule',
                                'long_hours' => 'Long Hours Away',
                                'variable' => 'Variable/Unpredictable Schedule'
                            ]
                        ]
                    ]
                ],
                [
                    'id' => 'household',
                    'title' => 'Household Information',
                    'questions' => [
                        [
                            'id' => 'children',
                            'text' => 'Are there children in your household?',
                            'type' => 'multiple_choice',
                            'options' => [
                                'no_children' => 'No Children',
                                'young_children' => 'Young Children (0-6)',
                                'older_children' => 'Older Children (7-12)',
                                'teenagers' => 'Teenagers (13+)'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['children']
                        ],
                        [
                            'id' => 'other_pets',
                            'text' => 'Do you have other pets?',
                            'type' => 'multiple_choice',
                            'options' => [
                                'no_pets' => 'No Other Pets',
                                'dogs' => 'Dogs',
                                'cats' => 'Cats',
                                'other_pets' => 'Other Pets'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['other_pets']
                        ]
                    ]
                ],
                [
                    'id' => 'experience',
                    'title' => 'Pet Experience',
                    'questions' => [
                        [
                            'id' => 'pet_experience',
                            'text' => 'What is your experience with pets?',
                            'type' => 'single_choice',
                            'options' => [
                                'first_time' => 'First-time Pet Owner',
                                'some_experience' => 'Some Experience',
                                'experienced' => 'Experienced Pet Owner',
                                'professional' => 'Professional Experience'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['experience']
                        ],
                        [
                            'id' => 'training_willingness',
                            'text' => 'Are you willing to attend training classes or work with a trainer?',
                            'type' => 'single_choice',
                            'options' => [
                                'definitely' => 'Definitely',
                                'maybe' => 'Maybe if Needed',
                                'prefer_not' => 'Prefer Not To',
                                'no' => 'Not Interested'
                            ]
                        ]
                    ]
                ],
                [
                    'id' => 'practical_considerations',
                    'title' => 'Practical Considerations',
                    'questions' => [
                        [
                            'id' => 'budget',
                            'text' => 'What is your monthly budget for pet care (including food, supplies, and routine vet care)?',
                            'type' => 'single_choice',
                            'options' => [
                                'limited' => 'Under $50',
                                'moderate' => '$50-$100',
                                'flexible' => '$100-$200',
                                'unlimited' => '$200+'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['budget']
                        ],
                        [
                            'id' => 'grooming',
                            'text' => 'How much grooming are you willing to do?',
                            'type' => 'single_choice',
                            'options' => [
                                'minimal' => 'Minimal (Basic Care)',
                                'moderate' => 'Moderate (Weekly Grooming)',
                                'high' => 'High (Daily Grooming)',
                                'professional' => 'Will Use Professional Groomer'
                            ]
                        ],
                        [
                            'id' => 'allergies',
                            'text' => 'Does anyone in your household have pet allergies?',
                            'type' => 'multiple_choice',
                            'options' => [
                                'no_allergies' => 'No Allergies',
                                'cat_allergies' => 'Cat Allergies',
                                'dog_allergies' => 'Dog Allergies',
                                'other_allergies' => 'Other Animal Allergies'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['allergies']
                        ]
                    ]
                ],
                [
                    'id' => 'preferences',
                    'title' => 'Pet Preferences',
                    'questions' => [
                        [
                            'id' => 'size_preference',
                            'text' => 'What size pet are you looking for?',
                            'type' => 'multiple_choice',
                            'options' => [
                                'small' => 'Small',
                                'medium' => 'Medium',
                                'large' => 'Large',
                                'no_preference' => 'No Preference'
                            ]
                        ],
                        [
                            'id' => 'noise_tolerance',
                            'text' => 'How much noise can you tolerate from a pet?',
                            'type' => 'single_choice',
                            'options' => [
                                'silent' => 'Prefer Silent Pets',
                                'some_noise' => 'Some Noise is OK',
                                'moderate' => 'Moderate Barking/Noise OK',
                                'any_noise' => 'Noise Doesn\'t Bother Me'
                            ],
                            'weight' => self::QUESTION_WEIGHTS['noise_tolerance']
                        ],
                        [
                            'id' => 'exercise_commitment',
                            'text' => 'How much exercise can you provide?',
                            'type' => 'single_choice',
                            'options' => [
                                'minimal' => 'Minimal (Short Walks)',
                                'moderate' => 'Moderate (Daily Walks)',
                                'active' => 'Active (Long Walks/Play)',
                                'very_active' => 'Very Active (Running/Hiking)'
                            ]
                        ]
                    ]
                ]
        ]
    ];
}
     
    public function processQuiz(int $userId, array $answers): array {
        try {
            // Create new quiz entry
            $quizId = $this->startingQuiz->create($userId);
            
            // Analyze answers and generate recommendations
            $analysis = $this->analyzeAnswers($answers);
            
            // Calculate confidence score
            $confidenceScore = $this->calculateConfidenceScore($answers);
            
            // Save results
            $resultData = [
                'quiz_id' => $quizId,
                'recommended_species' => $analysis['recommended_species'],
                'recommended_breed' => $analysis['recommended_breed'],
                'trait_preferences' => $analysis['trait_preferences'],
                'confidence_score' => $confidenceScore
            ];
            
            $resultId = $this->quizResult->create($resultData);
            
            // Find matching pets
            $matchingPets = $this->findMatchingPets($analysis);
            
            return [
                'quiz_id' => $quizId,
                'result_id' => $resultId,
                'recommendations' => $analysis,
                'confidence_score' => $confidenceScore,
                'matching_pets' => $matchingPets
            ];
        } catch (\Exception $e) {
            error_log("Error processing quiz: " . $e->getMessage());
            throw $e;
        }
    }
        
    private function analyzeAnswers(array $answers): array {
        $speciesScores = [
            'dog' => 0,
            'cat' => 0,
            'bird' => 0,
            'rabbit' => 0
        ];
        
        // Use associative array to prevent duplicates
        $traitPreferences = [];
        
        // Helper function to add trait
        $addTrait = function($trait, $value) use (&$traitPreferences) {
            $traitPreferences[$trait] = [
                'trait' => $trait,
                'value' => $value
            ];
        };
        
        // Process living situation
        if (isset($answers['living_situation'])) {
            if (isset($answers['living_situation']['living_space'])) {
                switch ($answers['living_situation']['living_space']) {
                    case 'house_large':
                        $speciesScores['dog'] += 2 * self::QUESTION_WEIGHTS['living_space'];
                        $addTrait('High Energy', 'binary');
                        $addTrait('Easily Trained', 'binary');
                        break;
                    case 'apartment_small':
                        $speciesScores['cat'] += 2 * self::QUESTION_WEIGHTS['living_space'];
                        $addTrait('Apartment Friendly', 'binary');
                        $addTrait('Calm', 'binary');
                        break;
                }
            }
        }
        
        // Process lifestyle
        if (isset($answers['lifestyle'])) {
            if (isset($answers['lifestyle']['activity_level'])) {
                switch ($answers['lifestyle']['activity_level']) {
                    case 'very_active':
                        $speciesScores['dog'] += 2 * self::QUESTION_WEIGHTS['activity_level'];
                        $addTrait('High Energy', 'binary');
                        break;
                    case 'moderate':
                        $addTrait('Easily Trained', 'binary');
                        break;
                    case 'sedentary':
                        $speciesScores['cat'] += 1.5;
                        $addTrait('Calm', 'binary');
                        break;
                }
            }
        }
        
        // Convert trait preferences back to array
        $traitPreferences = array_values($traitPreferences);
        
        // Normalize scores
        $maxScore = max($speciesScores);
        if ($maxScore > 0) {
            array_walk($speciesScores, function(&$score) use ($maxScore) {
                $score = round(($score / $maxScore) * 100, 2);
            });
        }
        
        return [
            'recommended_species' => array_search(max($speciesScores), $speciesScores),
            'recommended_breed' => null,
            'trait_preferences' => $traitPreferences,
            'species_scores' => $speciesScores
        ];
    }
    
    private function calculateConfidenceScore(array $answers): float {
        $answeredQuestions = 0;
        $totalQuestions = 0;
        
        foreach ($answers as $section) {
            if (is_array($section)) {
                foreach ($section as $value) {
                    $totalQuestions++;
                    if (!empty($value)) {
                        $answeredQuestions++;
                    }
                }
            }
        }
        
        return $totalQuestions > 0 ? 
            round(($answeredQuestions / $totalQuestions) * 100, 2) : 0;
    }
    
    private function findMatchingPets(array $analysis): array {
        $filters = [
            'species' => $analysis['recommended_species'],
            'breed' => $analysis['recommended_breed'] ?? null,
            'traits' => array_map(function($trait) {
                return [
                    'trait' => $trait['trait'],
                    'value' => $trait['value']
                ];
            }, $analysis['trait_preferences'])
        ];
        
        error_log("Finding matching pets with filters: " . json_encode($filters, JSON_PRETTY_PRINT));
        return $this->petModel->findAllWithTraits($filters);
    }
    
    private function getBreedRecommendation(string $species, array $traits, array $answers): ?string {
        // Implement breed recommendation logic based on species and traits
        // This would be expanded based on specific breed characteristics
        return null; // Placeholder
    }
    
    private function convertTraitPreferencesToFilters(array $preferences): array {
        $filters = [];
        foreach ($preferences as $trait => $value) {
            $filters[] = [
                'trait' => $trait,
                'value' => $value
            ];
        }
        return $filters;
    }
}
=== ./backend/tests/test_pet_matching.php ===
<?php
// backend/tests/test_pet_matching.php

require_once __DIR__ . '/../vendor/autoload.php';

use Dotenv\Dotenv;
use PawPath\models\Pet;

class TestHelper {
    private PDO $pdo;
    private Pet $petModel;
    
    public function __construct() {
        $dotenv = Dotenv::createImmutable(__DIR__ . '/..');
        $dotenv->load();
        
        $this->connectToDatabase();
        $this->petModel = new Pet();
    }
    
    private function connectToDatabase(): void {
        $dsn = sprintf(
            "mysql:host=%s;port=%s;dbname=%s;charset=utf8mb4",
            $_ENV['DB_HOST'],
            $_ENV['DB_PORT'] ?? '3306',
            $_ENV['DB_DATABASE']
        );
        
        $this->pdo = new PDO($dsn, $_ENV['DB_USERNAME'], $_ENV['DB_PASSWORD'], [
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION
        ]);
        
        echo "Database connection successful\n";
    }
    
    public function cleanupTestData(): void {
        $this->pdo->exec("DELETE FROM Pet_Trait_Relation WHERE pet_id IN (SELECT pet_id FROM Pet WHERE shelter_id IN (SELECT shelter_id FROM Shelter WHERE email = 'test@shelter.com'))");
        $this->pdo->exec("DELETE FROM Pet WHERE shelter_id IN (SELECT shelter_id FROM Shelter WHERE email = 'test@shelter.com')");
        $this->pdo->exec("DELETE FROM Shelter WHERE email = 'test@shelter.com'");
        echo "Cleaned up existing test data\n";
    }
    
    public function createTestShelter(): int {
        $stmt = $this->pdo->prepare("
            INSERT INTO Shelter (name, address, phone, email, is_no_kill)
            VALUES ('Test Shelter', '123 Test St', '555-0123', 'test@shelter.com', 1)
        ");
        $stmt->execute();
        $shelterId = (int) $this->pdo->lastInsertId();
        echo "Created test shelter with ID: $shelterId\n\n";
        return $shelterId;
    }
    
    public function getAvailableTraits(): array {
        $stmt = $this->pdo->query("
            SELECT t.trait_id, t.trait_name, tc.name as category, t.value_type
            FROM Pet_Trait t
            JOIN Trait_Category tc ON t.category_id = tc.category_id
            ORDER BY tc.name, t.trait_name
        ");
        $traits = $stmt->fetchAll(PDO::FETCH_ASSOC);
        
        echo "Available traits by category:\n";
        $currentCategory = '';
        foreach ($traits as $trait) {
            if ($currentCategory !== $trait['category']) {
                $currentCategory = $trait['category'];
                echo "\n{$trait['category']}:\n";
            }
            echo "  - {$trait['trait_name']} (ID: {$trait['trait_id']}, Type: {$trait['value_type']})\n";
        }
        echo "\n";
        
        return $traits;
    }
    
    public function createTestPets(int $shelterId, array $traits): array {
        $highEnergyTrait = array_filter($traits, fn($t) => $t['trait_name'] === 'High Energy');
        $goodWithKidsTrait = array_filter($traits, fn($t) => $t['trait_name'] === 'Good with kids');
        $highEnergyTrait = reset($highEnergyTrait);
        $goodWithKidsTrait = reset($goodWithKidsTrait);
        
        if (!$highEnergyTrait || !$goodWithKidsTrait) {
            throw new Exception("Could not find required traits");
        }
        
        $testPets = [
            [
                'name' => 'Luna',
                'species' => 'dog',
                'breed' => 'Golden Retriever',
                'age' => 2,
                'gender' => 'female',
                'description' => 'Friendly and energetic Golden Retriever',
                'shelter_id' => $shelterId,
                'traits' => [$highEnergyTrait['trait_id'], $goodWithKidsTrait['trait_id']]
            ],
            [
                'name' => 'Max',
                'species' => 'dog',
                'breed' => 'German Shepherd',
                'age' => 3,
                'gender' => 'male',
                'description' => 'Intelligent and loyal German Shepherd',
                'shelter_id' => $shelterId,
                'traits' => [$goodWithKidsTrait['trait_id']]
            ]
        ];
        
        $petIds = [];
        foreach ($testPets as $petData) {
            try {
                $petIds[] = $this->petModel->create($petData);
                echo "Created {$petData['name']} successfully\n";
            } catch (Exception $e) {
                echo "Error creating {$petData['name']}: " . $e->getMessage() . "\n";
            }
        }
        
        return $petIds;
    }
        
    public function testTraitMatching(array $traits): void {
        echo "\nTesting trait matching functionality:\n";
        echo "\n";
        
        $filters = [
            'species' => 'dog',
            'traits' => [
                ['trait' => 'High Energy'],
                ['trait' => 'Good with kids']
            ]
        ];
        
        echo "Searching for dogs with traits: High Energy, Good with kids\n\n";
        
        $matchingPets = $this->petModel->findAllWithTraits($filters);
        echo "Found " . count($matchingPets) . " matching pets:\n\n";
        
        foreach ($matchingPets as $pet) {
            echo "\n";
            echo " {$pet['name']} ({$pet['breed']})\n";
            echo " Matching traits: {$pet['matching_trait_count']}\n";
            echo " Traits by category:\n";
            
            if (!empty($pet['traits'])) {
                foreach ($pet['traits'] as $category => $traits) {
                    echo "    {$category}: " . implode(', ', $traits) . "\n";
                }
            } else {
                echo "   No traits assigned\n";
            }
            
            echo "\n\n";
        }
    }

    public function cleanup(array $petIds, int $shelterId): void {
        echo "\nCleaning up test data...\n";
        foreach ($petIds as $petId) {
            $this->petModel->delete($petId);
            echo "Deleted pet ID: $petId\n";
        }
        
        $stmt = $this->pdo->prepare("DELETE FROM Shelter WHERE shelter_id = ?");
        $stmt->execute([$shelterId]);
        echo "Deleted test shelter\n";
    }
}

// Run the tests
try {
    $tester = new TestHelper();
    
    // Setup
    $tester->cleanupTestData();
    $shelterId = $tester->createTestShelter();
    $traits = $tester->getAvailableTraits();
    
    // Create test pets
    $petIds = $tester->createTestPets($shelterId, $traits);
    
    // Test trait matching
    $tester->testTraitMatching($traits);
    
    // Cleanup
    $tester->cleanup($petIds, $shelterId);
    
} catch (Exception $e) {
    echo "Error: " . $e->getMessage() . "\n";
    exit(1);
}
=== ./backend/tests/setup_traits.php ===
<?php
// backend/tests/setup_traits.php

require_once __DIR__ . '/../vendor/autoload.php';

use Dotenv\Dotenv;

// Update the path to look in the backend directory
$dotenv = Dotenv::createImmutable(__DIR__ . '/..');
$dotenv->load();

// Add debug output
echo "Environment variables loaded:\n";
echo "DB_HOST: " . $_ENV['DB_HOST'] . "\n";
echo "DB_DATABASE: " . $_ENV['DB_DATABASE'] . "\n";
echo "DB_USERNAME: " . $_ENV['DB_USERNAME'] . "\n";
echo "DB_PASSWORD is set: " . (isset($_ENV['DB_PASSWORD']) ? "Yes" : "No") . "\n";

try {
    $dsn = "mysql:host=" . $_ENV['DB_HOST'] . ";port=" . ($_ENV['DB_PORT'] ?? "3306") . ";dbname=" . $_ENV['DB_DATABASE'] . ";charset=utf8mb4";
    echo "Attempting to connect with DSN: $dsn\n";
    
    $pdo = new PDO($dsn, $_ENV['DB_USERNAME'], $_ENV['DB_PASSWORD'], [
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION
    ]);
    
    echo "Database connection successful!\n\n";

    // First, create categories if they don't exist
    $categories = [
        ['name' => 'energy_level', 'description' => 'Activity and exercise needs'],
        ['name' => 'social', 'description' => 'Social characteristics'],
        ['name' => 'training', 'description' => 'Training characteristics']
    ];

    foreach ($categories as $category) {
        $stmt = $pdo->prepare("
            INSERT IGNORE INTO Trait_Category (name, description)
            VALUES (?, ?)
        ");
        $stmt->execute([$category['name'], $category['description']]);
        echo "Processed category: {$category['name']}\n";
    }

    // Then create basic traits if they don't exist
    $traits = [
        ['name' => 'High Energy', 'category' => 'energy_level', 'type' => 'binary'],
        ['name' => 'Good with Kids', 'category' => 'social', 'type' => 'scale'],
        ['name' => 'Easily Trained', 'category' => 'training', 'type' => 'binary']
    ];

    foreach ($traits as $trait) {
        // Get category ID
        $stmt = $pdo->prepare("SELECT category_id FROM Trait_Category WHERE name = ?");
        $stmt->execute([$trait['category']]);
        $categoryId = $stmt->fetchColumn();
        
        if ($categoryId) {
            $stmt = $pdo->prepare("
                INSERT IGNORE INTO Pet_Trait (trait_name, category_id, value_type)
                VALUES (?, ?, ?)
            ");
            $stmt->execute([$trait['name'], $categoryId, $trait['type']]);
            echo "Processed trait: {$trait['name']}\n";
        } else {
            echo "Warning: Category {$trait['category']} not found for trait {$trait['name']}\n";
        }
    }

    echo "\nTrait setup complete!\n";
    
} catch (Exception $e) {
    echo "Error: " . $e->getMessage() . "\n";
    exit(1);
}
=== ./backend/tests/test_email.php ===
<?php
require_once __DIR__ . '/../vendor/autoload.php';

use Dotenv\Dotenv;
use PawPath\services\EmailService;

// Load environment variables
$dotenv = Dotenv::createImmutable(__DIR__ . '/..');
$dotenv->load();

class EmailTester {
    private EmailService $emailService;
    
    public function __construct() {
        $this->emailService = new EmailService();
    }
    
    public function testVerificationEmail(): void {
        echo "Testing Verification Email...\n";
        
        $result = $this->emailService->sendVerificationEmail(
            'test@example.com',
            'Test User',
            'test-token-123'
        );
        
        $this->printResult('Verification Email', $result);
    }
    
    public function testPasswordResetEmail(): void {
        echo "\nTesting Password Reset Email...\n";
        
        $result = $this->emailService->sendPasswordResetEmail(
            'test@example.com',
            'Test User',
            'reset-token-123'
        );
        
        $this->printResult('Password Reset Email', $result);
    }
    
    public function testWelcomeEmail(): void {
        echo "\nTesting Welcome Email...\n";
        
        $result = $this->emailService->sendWelcomeEmail(
            'test@example.com',
            'Test User'
        );
        
        $this->printResult('Welcome Email', $result);
    }
    
    private function printResult(string $test, bool $result): void {
        if ($result) {
            echo "\033[32m {$test} sent successfully\033[0m\n";
        } else {
            echo "\033[31m {$test} failed to send\033[0m\n";
        }
    }
}

// Run tests
try {
    $tester = new EmailTester();
    $tester->testVerificationEmail();
    $tester->testPasswordResetEmail();
    $tester->testWelcomeEmail();
} catch (Exception $e) {
    echo "\033[31mError: " . $e->getMessage() . "\033[0m\n";
}
=== ./backend/tests/test_pets.php ===
<?php
// backend/tests/test_pets.php

require __DIR__ . '/../vendor/autoload.php';

// Load environment variables
$dotenv = Dotenv\Dotenv::createImmutable(__DIR__ . '/..');
$dotenv->load();

use PawPath\models\Pet;
use PawPath\models\PetTrait;

// Create instances
$petModel = new Pet();
$traitModel = new PetTrait();

// Get existing traits or create new ones
try {
    $traits = $traitModel->findAll();
    if (empty($traits)) {
        echo "Testing Pet Trait Model...\n";
        
        // Create some traits
        $friendlyId = $traitModel->create("Friendly");
        echo "Created trait 'Friendly' with ID: $friendlyId\n";
        
        $gentleId = $traitModel->create("Gentle");
        echo "Created trait 'Gentle' with ID: $gentleId\n";
        
        // List all traits
        $traits = $traitModel->findAll();
        echo "All traits:\n";
        print_r($traits);
    } else {
        $friendlyId = $traits[0]['trait_id'];
        $gentleId = $traits[1]['trait_id'];
    }
    
    echo "\nTesting Pet Model...\n";
    
    // Create a pet - Use the shelter_id from your actual shelter
    $shelter_id = 3; // Replace with your actual shelter ID from the GET shelters request
    
    try {
        $shelterModel = new \PawPath\models\Shelter();
        $shelter = $shelterModel->findById($shelter_id);
        if (!$shelter) {
            throw new \RuntimeException("Shelter with ID $shelter_id not found");
        }
    } catch (Exception $e) {
        echo "Error checking shelter: " . $e->getMessage() . "\n";
        exit(1);
    }

    echo "Using shelter: " . $shelter['name'] . "\n";

    $petData = [
        'name' => 'Max',
        'species' => 'dog',
        'breed' => 'Golden Retriever',
        'age' => 3,
        'gender' => 'Male',
        'description' => 'A very good boy',
        'shelter_id' => $shelter_id,
        'traits' => [$friendlyId, $gentleId]
    ];
    
    echo "Creating pet with shelter_id: $shelter_id\n";
    $petId = $petModel->create($petData);
    echo "Created pet with ID: $petId\n";
    
    // Retrieve the pet
    $pet = $petModel->findById($petId);
    echo "Retrieved pet:\n";
    print_r($pet);
    
    // Update the pet
    $updateData = [
        'age' => 4,
        'description' => 'A very good and friendly boy'
    ];
    $petModel->update($petId, $updateData);
    
    // Retrieve updated pet
    $updatedPet = $petModel->findById($petId);
    echo "\nUpdated pet:\n";
    print_r($updatedPet);
    
    // Test search functionality
    $searchResults = $petModel->findAll(['species' => 'dog']);
    echo "\nSearch results for dogs:\n";
    print_r($searchResults);
    
} catch (Exception $e) {
    echo "Error: " . $e->getMessage() . "\n";
    echo "Stack trace:\n" . $e->getTraceAsString() . "\n";
}
=== ./backend/tests/test_quiz_controller.php ===
<?php
require_once __DIR__ . '/../vendor/autoload.php';

use Dotenv\Dotenv;
use PawPath\models\Pet;
use PawPath\api\QuizController;
use PawPath\models\StartingQuiz;
use PawPath\models\QuizResult;

class TestQuizHelper {
    private PDO $pdo;
    private $userId = 1; // We'll use this as our test user ID
    
    public function __construct() {
        $dotenv = Dotenv::createImmutable(__DIR__ . '/..');
        $dotenv->load();
        
        $this->connectToDatabase();
    }
    
    private function connectToDatabase(): void {
        $dsn = sprintf(
            "mysql:host=%s;port=%s;dbname=%s;charset=utf8mb4",
            $_ENV['DB_HOST'],
            $_ENV['DB_PORT'] ?? '3306',
            $_ENV['DB_DATABASE']
        );
        
        $this->pdo = new PDO($dsn, $_ENV['DB_USERNAME'], $_ENV['DB_PASSWORD'], [
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION
        ]);
        
        echo "Database connection successful\n";
    }
    
    public function cleanupTestData(): void {
        // Delete test pets and relations first
        $this->pdo->exec("
            DELETE ptr FROM Pet_Trait_Relation ptr
            INNER JOIN Pet p ON ptr.pet_id = p.pet_id
            INNER JOIN Shelter s ON p.shelter_id = s.shelter_id
            WHERE s.email = 'test@shelter.com'
        ");
        
        $this->pdo->exec("
            DELETE p FROM Pet p
            INNER JOIN Shelter s ON p.shelter_id = s.shelter_id
            WHERE s.email = 'test@shelter.com'
        ");
        
        // Delete test shelter
        $this->pdo->exec("DELETE FROM Shelter WHERE email = 'test@shelter.com'");
        
        // Clean up quiz data
        $this->pdo->exec("
            DELETE qr FROM Quiz_Result qr
            INNER JOIN Starting_Quiz sq ON qr.quiz_id = sq.quiz_id
            WHERE sq.user_id = 1
        ");
        $this->pdo->exec("DELETE FROM Starting_Quiz WHERE user_id = 1");
        
        echo "Cleaned up existing test data\n";
    }
    
    public function setupTestData(): array {
        // Create test shelter
        $stmt = $this->pdo->prepare("
            INSERT INTO Shelter (name, address, phone, email, is_no_kill)
            VALUES ('Test Shelter', '123 Test St', '555-0123', 'test@shelter.com', 1)
        ");
        $stmt->execute();
        $shelterId = $this->pdo->lastInsertId();
        
        echo "Created test shelter with ID: $shelterId\n";
        
        // Create test pets with traits
        $pets = [
            [
                'name' => 'Luna',
                'species' => 'dog',
                'breed' => 'Golden Retriever',
                'age' => 2,
                'gender' => 'female',
                'description' => 'Energetic and friendly Golden',
                'traits' => ['High Energy', 'Good with kids', 'Easily Trained']
            ],
            [
                'name' => 'Max',
                'species' => 'dog',
                'breed' => 'German Shepherd',
                'age' => 3,
                'gender' => 'male',
                'description' => 'Intelligent and active shepherd',
                'traits' => ['High Energy', 'Easily Trained']
            ]
        ];
        
        foreach ($pets as $petData) {
            // Insert pet
            $stmt = $this->pdo->prepare("
                INSERT INTO Pet (name, species, breed, age, gender, description, shelter_id)
                VALUES (?, ?, ?, ?, ?, ?, ?)
            ");
            
            $stmt->execute([
                $petData['name'],
                $petData['species'],
                $petData['breed'],
                $petData['age'],
                $petData['gender'],
                $petData['description'],
                $shelterId
            ]);
            
            $petId = $this->pdo->lastInsertId();
            echo "Created test pet {$petData['name']} with ID: $petId\n";
            
            // Add traits
            foreach ($petData['traits'] as $traitName) {
                // Get trait ID
                $stmt = $this->pdo->prepare("
                    SELECT trait_id FROM Pet_Trait WHERE trait_name = ?
                ");
                $stmt->execute([$traitName]);
                $traitId = $stmt->fetchColumn();
                
                if ($traitId) {
                    // Add trait relation
                    $stmt = $this->pdo->prepare("
                        INSERT INTO Pet_Trait_Relation (pet_id, trait_id)
                        VALUES (?, ?)
                    ");
                    $stmt->execute([$petId, $traitId]);
                    echo "Added trait '$traitName' to pet {$petData['name']}\n";
                } else {
                    echo "Warning: Trait '$traitName' not found in database\n";
                }
            }
        }
        
        return ['shelter_id' => $shelterId];
    }

    private function createTestRequest(array $data = [], array $attributes = []): \Slim\Psr7\Request {
        $request = new \Slim\Psr7\Request(
            'POST',
            new \Slim\Psr7\Uri('http', 'localhost', 80, '/api/quiz/submit'),
            new \Slim\Psr7\Headers(['Content-Type' => 'application/json']),
            [],
            [],
            new \Slim\Psr7\Stream(fopen('php://temp', 'r+')),
            []
        );
        
        // Add body data
        if (!empty($data)) {
            $body = json_encode($data);
            if ($body === false) {
                throw new \RuntimeException("Failed to encode request data: " . json_last_error_msg());
            }
            
            $stream = fopen('php://temp', 'r+');
            if ($stream === false) {
                throw new \RuntimeException("Failed to open stream");
            }
            
            fwrite($stream, $body);
            rewind($stream);
            
            $request = $request->withBody(new \Slim\Psr7\Stream($stream));
        }
        
        // Add attributes (like user_id)
        foreach ($attributes as $key => $value) {
            $request = $request->withAttribute($key, $value);
        }
        
        return $request;
    }
    
    private function createTestResponse(): \Slim\Psr7\Response {
        return new \Slim\Psr7\Response();
    }
    
    public function runTests(): void {
        echo "\nRunning Quiz Controller Tests\n";
        echo "\n\n";
        
        $this->testStartQuiz();
        $this->testSubmitQuiz();
        $this->testQuizHistory();
        $this->testSpecificQuizResult();
    }
    
    private function testStartQuiz(): void {
        echo "Test 1: Starting a New Quiz\n";
        echo "\n";
        
        try {
            $controller = new QuizController();
            $response = $controller->startQuiz(
                $this->createTestRequest(),
                $this->createTestResponse()
            );
            
            $result = json_decode((string)$response->getBody(), true);
            
            if ($result['success']) {
                echo " Successfully retrieved quiz questions\n";
                echo " Found " . $result['data']['total_sections'] . " question sections\n";
                foreach ($result['data']['questions']['sections'] as $section) {
                    echo "   {$section['title']}: " . count($section['questions']) . " questions\n";
                }
            } else {
                echo " Failed to start quiz\n";
            }
        } catch (Exception $e) {
            echo " Error: " . $e->getMessage() . "\n";
        }
        echo "\n";
    }
    
    private function testSubmitQuiz(): void {
        echo "Test 2: Submitting Quiz Answers\n";
        echo "\n";
        
        try {
            $controller = new QuizController();
            
            $answers = [
                'answers' => [
                    'living_situation' => [
                        'living_space' => 'house_large',
                        'outdoor_access' => ['private_yard'],
                        'rental_restrictions' => ['no_restrictions']
                    ],
                    'lifestyle' => [
                        'activity_level' => 'very_active',
                        'time_available' => 'extensive',
                        'work_schedule' => 'regular_hours'
                    ],
                    'household' => [
                        'children' => ['no_children'],
                        'other_pets' => ['no_pets']
                    ],
                    'experience' => [
                        'pet_experience' => 'experienced',
                        'training_willingness' => 'definitely'
                    ],
                    'practical_considerations' => [
                        'budget' => 'flexible',
                        'grooming' => 'high',
                        'allergies' => ['no_allergies']
                    ],
                    'preferences' => [
                        'size_preference' => ['medium'],
                        'noise_tolerance' => 'moderate',
                        'exercise_commitment' => 'active'
                    ]
                ]
            ];
            
            echo "Submitting answers: " . json_encode($answers, JSON_PRETTY_PRINT) . "\n";
            
            $response = $controller->submitQuiz(
                $this->createTestRequest($answers, ['user_id' => $this->userId]),
                $this->createTestResponse()
            );
            
            $result = json_decode((string)$response->getBody(), true);
            
            if ($result['success']) {
                echo " Successfully submitted quiz answers\n";
                echo " Received recommendations:\n";
                echo "   Recommended species: " . $result['data']['recommendations']['species'] . "\n";
                if (!empty($result['data']['recommendations']['breed'])) {
                    echo "   Recommended breed: " . $result['data']['recommendations']['breed'] . "\n";
                }
                echo "   Confidence score: " . $result['data']['confidence_score'] . "%\n";
                echo "   Found " . count($result['data']['matching_pets']) . " matching pets\n";
                
                if (!empty($result['data']['matching_pets'])) {
                    echo "\nMatching pets:\n";
                    foreach ($result['data']['matching_pets'] as $pet) {
                        echo "   {$pet['name']} ({$pet['breed']})\n";
                        if (!empty($pet['traits'])) {
                            echo "    Traits:\n";
                            foreach ($pet['traits'] as $category => $traits) {
                                echo "      - $category: " . implode(', ', $traits) . "\n";
                            }
                        }
                    }
                }
                
                $this->lastQuizId = $result['data']['quiz_id'];
            } else {
                echo " Failed to submit quiz\n";
                echo "Error: " . ($result['message'] ?? 'Unknown error') . "\n";
            }
        } catch (Exception $e) {
            echo " Error: " . $e->getMessage() . "\n";
            echo "Stack trace:\n" . $e->getTraceAsString() . "\n";
        }
        echo "\n";
    }
    
    private function testQuizHistory(): void {
        echo "Test 3: Retrieving Quiz History\n";
        echo "\n";
        
        try {
            $controller = new QuizController();
            $response = $controller->getQuizHistory(
                $this->createTestRequest([], ['user_id' => $this->userId]),
                $this->createTestResponse()
            );
            
            $result = json_decode((string)$response->getBody(), true);
            
            if ($result['success']) {
                echo " Successfully retrieved quiz history\n";
                echo " Found " . $result['data']['total_quizzes'] . " previous quizzes\n";
                foreach ($result['data']['history'] as $quiz) {
                    echo "   Quiz {$quiz['quiz_id']} taken on {$quiz['date_taken']}\n";
                    echo "    Recommended: {$quiz['recommendations']['species']}\n";
                }
            } else {
                echo " Failed to retrieve quiz history\n";
            }
        } catch (Exception $e) {
            echo " Error: " . $e->getMessage() . "\n";
        }
        echo "\n";
    }
    
    private function testSpecificQuizResult(): void {
        echo "Test 4: Retrieving Specific Quiz Result\n";
        echo "\n";
        
        if (!isset($this->lastQuizId)) {
            echo " No quiz ID available for testing\n\n";
            return;
        }
        
        try {
            $controller = new QuizController();
            $response = $controller->getQuizResult(
                $this->createTestRequest([], ['user_id' => $this->userId]),
                $this->createTestResponse(),
                ['id' => $this->lastQuizId]
            );
            
            $result = json_decode((string)$response->getBody(), true);
            
            if ($result['success']) {
                echo " Successfully retrieved quiz result\n";
                echo " Quiz details:\n";
                echo "   Date taken: " . $result['data']['date_taken'] . "\n";
                echo "   Recommended species: " . $result['data']['recommendations']['species'] . "\n";
                if (!empty($result['data']['recommendations']['breed'])) {
                    echo "   Recommended breed: " . $result['data']['recommendations']['breed'] . "\n";
                }
                echo "   Trait preferences: " . count($result['data']['recommendations']['traits']) . " traits\n";
            } else {
                echo " Failed to retrieve quiz result\n";
            }
        } catch (Exception $e) {
            echo " Error: " . $e->getMessage() . "\n";
        }
        echo "\n";
    }
}

// Run the tests
try {
    $tester = new TestQuizHelper();
    
    // Clean up any existing test data
    $tester->cleanupTestData();
    
    // Setup test data
    $testData = $tester->setupTestData();
    
    // Run all tests
    $tester->runTests();
    
} catch (Exception $e) {
    echo "Error: " . $e->getMessage() . "\n";
    exit(1);
}
=== ./backend/tests/test_user_system.sh ===
#!/bin/bash

# Store the base URL
BASE_URL="http://localhost:8000/api"
TOKEN=""

# Colors for output
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

# Test registration with new fields
echo "Testing registration..."
REGISTER_RESPONSE=$(curl -s -X POST "${BASE_URL}/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser_'$(date +%s)'",
    "email": "test_'$(date +%s)'@example.com",
    "password": "Password123!"
  }')

echo $REGISTER_RESPONSE | jq .

# Extract token from registration response
TOKEN=$(echo $REGISTER_RESPONSE | jq -r '.data.token')

# Test profile creation
echo -e "\nTesting profile creation..."
PROFILE_RESPONSE=$(curl -s -X PUT "${BASE_URL}/profile" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${TOKEN}" \
  -d '{
    "first_name": "Test",
    "last_name": "User",
    "phone": "1234567890",
    "housing_type": "house",
    "has_yard": true,
    "household_members": 2
  }')

echo $PROFILE_RESPONSE | jq .

# Test profile retrieval
echo -e "\nTesting profile retrieval..."
curl -s -X GET "${BASE_URL}/profile" \
  -H "Authorization: Bearer ${TOKEN}" | jq .

# Test email verification resend
echo -e "\nTesting verification email resend..."
curl -s -X POST "${BASE_URL}/auth/resend-verification" \
  -H "Authorization: Bearer ${TOKEN}" | jq .
=== ./backend/tests/test_pet_service.php ===
<?php
// backend/tests/test_pet_service.php

require __DIR__ . '/../vendor/autoload.php';

// Load environment variables
$dotenv = Dotenv\Dotenv::createImmutable(__DIR__ . '/..');
$dotenv->load();

use PawPath\services\PetService;

$petService = new PetService();

function printSection($title) {
    echo "\n" . str_repeat("=", 50) . "\n";
    echo $title . "\n";
    echo str_repeat("=", 50) . "\n";
}

try {
    // Test trait management
    printSection("Testing Trait Management");
    
    echo "Adding new traits...\n";
    $playful = $petService->addTrait("Playful");
    echo "Added trait: ";
    print_r($playful);
    
    $quiet = $petService->addTrait("Quiet");
    echo "Added trait: ";
    print_r($quiet);
    
    echo "\nListing all traits:\n";
    $allTraits = $petService->listTraits();
    print_r($allTraits);
    
    // Test pet creation
    printSection("Testing Pet Creation");
    
    // Test validation - should fail
    echo "\nTesting validation with missing required fields...\n";
    try {
        $petService->createPet([
            'name' => 'Buddy'
            // Missing required fields
        ]);
    } catch (RuntimeException $e) {
        echo "Caught expected error: " . $e->getMessage() . "\n";
    }
    
    // Create valid pet
    echo "\nCreating valid pet...\n";
    $petData = [
        'name' => 'Buddy',
        'species' => 'Dog',
        'breed' => 'Labrador',
        'age' => 2,
        'gender' => 'Male',
        'description' => 'A friendly lab who loves to play',
        'shelter_id' => 3, // Use your actual shelter ID
        'traits' => [$playful['trait_id'], $quiet['trait_id']]
    ];
    
    $newPet = $petService->createPet($petData);
    echo "Created new pet:\n";
    print_r($newPet);
    
    // Test pet retrieval
    printSection("Testing Pet Retrieval");
    
    $retrievedPet = $petService->getPet($newPet['pet_id']);
    echo "Retrieved pet:\n";
    print_r($retrievedPet);
    
    // Test pet update
    printSection("Testing Pet Update");
    
    $updateData = [
        'age' => 3,
        'description' => 'A friendly lab who loves to play and is great with kids'
    ];
    
    $updatedPet = $petService->updatePet($newPet['pet_id'], $updateData);
    echo "Updated pet:\n";
    print_r($updatedPet);
    
    // Test invalid update
    echo "\nTesting invalid update (invalid age)...\n";
    try {
        $petService->updatePet($newPet['pet_id'], ['age' => -1]);
    } catch (RuntimeException $e) {
        echo "Caught expected error: " . $e->getMessage() . "\n";
    }
    
    // Test pet listing with filters
    printSection("Testing Pet Listing with Filters");
    
    echo "\nListing all dogs:\n";
    $dogs = $petService->listPets(['species' => 'Dog']);
    print_r($dogs);
    
    echo "\nTesting invalid species filter...\n";
    try {
        $petService->listPets(['species' => 'Dragon']);
    } catch (RuntimeException $e) {
        echo "Caught expected error: " . $e->getMessage() . "\n";
    }
    
    // Test deletion (optional)
    /*
    printSection("Testing Pet Deletion");
    
    $deleted = $petService->deletePet($newPet['pet_id']);
    echo "Pet deleted: " . ($deleted ? "true" : "false") . "\n";
    
    // Verify deletion
    try {
        $petService->getPet($newPet['pet_id']);
    } catch (RuntimeException $e) {
        echo "Caught expected error: " . $e->getMessage() . "\n";
    }
    */
    
} catch (Exception $e) {
    echo "\nUnexpected error occurred: " . $e->getMessage() . "\n";
    echo "Stack trace:\n" . $e->getTraceAsString() . "\n";
}
=== ./backend/public/uploads/images/golden_retriever.png ===
 Exif  MM *                  b       j(                     ri             ,     ,   Rawpixel Ltd.       0210     0100                       `http://ns.adobe.com/xap/1.0/ <?xpacket begin='' id='W5M0MpCehiHzreSzNTczkc9d'?>
<x:xmpmeta xmlns:x='adobe:ns:meta/' x:xmptk='Image::ExifTool 12.63'>
<rdf:RDF xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns#'>

 <rdf:Description rdf:about=''
  xmlns:dc='http://purl.org/dc/elements/1.1/'>
  <dc:creator>
   <rdf:Seq>
    <rdf:li>rawpixel.com / George</rdf:li>
   </rdf:Seq>
  </dc:creator>
  <dc:description>
   <rdf:Alt>
    <rdf:li xml:lang='x-default'>Golden Retriever png clipart, dog, transparent background</rdf:li>
   </rdf:Alt>
  </dc:description>
  <dc:rights>
   <rdf:Alt>
    <rdf:li xml:lang='x-default'>Rawpixel Ltd.</rdf:li>
   </rdf:Alt>
  </dc:rights>
  <dc:subject>
   <rdf:Bag>
    <rdf:li>dog</rdf:li>
    <rdf:li>dog png</rdf:li>
    <rdf:li>golden retriever</rdf:li>
    <rdf:li>pet</rdf:li>
    <rdf:li>dog sitting</rdf:li>
    <rdf:li>png</rdf:li>
    <rdf:li>dog breed</rdf:li>
    <rdf:li>golden retriever png</rdf:li>
    <rdf:li>animal</rdf:li>
    <rdf:li>puppy</rdf:li>
    <rdf:li>cute dogs</rdf:li>
    <rdf:li>real animals</rdf:li>
   </rdf:Bag>
  </dc:subject>
  <dc:title>
   <rdf:Alt>
    <rdf:li xml:lang='x-default'>Golden Retriever png clipart, dog, transparent background</rdf:li>
   </rdf:Alt>
  </dc:title>
 </rdf:Description>

 <rdf:Description rdf:about=''
  xmlns:pdf='http://ns.adobe.com/pdf/1.3/'>
  <pdf:Author>rawpixel.com / George</pdf:Author>
 </rdf:Description>

 <rdf:Description rdf:about=''
  xmlns:plus='http://ns.useplus.org/ldf/xmp/1.0/'>
  <plus:Licensor>
   <rdf:Seq>
    <rdf:li rdf:parseType='Resource'>
     <plus:LicensorURL>https://www.rawpixel.com/image/6204307</plus:LicensorURL>
    </rdf:li>
   </rdf:Seq>
  </plus:Licensor>
 </rdf:Description>

 <rdf:Description rdf:about=''
  xmlns:xmp='http://ns.adobe.com/xap/1.0/'>
  <xmp:CreatorTool>rawpixel.com</xmp:CreatorTool>
  <xmp:Rating>7</xmp:Rating>
 </rdf:Description>

 <rdf:Description rdf:about=''
  xmlns:xmpRights='http://ns.adobe.com/xap/1.0/rights/'>
  <xmpRights:WebStatement>https://www.rawpixel.com/services/licenses</xmpRights:WebStatement>
 </rdf:Description>
</rdf:RDF>
</x:xmpmeta>
<?xpacket end='r'?>ICC_PROFILE   lcms   mntrRGB XYZ    	  acspMSFT    sawsctrl                   -handyVZ>#UFO                               
desc      $cprt      "wtpt  D   chad  X   ,rXYZ     gXYZ     bXYZ     rTRC      gTRC      bTRC      mluc          enUS       s R G Bmluc          enUS       C C 0  XYZ            -sf32     ?  &        qXYZ       o  8  XYZ       b    XYZ       $    para        fi    Y    
[ C 	!"$"$ C  "             	 D 
  !1A"34Qaq2RSr#BCc$b%             .     !1A"Q2a#q3RB   ? ` "aIzaHQD*9>IbOtQEFwB,+#>uD E@DG	/F@h |~/K7QDzzg;#P[W~?d *(srE	(Oo(TV}%Igz(]K4J[>QD;; In?)(+s|G /p@ "H li -	HT$O]R?DuQ=yK=y@ 0iD+@EQ Gt?h]7Ri E@DISz(j OGm_(:*E*(%Oo)]?rE@mGYT}%(u-E@DN?(dN?(L8~n@/L6_4 N!WY j> v58|Ts|'[""$i#^a#r?A>cHxXWG}P}kjO oQ0nSG 7+!GU:@N> v4Oo)r5q<aq q)#)^MkKpl^qAm_x|j`  *&B?mq g'c9a%|mS]*9 {U~}%!m835gb1Do}h ]6p%fH L8~n@aOJd|Mo\tXjm/ORo4z&+I	/S`%Q>V(z?eG?'~2@N1fxyw*WVIW'uX^7I#C6.(:hY!2v9\G T_2Jm{p$vm]] f>Sn|Vt;>$wt2 G>R
 U o :[cq,;BaI*
?$g Qa;/A=N`j}jJbO|}j
JDEIZ 5!8~=yTnU|-n 3@N> v4TI5~!!8~hN!erW}hOo+.> v5$x*@a#rztPw!x~kKpl@N> v4~s-[||[} #^:#~Lg,=4j 8|m@m>}q21X8W96j !8~w3Lpfk,S z> v58|W}n/x~;; ~K(QD@mNqE@^T'8@EQ hOpC "[txQDJjLSWd@d 
LRQDi9wUi9wTGlx}(O QJI a"4-(=4YV_IlBmsm
q]6I4doC'%U,>Gf//4BcASs9Wup\;-k=g(|S)kib	3~0\2N\+/2;E@gH[,>k>O (H6T]oA5cuBbh6:3d3~>><k8I!\	\18b|GYen\!`F\%6qyQHmZphKUa%~V.M%93eM#w\b`NJ'$#A!e4w_rIj.b nD.WnP=,,Y3GpK	7)~gSHG$etarZrk^boFWhilA#F`dL$\70G2K)em	vkaU"~lf<q")!!\o ne%yFr
bSQIYKoD.dE"[zI	[zIeQKg4J:[<~(5}&N@DV9|?pb "M'8s(
W<>9wNm E@Dfs.Lvg0(4JmWJPE@4?U!F==4>)CYNg:esLC2i fONot S
F:7	$d.z$O'@8NzuVO6\,8 )L6FOJcE\,I?8h}?0I@8.G1sIpV	/F@+fONot SAbA`k a_b p~`g	:_"7OUx )M?7(lY_Tjj O+8h}?0I@7|$a$d1?\> 3{R7) J6(Ke!qKI*)?U2#zJd1S7#KlO3mo%wagwqV'`h<V}'1W'k7b'#	h1^f<Vu#C	ahOWq`c!kxLCSvu;)' \Ef"xEH>9%ikItDX;I? 5s|n8L9ZYy+k"lv [1$88;Tg%qrOk=kJ,?^lVu7Q \T 
Ha6w`iap6w%.; mDFsg\8 uoVV,+xp-k
q7}?\vl,vD[0;dG{<C*NXu5gPi.8MzF^v Yk$x &hAc5 ikm tH!W<IrTXvEFK"6h6#N-+ X	%`h&8V59X7NG
.sa8ys:~d _rNo|quE\|!u3U%.%a-LvQw<$nOz{6UAr]~k'xeU#mDh"hUt	KDrdt8JsG,meT Jp[HP1.$g: VqCY4>$ 7G1sIpV| ?hOJ".6	ig
p~`qCYX/q}Not TfO8Q c,+.qCYZ@h|A7*p3{R(OJ6-W(i~ wg
p~`iQ## K )W,MP	 )S?D dtdk/pb3Z~`W}4>,k --D E@DeOeO
Ts|'	$ ;!0(XWG}V
 Z(/FJz^E@_b&;Oo)r(LrxPw/PF~ TQDY%+> :5qIveL.7&9\0Iz9bKb/+>28NdY^V}OGSPZ&8.zqpL.-RsjVW:.q7k02OsIH=]Q9#T5FM9$FV7^Z#YE?Zd2].DkrGSN7&Ns3HgcnC hW-l8$sTYJ7E'iTvmw$5LHc?*WTBAHw<"-9[5{6m#;TW6ku<uz`\e=] X0$jGwG\}| Tc$3Dm;S9"I:
S8@X^n0oU2g6fEZ"az0 	u<VZ,H5qMlm84_F=Up[nt47Z.kN\kqIihb!u|~k:vx:]pknwsp5n7o5\%~$;%c1`98	XkW,%c` 	ei}4xp_UJn5.H6Gan[a$u|ccKOZMlaE'){j`HvbmET$p-]y(YP u'[i!s	6H%q"XO$j)Y/9G][W;BWI\SI]<eV~4D+M+J9QDz^Yh!v0QH]7Qz%N( -?@"\> : m>})v UQIgzjQw }z ;; ;; 
p{'N'|
 p{'ePHCa;3|3N;?[| UK#	qD8=C p{'N'|
  WS?_<8mShxmVgH!l p{'N'|
 p{'-Dbe!p%5}&Nv~)goD=O1b1ekn'|3w	 ~'|p{'skAm;?[|s*xmZ k 
;eS5D/
 W@\fO4[1ON cl=A1_ZC
/y/Cv!Y%vKq*:;wYegaQTz8}F~$aJe<ukYm#:FY7"~^K&Sm.0  Ku=<en<ls|3!&8hndY#o{72|Zc$X[;YifL\m< ^gn7Q\<c!>A5$ K6#"uJ**^8{S(tpy-GK#&*KIC#<ms:xIjc|&RCrc}%4<<-oTQ_4n|C
Oy=91z>#3{zJv9/7{d!/1#^qq{gL:b++KTZXY!h.fXv^lQ5a# .	48-kCsMt,de@ O|-^dfovC wA<j<2\Y]L,Xwu}6 2a|"Zm/9$>;6CA9`EO?.i.kFV`o{Xckn+;c2	 H6VPXS"%31$`eH^@$bu)~-{]Zj>w?gpsbF^h_+dn,oW C-sx PugG+f;+6;"kt[ :bl/H!BCr>ko;P+p1#MH'},)0}fD2DwUR8prFEwTQn9UfI%Ufwn E.xviLU`HZU|oq^KRZ:?I5-ulU/=0Qiy.UGKNpVp{'#u3a !~&\OZ!anBW%_Id*	iT-YfEl} 	p{'N'|
 p{'[`mbI;7N;?[|   ^'|[+tj ~'|4hwJqQ OKh&p8r$c9|_`>jq8=Q ,Gq$m_F)@gov~!@1#H.kcO3@O3,B<h}x@S@n;n|aT J-G8Gt	ltG#d{,I_"E""hQ'	q0^GzRIVcu77O>EN7O>ESWdGy(YY]$m]7T[Jw
qJw}&(
V:C$H:tPtTtPdUQ.T{@`8G7Pw tPK7Ix3.D7AMkj&y}D R4-6},-s;M:er$|x-	}{wfDZgL0e U+58EMfh?)&scnXa'kDdp2rfFbtmu^BT=khdY{mW_`l X~SoT]-9eljKH7[;'2cFoA,".FiKPLkVhvfd~"lj1j]4"v
I&0CZ0NVixG;Cin&sWf3 P{moB89-%Iw]v|uONK_is=-=,rB.t~;]}h,[.)KQ r|}#Njd6?>_/3oKD6\[NJvw5;\=-{t5SML(p,Iv^K56 }}D6p3t;XpaQ7 >;*e{K$2p\2{>CJw6KF`. WlEc`nt s'}{/#80|x^KLsm~:_m=U4\6'FNf4_(N-iW4 f1/z'MA8lz7G`SgmQ4c8,Feu\7E[Fa#27w,'s@;Yd@9#*Kyp/_xze$%.7'5p`e:7c ,.4@9^^o~? TodR= NkIj{#}oqjXK9M"imlVBm]$L`;F-k`DW440\|_=5sE>2a{d	7Ey`Hn;8rO.UmHcisov]Bk [~^{nJMWO`io+KvU]vGI\?jA^j/diHPMepKyz3nbv3WoZdpzAMK6R12CN[Hk)7{CR%VZ=pOgEG)|en\<gel+]sqj6fRX43Jv=\ xOMEU9"t|"M_Id	eFMq7
Rg0El}*qJwZV:C$H:=E""&wyL?gs2&0E00eSAR 1Zn"y'6tTuL}dP
[Jw
qJw;/0{i1p8^Xqy*qy(Ui;Y7G=X8G
-G8G?U	c&+]_@n="8oz(% QE$O'N*9>IE@3wBgaQTQz^&?(i.Lv0RQE^"ki AQi8F)upRBL',ExjnIG(y!rfn73X8C{LhL,eV6y=VI68,sj:6A9/iV6]3A&ms	2KPl4Iy1L@ 	7PM=I5\#mfz kYy i>pDiS@=Q3d+o+g8&7 -L`$`"{YMoa]X&\nOVsu^4{YT#7#pcX[m|*l|RNak@"VXFO=nQ:TncA.Mk}_$p3aX_gn${_bRV9f`sZlKG[E[oz~^g`ocMgc_Q,2Ill}mz6QmNIb ]tEcl'lS_!d:ksZ's .9^ +,A>/kv.gz=ICIhx7jO=Q>2/sIYWSO)`. aAl;x$+Nu]r\Ad ,K*T9\k?
a&n[J$@f%3_XTa81@ hmSY!{ zNbj9pL.$r9e|2:s;I[-kqmQg+u/x "! R87g(RHHa^jku%<$E |RG(EZ2u?_;OZNdAP4@\]{I?f`GrnSzYHA-W[qgOq^vOnJ)c,|zRnbmIBKx7=+y5\`vYaWF0UE6ZlUS656M{YgQ8m)0blc]}aMYLy/ .S?GI1{AZ/cuKdGw~TU>')=8a M*z[=7[+\lZrKljc*A0dj|R$Xf$li'&r2hEO.3&*LsKV:^ZB>aOo(('LrJ3TQD [W~?d
;j O@Eh|AUZ.u@9QE.|~LR (j>*,MPE@+o,-E"vwI C"vwI @oMSPli q  Q)3)g@3$O'[<ska0 (x}| 3wB_W#N^cg@6XWG}Pfx4K;c7=TM>Jqx}|
z^7Q41J%<fx860Re<mZ/PoMS=AJQ0yB 9/8?y<I-x`6&JI #5y\w9nO>3#+MZNgI1=v+@h*H\"I\joe`hsFvxlK6jR$k]m}Lpa';HmL@F1n2Mm40i*9Y\Gb' s4?_NxV}( 2 .Nn^DT6xJ_RHEo>V\'o1w}}U.yFwXCN|.loqy;Pa,Y)$KipY[fec1M;$4"a'	m7]o^w}*cf5ZtKdped<n:"8z
c}HcZ4|BN:[.Hw.+Qpao+%@pw%;6w)K]*2n[*=SZ]bhc\^z87Kqm$|Kvx'T&;RR7!uf##=TK+Z#h }3R
e=J0I08vW"f\vXKv#eGjA o>H+cc[N9;[dJM(W~	|5U<5K m\[RAJ$dM:I"F<z%hvsMia"7^ZbWi!kCdJIMDSzC1P]%kx6)%3`tgW7QtFR2'F6o6x}I8 Ee dM1|?zej+ poK}
}Slf`5ewkY!`qf~P;.%=u\4|tA	nFem`}1asKQI@k$[6`iL2a#2Kh:$*B2n!6 bwd<B>Mgbowe;j>4`6*pV,'0'SFF5\ Hg!QK!,yq;6q3V-Q3Hn78o_9JaS6=1@;G>,"g1-h6 nYPOo(>3?rR6 7N/oBtPw*qx}|L@H%<fx8v~uxmkDx}|
Yt 5Q)3)g@6K>V\fx]Dk~/o^t$>a<Q 8%<fx8W}	4l#CorGjP' %MX5_C{\ 
QE9w#Sgr 5Qz~~?}STQDOpC"vI=zoA@4QE)2wM_I(+fs~1Kg>QE	UUUPq:M3H` Am9Tru5VlpmW#WIy<UFw}Irg,pQ@
hjUHG37WgHIhwC197U3BkMY+04_+nW% /w%U;3#&Q]N	k`|r ;JY;*XdY4Q]Sf>*&py[dUvX :tU:: {LhH=<v,-[?MT{NvY; =zA0EOJUixAW3&~M_}Y'Y+ h<,pq>FAQiFG78_#wKCTpdGM_Fp=zuy+*2e}-+XNi*(->#?|pH/j|<+\rK^F_"..puvG 6M$ZlE_KcFan`8X*X#H'@M,t0HHa\/+K8(Hy jJa!~Lh:"dH	P^\ZbjFvv^Tpq=;>Hk:FGHiMt,-7sq'}S!2k-ECrXBxakGi/	*%>b nw	8FyNp}Fk;cl8ih2~"iqvc+2V Kv8@`	 RA\l-{5[TE1mVY pNoWuUwvD$C@% o.lRUhc|y`N_%m;pgGF0F_#pJ}&`#)!$ oWG.~RfkkD j.qnH!jHHwXYP'M:{hIDusIZC\/HWQGi/N+9_}3|Oc1=Zuni[";Op98+>OW{6h5-a8Thkm.]<:c-ld+6a#fFq7TH/b/k23#y*]<nWMlOsl D\o\l4;9{CEhF}L'1cqxz}C&s\ZGT#G"gY_	0p7 "`\Om65qw~VsOZ9;Kungz]e8#w_Zb~;}g}b`] aWdY/gz}v|TDV9|?pb "M'8s(
W<>9wNm E@Dfs.Lvg0(4JmWJPE@4?U!F==x>Rx> $aHx<gI$N!%V	$<zeCSC~reN 4S3yD qyZ8L<7\G+#>
q}N= ! }di'q\Mz4
 .#73)fDD 1FhAa/Oo)rT/\ QJ2=J3=A@.42G2C WT2\/Y'GS1NZ,CgEm*Gm<{X5dEw# l5@=q{A?wx x~&[dH&mG;#u3^_|?eKtTCCR|,A,U<8X].$hSmv3f0p*\z/R?Rd;DFI?-NqmQqa^n	eET7iQ>l; ztJc3T7ABNwUm]%RJ+Hmcbc6WU).^92~xb41^u],Cw_EU<,h#wr3<I1D3E>$	@titb U4SLI&{0gOx+3 soq wti=tmhI+t>JQWJ'xl,\]CUIi424d;7)&h/ohf{wtSoU0!]C-F6$xm)9vwPlkRXorcrenacYclp duAqpnvc?/i1F4%DdyCf9q,Z5m,{^#'8xeI2'SgaqzR!h`kOb{veA$s{	&&+bpC s){}HK;1G7o3El@\ph1gqM+iLLu)3_MHG+#-vH"^8XMW_K&F%H&HhsC1gjrvblw =)lv'(ihJf$,Q
mH#t0Ik6 itFh=A^d26uluu2@wXckoewJ_ynCP$v&f. &&]T
g8A !,6Yp3R@X`\A9.jsO1!ZOcu2T%nEdMQ*bWw]oX_N7S<gQk8.XsK`o<IoMp w]}kPNZ-yM3\}7rX~CK$I ?d6v"RyL-cpyw/}*;F>, f6j>C6DF#V[9GSz(z(<eD#6B@jd.Uf7FkY3de2Skq	(;1>9u.E8-$XS453{L?2Z1t&]fEx4ne 0u rG!v0W/zeCK@1/RRN#73)fDD Q}Sj O@1/r'_wd2	r\> #3qy1Q 3Hmqrt rFOo(>RRa`pscfEIgzj]fE8<9LLV/@1/OJ eQ?K?@ )QINTs|'"(g0(>a_[+#>j(&?(Mz<
EQ .}\>a 3rQ l >fF26t&[k	jt`gN>0>2sw0FJ	fky!|5bQ;&%=}|tg:Qpq.]q3WO&9$6oW="2pT\$C.c6h_7#*rimrgiEkF:A Z
\:K4Qo,&[	i!]{*WpcorqJk:L?oSMEk[^dGP2 ;J/SCy	.. vhEHu8\@-k"<bd-S)$pTER1+N=KGOC]tiRGHrMEDO@N\{h:FLI_&+4|HYJZqYMPL6lWic^)tmhU]&3R%owTn{Ds~g]^Iavaw4Y$.2eRd&.eD }C$1orQv{cCI>,^h=kBh08Y-$IV>3.Oy6?9l]+`$4co^N<CZ0ym&Gs3^_Vf2r,N~=WEjZ0D&#378[zgQQ[C=]'UM'	{;	 	P,A\{>jlqx6PV43a{=4QL=D6k_3_{22}UzVO CrYz]72j8"X;4|;t-gpv$}qi)*kbp=7jQg?4$~i4*bpb943#pENv]]5\uFJY 9'V`G0<WUkhs+tsDNoHo,#R,^#<+h6bcuwmLbc]M;s363/Qy>HDDaST{X0Z~:Y;R,=`gFNJmu;%x"Xe)dmlN&6$FY%ll"Xku;dSUR3}xuD#;Dv'i61hz,zH!~}X$k#6\Xwh'-YCbdG\^ps~g	!#X4[%S7|dQ+OOWJXf8p<{3j>\huu^]h,pp5#-.V|oklI!4Hn%kli>E;&zB.5#x\|yb~[$61T*17.5Y* HaLAyc-lA,{H.J:Q$]}+m]^QcYRthc|~/E!v0PQDN:g; ~vs\> r "]?rOo(TQD}%UGY"(W_X-[>D D cS}Q#k;51w`sApo<~~?}S[%0K[PCIB mk}OpC -NsXFy[txJao< <dy%uNpx _@ST7nSy/gq$a[$fs~1@yS}P	{g;S/rN	 e2i {i\_UivnYYmx%"Io[N.l3AE[.-|*p1>PFq,R {whk%1:@3J!qDs:7b _+p! m!$u}H#|q*$GLCw [|vf8EWhSH sZl_p{MKR8FwtL< t4H bo96>eQJB1G"h6+IkE y %\Pq8doTho`7w9,g}>3 |$8z=^+H1NwwhQ8d`r~"y'v2a`; 61>)cci6atD(kmx#^PSKi`"6[*&+`;D>&X85)&/y ?K+$`\nd]Cjjg2;nl#QM0%]n;Gl{>kauyM(cG,.`Eqw18C w(2jk<nw8hv[Mp};dAg5k(.G3y>5J 5vvwYCF!,L Dbb3)vOcl&R#V`"cJxXjt 9r>Hjm=4x6^#LZC&wpb= F=; \4lHjy+;gqCx7'^ed{m#"h Y6+hk N~9[]	G;5{>{t<+()^X71[q= e){$1k}bMlR:JqpR74MB]p \w.W}2BpZP)[u]z{/C6E^\^E;f HN ,af2"#kdbHOo>-?CqwIs(>l.iy]i1`!Yn;	MNI+u<I)&m eAipc vz(Y(Gf9: 
N=< SA'T6.c].mw]}s"NB*#&9N$E+X|[/aloId{	q]BUSH1RA}H-nft$:cnl`dlvmm1AK(CN2)e9fxvc#WU rR} PfE%c%DXc*2Hg#!ad7{Hp1JqZG{gOiZ wfi[;ZZ/@$k dK>K?]T68w_Id7nD]9$;9|?paS}Q#(vzpI;&7nSy;f*Ax}0K:sn(LoP-.Lvg0o<dy/T@eT y m^7nM*4JLoap3dy,h:#<~t[%&n3> Q __ @mNq_)wmnDwq T/1`[S kd  S kd[GGp<o`V  
 N/<;k$  S kdM_I _lxqk^ TGq g>%6  / jh/ C_ 6'YQUP+S-3ziFMU;y,s3T[>au5NgTDNH8~:dn\P51kG(_h!h
Qrg{b
uegi%7-mxgCH8nALF8p+x?=X	u(qi CA*e~9b5D8-hUZume.fkZG*R_ z=K]ch=*';6w .xFQ l--!Hh8}a 4S"vl7.V*8*uUW`B6d{RFU1:em*9qfFV wP@"B8{]8p|g]Z$s't1j=4g9d0/$g\ I$>7ARg9um]Y|7GN.#e?{R|<SC5pcG	 g3/i sYt-rGi&m]ARKnrr&?!2&G2|Rv=6Vg4BC+^OwKk@CfL7*BLb)	s7Hw5+pmtFH	xl|drPzGt&+WlW>9}V]^dh2yxUpxt?vsd, |qmVH 9p[]'36$/Vjf2''	2J4#"Nv#ph6i*60 1hXTE+)eUKlm52F=u0G34*FF;)2G(3lV_.mSMF#eAssrZRlf#q]dq9 NmL>*x}%w%pByN#'{FBizF&HvpsgnA\Zs9dQB.NAI!L54[EyVSkl`qn.{lMl4C+^ ~b;)^}l 41o6v`6Z]s?53Knv3iki1Xq26\3kisLo 6}/_X=>	NT1i<sp+ $rIJY!igx4hdcI} }4u:Y<Q.z6181r|f_+'sG_\nxvXRZS)1pBo{zgksekh07o(ZF;YT
G09L$&}VR6[#[88|gc<R6p\Z/GN\Z}3]uke_);_Izixvs Q[3wN!& \_) _ Nq _ TGq 	F1ZS kd9w~
glY_ C?? fsSwu8N%V/5D~q "IOq{q Dwq 3Aq+1{^ _ >, S TQDL6_4 /L6_4  Z(G1'~:qQIN(?@EDnh7(QD Oo)rc_b 3v2yRmw:,
`u~*
YzqkuA \)#%QgcKf5;f\tztT<o#Z<F+6AgeNCo-cY{c^}V,qBO\w['=lF&a$vt;:9YXYyn}{gpauFnIL$yi-!"a;eo9&"dSz6vG~`'~VNN.A@xL=rtrFb~~>8K[nnHs89\,li/yD66wTt{ EV85+7>G d}AZ#\dn	B)yyB rrh &pR0N' 2
0 BUILIXf{T^'F57[m	pn]$pZgoQW,:5^Wf|fz *82q;H)$q88)#.MVL}~G<U\Cu_^]ugcf 7BCvuV(dF16pkskk9|i:;$ ~eu(_9\]vIMA N9Wa /:b@Dv_MT07drwiBG1$b/+yg%/l]x_f%x]Czi|-x}\vXfE&qxn)'%kAs@v&,6T	8F-~/umObiYu [}:36[pk.2=4LTX.Ip2e>8c#rA$VqP0URlOB<9eys!JH9s=7 `;g/UH*'{wHgalY6d5bZoP;`d=n y196E
FTVxj'Hk`b
))}_<{B7AwK9podn)/h>^9QJXi/$7	  ^z=N2d,X|/I rWVRj8ekF\uK<I7J
"JZo}%=k gWFG!|RiZVTSFUUHDSb?_{m&{B`~6KC@QYy8}U{3hL-3LmZ>CTl$Mm.06=v|uY6P>	q|rIwVwz.ljHcEo7*HsOo4+ji}<Rcq5BCp5M%:\xm,4XPhtn<+$7j<dq;y&&!QH;d8\_FLz_$L[rZ9#[s#C]5t$PS4S%&,nur=6\}OK#>V=s_qIV:^]3D.})_b\ "tPw$=AE@@~VgUYQ.|~@
 6,MR>QD o_X "'gt2'gtM;?o$Zjz@|ii*IibU;{OpM;NOaIHm88MG%6{MKI=u|5:id;Kg'%89=y'* pr{M)H	Z5}&N\l6{MIT@1@g(g89=y"6g>I"r4/5hk&1F6Z?Hd$BNT){l_8gBJJ-CI_RigVk%3gxP%sZqln%/1,_ZcXyQ\qFHTE".#7!(mW(87;j	lw)c{)oLms$7)jsYWNi'<P}7aq7;Z*[=mDfgrfNUI3kp\4yQT[7*6tn,.rDHZ4X8\ISW. n~my6:OZatv9 kA3ZSTCpKxQ, ?oH8{oW.?PWZ&-a+w`Ds9X\uv"v]cESA5m2qvG/tcF. v9o+^5.WHij1k gIic-u /{}w7_L0~\}EU%AipeqXh,r,pWI;?6y8{&1p}6RO* *VG<OY]RE\dko OI(lX# }q(KFYa}  RU,uF]$ws.=KjeW 6 Wh+=)0JA+7:QATtsE!d"8k _R~AHDc/5 [LO(9d7%nl<..TY8wFmz=Z?o&h~Dw7.|h/wriq{9%-vN6yc0H_4<eHp\N9_
	  b=Yu),KH?;N\l|8#[.v)t`F=4g;gFb2;=5lZ-E,6Kf7H@@=D#p!w\2'al2vpdF 9L8-vo63 k^U5On+hnQqe}=M&Ox[p>E| !:7bHOe-n9?#}K 9q=/o$%_p.$/z7UG=Tb!I,ZF}  0v]9{v}_({{-;q.%`5$Yv="&SvnTZs-$M``-m*{B[*CU,s<m&D.n&`X\]sI$5I#e}TFx+;-[Fh2pk	i)>%[K$im%%d =JhZ0;Nz+RV1SaiY}F|_Gk``$1oUWdY.cg469G=.El} '$DnOaI\u$s(7Ll;i*Ar{Flx}c%rnwq@Ll6{MIT@:ihag; WH6 	6{MYi;l6{MIT@X:kIPtFxVsgh&(}x@ "jsG68 j(	=??>(GD{-?Eh "SWdM'z%Q Vbl}&(I {;|+IQ}>WgK+GWv_Y!HL [Due?#{*s8-v&=xI	Tf;p>v8dVblpGT06t;6u]NzC#{7oXy:v[:\:&m{p{6j+s/UL99#+4#l7 J1
 p@&Nsf|UY6=.h')>7sM
P:k#$2E#5OHV7n-wfQLZJvLECLlF '@2na"gyLl9"GfKmp?j$ufWDsR,/.GOEwnI$eE6@F/&$|&iu/a|7p$vEOmxK)EXhhgO4ZrO%nms o0 cdV4yVz7	8K ufnr&=B3	9K W7SK"0<918  dfz}'*NM=w>v*i5[<wc).gUO kZ0\ %sqO|<Gq{_m%Ae}4L|v2(4ym/@!bAL<b($$1 _P,iCp.WcndL04 <doQ0\\wb9k $i|4kN >6cLrEhz):-F_ImC1a-8Cym UFk%19:v {f q{2?H"r.
F6mq-Z64n^4[
<\Eapqi<wA\MGU)3C v}xV`3,.]1EEA<H:8X GTq@G}e{MD=ckM}xM$w]KJ%&66%6kZ,2	ly$`"8p8t3SjzQaE*5?g0oH;o-YgYn%{FfI
>+$okI<_P6p_6D'gix'qZx5F^V?kMB6_>~!v3"h`-q_ZN&ilZq>]7L}&Ndg*+fs~ E@DNq9IPQElx}-O5sn+*(}\a 
QEUi;I"(iA[(:#<~tC{!z1<gP 
{,?&"ali # 1)a?DRIM2%%gQ	$<gP 0M!!.NFicVwB ^# 1*)giHD /gT{,?D\zoeG[69&ypsIzoKP}N# 1"@,b,DNVK>=7#0R\zoeGSMUTfs/zoY5s	{7
x9,M\nn$2_Jw \jB\1|O"N'q yM8j$4^M-Zu'04Yy,#s_z6G3j ,j*%1 nhfD44\>yA.nJ [w<!MUrT w$ai'7jAY6Iu"94\bvu,FZA&EZ`ucQC!=+:E#cqaON#Enz=f6@\E}ADvxhK7=a01.%-q14pS~'U4LXE13YBBo08HA" *B	XZ}RSk\R}	"t=h68k~hFYRL7uQ;$nR3uU3,SRG/,YM6^y;qh\ceUK5CA_-3+aRTDrnkgF$&Q~)$0_5mEMUW$6rXrp ~i8`k&Ok\uUkdu3EN#ZLg2F-hcd&H\[+#.h+WtaO_"/E+"eC^_K.ogYM1{HoY_M#;=?o>. _Oz!fNuh$*8rX0xCcT/o^4dc9ds1Aw 1 IMoe;:[<i~Poab3akNEV`C^8e,LV/lFE[ {Mwl.q?+ B3L,p1FZRa$z){3 ,0dc_T4FXF|-sJ]MyEpvp=:v*cn`"#T7X%crMh[EA5{Nj+}VYiYt=+L#[W1$iyiqp[+ryq;lF-)6xv_8{wlg Y+23UR)/ Y+. cmcj>FR2%1[QH\7AnsL1(v^rZq}&q9]E|9?$n\ ?~(I$iB>aJ8<gP 
{,?DQss%=A?~q} )[cg V|zoeGZm_(<mdpak,cB+E>J 0OY( \vqyN=7#T@C]^# 1!(K;T FicS?~ I;`4kjzoeGTo,qy^)]V@m~N$N?([qiSOeOZvQ4dSn.1E5N1j	$D8Y@i@bOZvP;!JCW8n+^1jUD[ABpszjn-?*qi@bhO:c&sE;{ @e_b&lBC:ZvPFza!@ZE 24WZM6atI_=ayzga-+692|$>9.qQb-I\NHMjJ~&1\EE&1@tMtl ;
X0|kJ_	`uW9Ug2TTUv$XNWL+dv	Sr7YX}g_8>R]p[J&56 }5bO({n[R&@Q%DZFIFN#]mGlkgs'J-D5{ahv"P :G 9Z-sf
8@F6 &9ZZwp AAUB}wPZqf5eSG;4^y5%G"6wbh44	cPkE`-s[({doc BgB0[E%}=zHBg'i3HV`?-C4NeXcb,/:Aj(>XI~){%lTl~3r]/%9*G~22lXF:~&z[.`h7#8y sEQmzSN/PYd-m=Tpk`+]}o}7Ng=@b_DeG[Bc %GIIE->R:V8/T28Yapmb>`IiN6i=s`kQ={6o=Z`@]o,A, z5H54KInk}'#eh7p7GDC~dOi[B)ly@QV}Td,q";[GMwbH09u I{9c|QL6ckuO%`pv`.O65Yi.^'x
9n=Q`}=/{pP)q=9nmR$krf~#	Z=kW"=3Sl?e	1;6jV
@G>{%	rF?Ej
aJ^uS(e.,d]t#btgA%6%7G#t[(o;s9#Qq#R-XbxIR9-j|~/Z=V5lBC:ZvT:g;-?) 24E5N1j }?[ #{rOh|Aiezy@ E5N1jTi~ B1-qE8%Igzj$s6IZ(1jU\bx8 +[>ULRM3mb;|ZvPvwI TKQ(;C$ {zId[txz(M_I6JjLQD[3w	]9|?p"(M'8'8GcKdkq^Cnl Qeikpz=fZo\'g~BeR>OBlF]pu GyL#;v|TM,-~kfG;ofW<-P|db'l!/HGjcpJkFd=&]A%Xw_:^MO% '9IWRSk zRAs4gL}e]wv)Z1Xa5gKV.9ZpL WL.9g5QKNV#X\-jhe n58pc~" )i&A-H qp:L662FfC;IvyY	&rmiYI?AA%y:Z"h`]0`ol	#?ck3oeH;,5VIY4rU"w]H5!{zR8Kl+~l[\!;(0%15[b%%Y!\B3_TeY=rGdKn{=W$ep{ohz* ls\Y~6}j9PS,=k_#cdU3ldp`4Wu4GJzyYm W]^L_EE p9L1,NlCb' 6UM.,Fw^lF{}Fv_SZ${;axO~Krn@v`H<a;fID"d5%Pk&lY[9{<[Z3x2Z5>?yfy]6^CpWacwpW#Xn}y.{Vcl{+{,Ceu2]f	,AnCr9BNakfV>pn_0DG#.g.=%kpep`uudW;] k{H5IYrn\l1L/m}aH{oE*6b7w?Igv)?D),&"(SWdY-jL$El}!Q[3w*($s)M'8(;eSAlx}wq^$P	TQDLvg0fs R(I}NQDJaA["hc}x@W=)=  68 hati@ i))SC!8#g4D GE7Q>AN7Q>AmOpC&4!$o2Vl#x?I,MotJ%|n|n|SWdVuqAIw8\N)OeN)Oe .bci@08^(~7Q>A D{S{@e'8
X39RZ7e SV5_pW SYg  c0'wo,2Yw<5& ,PHB.rX>J
xf uGtm7#UVM4<q|Rsn9&#!f&{I/`H\0nJIZ7v/# 'R9\rNx~MIh,83:gTR
x*+5X pm]e.^JWS+296*6W' mI,1:BV[)t;Z6q\= 73,GNp)\jF\JmkRi$@47
i9-!73>5W:2iY(BW)Hu_/H5mS\8q_1l.XnqP>OOq(ns[7|4{l7Nn7\v8H<O%3kD.F&G'=si([.:Re J6dGOIc@x	#{}k#k w:F)ClB@nHOTfHuD4(mnp2F[ElVQFHh|C;8vn]T5Q:>>V<9jh" FE"sVe10.s#?lFy$X1b|{{a nFy>\!$o sZgkW,HcFv#Z5x.X@9idy`p NcU vx9E
7FxCq_>Cb#G-sl!-]Rv_l+67-_*WB^,c[5=;,77?P27S>:TMGDFlZKFi5cd1mRL>8nGwm^FoyfXN|>W]e>*'G+lnE6u\,w/Sm	=bQND{S{[jL$("6#nr)g>\RI lNxQ+uui9w 8fs9N)OeN)Oe b7Q>A y'6qyTqJw*qJw(i}2{p4~(JG8G}N+cEqJw(j&RRPtFxVt'act h= psMk}(li ^li  QJbOt?DQD=yD!F
 a_@+QE7)BoKP(v0Ri.@EQ ^ ~ 
(\>  l.H`5wP	\{?erJ1'#oREDM~ ZJZ2*rgr{C`/Kh9?G 1IdhG9OU.9hJ
mWz|5,.}uzp0uFV Th"E-3ks80bqq5QT1.kIr}@04c zHyyB9#m@ds%\iSS#Z82.wzhC-)ci$B.]srh-3Ar(lDl9C'p]$a';A\@kcmx<#o|@$-g463P)\qR^*$iVk
 H%oG$ayse_Y9sS[/7J;^T4[ay#%CsJJN?>=,b2Y:9QNiZ*c{Bsa.9Z5g}]E[O$3,\m
Q[FZ0;XFkbIi$-<M6vA|05P X^c& ZX[trq4O\9H=)hkY@:9<__WAvOL\D -r)\f)K vk}E^z~5.dtxp_X2v|+qgdZ5LkXr,TX#N 487O k73 3"=O$moa,7&i`3p9o7Lvf7nI+e\|]FpX{[2.qZp3:#h98aNROmTX1k-p.WgDMrQ	%$s	 nPbE:kA,xI"	$} p\$gzZZ}5r%"is}mkn=Pk-q_o	)E4|,&Gt?hD]7Ri E@DISz(j OGm_(:*E*(%Oo)]?rE@mGYT}%(u-E@DN?(dN?(	 JoJ )FsqhA%8nK@2}LR0q<ao(n%7|4Jo d He4b)O(gjry!vI=g wGQ2q;KoA@[M _58L@-S`hE%5}&Nry) wX <qgK%7|3w	ojq)(qN9[9wT>9[S S[ (O.'6>k'7|	jmOO*(Nj
8Am2K+#ks&M6 Rc5U-Nes4rs	!=~W<|>x04[uvr2'4`@ML\p_?(XP]t%lyA jz&yUM;87f\#anEw>lD:K7SHbkMuzG	-p'P
wHjX4'7]9]+
bswj,:`
x0|`@!Sg9M	hbnm.eu_
 sP_Ak({;VQ,	l's\y,SQsNe4	{u:IUS+KC6Xwt0i}PoFSAXF"\[KhnvikhkXG(u]>	${qCNGN&r iS^@GEjA7S'27DPnl>{+D E\5X|bcDvV^k	1[[|$&An<]d-(*uU3r~W;FXny"1uR@.<Skdxe&ugb|{>*vv2 )U=h7j2k1 a=V<-eS8 u^g$Gp{Q{{Y]BL"_h'13p6u_ac\gJF#xR;[0V< H|;b_\$18qbiVWZ]nT|	5>K$zf_k,F;WIp8en&c gVqdTZ5c$$iY"`p?"[S8{ k#Avg^:#< N ?Ohj_L}69|E/}E-WFbHTGO'EH'zo0nYG	<@"g>q)iJo-I7	4Jq:(:xk| M _5[ 1^I0uN9[nXxayfLvg0)iSWs6(9[4JJq:(.XQ!;avUSA[)'RmlG!F= B(3;C$ {zId[txz(M_I6JjLQD[3w	]9|?p"(M'8'8_	GW2grQUQ{tm77=W\nU0MS5dI	9Qx})v^y7CUSDz"k@'1u}EnXIG6Z2k(Z8Zhp\6.{I]NrTsN1l@!m4&N#yASSbv 8qu`cq-72;LY8:rdkt_W^L%Z IX= ZR(\/c 662!iXy+Q:s<L6+LT[.(A,hp-Rc=6sa]$<#9idhtP: f7'' ,CQ+A'\F PJ*1Zp3Q 5im4%iL1PYy` onJ8dDoE){HTXX Oo8(jPmV7p6m)oPrSmrVa3&<ba#>i0%wVuiZ!1Z[$e$Lash':Q!kn48u|AW"1y#Jnprf21p=BWdf@q e nblC)t	7YuX:(akml-p[7SH4~68I\mOyfb% ;C$'rpvZl,u	Tz.KZZ,l%k$dE:a&vZ1o)#||'0;Gzl)&)ZvmA
F+ZIVFlM=\hw$cC@8Z]E6f./Jb{ a^';
-WLqKt[D]Vqd`s|3#)H87kt$xpNz^Ihki?wh]QbiQt7 /iSHc:kR3/Y-jKKpBg>TQDISNqUQ v_Py'6^Ia%} Q_F)M4J(?U3@D>"G_M_4 (7( %QvheOp0~Pg
 18i Kxi 1Mj9>INoz U@2kd:F7g-yD )BcZ,FhD 8i 1TQ~oz Sx|,s8%+Mz4
taL]D Et@0Ap{b|~/KNoz U@7lQca${!{B=A@fPSFk8v[bmG,Cs']rkGY [lBQ#_~@'NY!(Xl5rd1{+e.s!kI%Tb<cSPIs@'v5"!/v\fteb:ZKx6 /Jk!,fV'} tzVy/M0mfP&xIdky)K8"IwmI|Tq1&2j~!1@;2$F-}4LkM$>u$%1WmJ"fMY4Z$j)v9-q9 'H4Q$e,#Bw-2_fXytm8nZG$0^6f , gfKkP<Jt:FT:|ehvYdfA11ADo%n>wK&A%;+@\Xs9_BmTW05hR/lJ:C=cF8d	skb~H vOp%v 5{P;
VN27&F7a:Ef 9#8yfmA!.9f@;]giI$$4^lM{MR~yM;)\AMop7d'\8aeisK\qYOTFI+d_Is8@>\8H{{iZU|qb$0 #/7XZmOEQ1xmgn4@k&J)c&;#	I+jQ0~E<.)^=ho-g_2=j--hBgAKtU}+;#$ 	 -{Vf4o*]R_I{eu+EJMb&h48u%svw2p4mVsqXg*gT>m|sL;=)'U8F~KzeQfbrx|s8%iBg:2!n>!ak"B>aNoz U@_DZ	:g;aLNt@_X8/+@/M_rdh2<E"Vg}?(S3uaL\LSK.|~@aM_4 ("Gv5sN`p0~Pw
p0~Pg
 9hMcM_@_$dq{mOJ eAy) 4eO|Ay+5`w/y Qgw bOtyl ~q{DgwJq{gaQ103S b?nQpiiv Ay) 4G8W-KI, b>>v58=|~/KV	U 5Ay) zzo'Uey0ros:f,#tr2n,j 9aqCH,3B%mse01`CU0kEnTFvf);"sdt7;v'ZIj!y*^ 9 v"{5h`P/Y'Fs<,t.6}DFI A<aZ,s.:`7G"!xk6nMU s&Y6<ckCndn+Y\Q+q20ckMs*`z^^[aH&y>DMo52 Zz1NTiH12-36EElyu 6I+c, sj)UCN86 mR)l/e3n7R 6}V`7cm4s6\uK9=faCH#;^>	<-	d#Hen"d$wL!~7_!ePK`E w60s2:-{m@d/-"lN #+ MsA9&2LivEJ}q+H n#o)<A0[1gD#AF.orZ/k4^J
v5ksf6BbiD+uiL,r<+L7hu=qWC8h"bmm.==A1n'`jURD@5][9S?ZWnvs`)Jz`!gf Ns$ac59pyc.7![kjg|txYm|]Ga#(F2AFTWM#ik5;n; K3,IMQzWq6jlOd%vs.O_eSMo]D'VGfyK)*8\.N*<O
_`djx'`-{aLmZo+]p1v{Xmg+)h^|n&"v|*/[9E	;`l	fMlQaGj*K/;K(RG7.I]}$$6hw-dI1q&bi'7aMB1#K8:MK=iimyQ6i%x=CbiWx`\ D@TFq{wH z-PnSu}^F wH YWwKD99Dgw}hgwcQAy 1,MP-4/Vn@N>v4 -E5vud 'gt~ x<<3i`;3 (??>OOp(n'!;G@EKg`l (;dE@9|?p3w	(s*^NqQ J$eU@\I\~Nvx/fv]d.o]E9pUIvnG&p2sd8IK1CL <
3xs3eIIa \7+5LZ0M_1<F0W	jf@=0j-# t6H6|z~LPS7:GUS1yGh 4n?DzrixYXxGu\TqMXvF13|]gHF;!-WfgM0n8R	$I!Nl49gS=z+h]pQ=~)k8*Z" 8oHx uZ*OH!xkKNwV0b/nWbxqLX';~KvCx0Z@.\e5'T8'Jk}UY%eS)! f2 xsT.qOk`s\#|x]*1UPGa`MvCMeLY`pnMi;sc27`a8uu()Kbd17I)k?{ ,$c_$HBkm~&av,`\[4#7 g^51Okdg:JD6'c4[7GZUepkw!6`sd1 9ARHq  ejZer`"i&>q+]4'g	1Qcu\Ye|	#7mJB60y"3o$VYWBEQ= mE<G;];hO+&83]v qa}>Kut-2A`1b1NZ!9TSIWp8fhM&zUb>=V)f#;.z+_m&ZpB7/i6OTRH.vgW{HG!3)pfqKk yuG$, 0^" Mi	8$J(X 61whQ)-<Dq4!g[N,09xFR`\h4kE<o~W6^!^nf9$ k[5uf^DehlU^qi;Uexq_El}!Q[3w(4rI;* _P[+tj/$W9wUQ;1/@ 2w%)_F)@EQ 3XPtFxV=Bhc((v;i OOpQINvH OpC&{?@$[txED"iM_Idhg>.}\vHs+734rmgbzX;;XT
ssdy@8YYX6T&X4SpqN8@pQoR[%!TNv) ?];MAn;vBkrW#Fnmu"vXF \Is.i=]WAE7: 04-MvWe{_1 Q:j(5=n..WgXyn3wng'03kgS IO+2 t+HaXi{Zv$RZ(MOQp6q XwmY=-Zecm;\Hr[^Q,Kay#w*]"B+lHjz DSn$60ZK|bhHe~230{[$nmUI+\ggSMBK@~s8oxIjFn7&aRUt=t4k!W.~FHk"{S1PFoV
D@hWc<cXia2:GG{#kip:AVdnqKU,5H6E|q5JZ$t;iJ'd;ALm!<e\ d=@;F`~\ZsslN;-JN{n-fu=TR6H1@\8dJZD\j	rPIi.V![[8RD=giMe9vspI6dIw+G15cM K{,~vVdoH]<U3hl}JhT9E5$Cd6FG-'nmGVv)Vl7lJM[5=~J'DTz)_qr5h-$q!.'>g19?:Jr6: LG l2iK,*i[EGd td$Bu>77Y)S!vXFF0 @6#I`pE0+V*5&^$e	hQ[+:I=r:d,]Fj*fsfiEJN[Ex/-V4fgENezX+1"+fs~1B>aOI@;IUSz DD [+tjj O@;^Is'j &;3wi~ DDj'rR,MP	N@aA[u-EhcN?(QDL6_4 /L6_4  Z(G1'~:qQIN(?@EDnh7(QD Oo)rc_b "(tPw,A- -YYlVSs{U/}JV#f}XCU11kF;#uT}"?$"0 qYURGu2Lc^+P;Fw=07$sm \lN7nqM9O8'3ku%4m!IX@+fmfAF[Eq:kBsS t3 *t"n{*dbGOgBM`2;@rKb*'hq#\I1a4v!i [a\WP78a  yYY,vPImnX ah,&Qx0i]g3a26;ge>5aHjP-',D#kY4T=BX-Q$5XAnhhz(au[iEa+
f[sP5#z{r;z>HH0lqD*8Hk-aVC~2e1sii>'($)DffZdiz%6D]oLi 1mv?+,KrH}O='RRFF--/n.PR zs(2Km$'![&X)>y~h3GxS~^crm'tC3m\HZ\Y2p)UtTB@s;;1-#r;eTkp7x(
#t`o:b%.^>
z*z[=-m.4B"dG?3{nYYs^X]hZxKyZ/)U4s5n
o:u]%B\ALm8M[7!2_mFZK^4x [U4DZYrrAdndPT-or-i=k~+_Fa~h7V67^VxdW/\\7$4R%-&;d)L&|~/E!v0UbQz%N( -?@"\> : m>})v UQIgzjQw }z ;; ;; 7nSG N!WY;N> v4[""$i#8@	#r-D Ow*}jG@lhhv	oA@#r-D B?mt3+JjL|mA5q<aq,vg> B?mq"@k\[eZlc'8d~@$/vX_n!`sw`\\;x55[hd^ZTJlD\rjLG3W!qh $Z7MhJaEA	t^X u=iUL Tnk>hTmFlq(y	y-kXQ<$~hzn\GCwlk$Vo%,PT! On^'&6[&u2IE*6.d,{w4+u.3a	+~25MHWcFERB]%n" k-r{,MYAJ;?f/Yf
9dQ|@7Waf$?UcN]Hr&~a+lIWBR!r$oMb-{B^QGf	9B2xj1G~7 b\5sFlmI	LMe\ >1mXA?e01`<o~X"{alw@YJ%kY2zE4,"p:jZm;cQSkiOLim:6A3\tOLS8Dt53I6mZt8P6j	%`$lmE>Lwfh.bdA/ezMErnYu*b^:':2VBZcuN2cp,qzef#_>kO5nL t&J#{:9[ "FL:8	3 liIcq9H{D|x#hq1o(v#iX;5oYm UtR(es4x@p\SHx7Kq3-;5H>EzV$S>Cdd_r0>5f2/o4V\[>	 Y!ht1op%~JEM}qu+\kXqfd\h7gT:dioSCEWm^N8x' r?+fs~i3q)#Q 'rsIn mNq Wo}h52 B?m+tj N!8q-wq@oD}jVMLvg0q)#Q m835gbw%(8|mA=6p%fK!DgnGxHbC{ 8h}?0SSgr3x2!nh WfONot PT*93 p$Lh}?0@]ENz '!Utot P[tx| 4^ddg
p~`SWdLh}?0Kccr \
+3{R7(g>.6zQS8h}?0@)wyTrJ^#y%QkO eB2kq?/E&pW/k0i b"mVURf%Xa}CN o[cocsl i@9d27yD%vrrX9]I^`\Mzf:.2nL1I)0[vkg ota|hj[:*M	{6 RK9KKgSX?X),	*^YJl-HD68MkZsmf5P{ 'PGOy.a}:cp`u[Y"Nisz9\<ozyvH5r;ghQ,vf4m?5aua#H>JN^[PH"{.WcKC#v|DFMlK[$:66GM1Ea;{1D)oN}ww!cX1;smM+c Re	cRmx"ek!s^[oG'76[?$i[Zwx6svo25DJvI#xioWzk<(mdX`4l$k^,nlct{c.iSM"N+]B#?.3qa jM1g%:tb=z-	um1%kDD{<o!6+<S-C#sQ8v;T{={S98Z0ADA1:y6pFUC1orX9-b&{y[Po2{08 HmF0@9!iAmH%aM)ta[,gAA:#h|9R+V{.Mdvm3\Hma]H4h#1u-:O{,!euZ'?E}5VzA:rCr3\!0:EI&[sOvxnryjU9|?pfOBSJ]0QS8h}?0@]&wyMh}?0K"7OP(J _PT;z^I~`|$a$d1 )S?;7("Rq^QS8h}?0@VI1={\2 ?WfONot Ph:#<~t=#;Y#84> .=g6Hcp{2i@-QE0|$0|$j(	$G1'~:({?C;!U?V "oKRG4QE>a}\(=Ar k91/ I./%2j~ [=y@snu=+\6nsaku+*WI02e3#+-n26M2cA7P-$u(< sjbki!.u4[Zfma7q%R$6+FlesX:j2K}##fd(~#xYL\]_;*QT_gg-3kOG$s[\nuY#s'P/Q8|& ,;4NI:mVPs# 963TT6	un{W1!VF`h.n@w. `8G}IX$l-1< \MMT=gHfQ8e|Zsp\ER]jVV>Z:` ;E1e862mMMZ5hGKvm `:epWnX_3|J>#3qEj5@IEJ*JlX!6xG[{37/jwC-/6r,#!M"@yNy]`1,(#{qu/}<rFr^,c$Niv;<HZmejgteknzx^{3nyf<h=wl7]4)Lk0bNuQ [.Bu[ 9R
9F'hqeMS?auO*Dzx7 "/d> /eY~44]`.P!8[#P.IP 2#q]Nk,n*h;v20$k[^MM1ZZ/;i~nw-#`-=RAvht]1[%qq: `s9c0_rlYG+ LcD=r9,m.aZc>iClhnY&&*R# :-_
z%?"c;B@5WvE@A=CBp]7Rin1QDN:g; ~vs\> r "]?rOo(TQD}%UGY"(W_X-[>D D D58@,L6_4 _5C! @[gov~ $O'E2Yl.8N['4>'|p{'6FWS?_<8m@2XWG}Pv~+C3$bkaD58@,Mz4
4<C!oJq#i.FU<5@Y@,Q3p{'N'|0W3\ZlYM[6r%:DmGoAFo};.VuS"q760u4
N9 \HJbx$VDed/oHHma~{a&eoqaETwG`cSYkNZ@=No/] \wrS/+ww<<wbL\M-Ppn\YqsMmo-oA:GE% 9]-em:*/kI '8W\m|kwrZ$6^Q6\k[tPmZYfzGGr$zBd0lb7pzBiy8i*bs#nKBCG[TM~0IgsUn8Rq}/Q*xG\A>m%'	#d[!5'UI([nO4}dwiTS)~`GBtdcQ?yH"$Mi#h-mF$H[:[q:#t,9+&(=lMo9hu\NHY<<!81'&C<0c}K:pA:|d8&w;*.>:}Vs#q<6f2=-,eK|B'>F~C%K_uvJbR
lpan!"2aN,odAgZDLH9Ip[^7Igt@ce.D5C,,-N*"v{q][HhbK{_'.q4y
d`rKrkrsp#1eq`&hx %#mismAf5	,+E(."=3mskueA{EM~"=Jk2 ouudV.	TG-]7?KHh5gONd'Lr43kAm*%v~)go]?O //Ke Nd+E	>jXZMc4
%v~)go]?rmT$YdD58@GYd8Xev~ (H
}	0QAw[n'|;; T6SFeYg QSgr=9w QE8I!NE@-=$2'hl,-?DEQ'zl;(g>fs~1@EQ o].(77@r6.6s3TmagXz]y k*]!uu,t~H$;Mfmg 4EZ\3*W' s+#rk,48s}?E]k4/)-BnE78k/fF.OYVFVe_ZrUX{5n/v lQ%C%EHkdZK_&<_jj]cu@Z1 /( p\t&i<"*& ^nDs]Fqki{ (04NBh y d;,,u(]`dX\\Qe qw&%BHH]gz.H&~N*)w$<T,Ek?v%:BA>ihsv/*izN"& f0.U+qx?paTyF[ {f#BcQfa}*oM-Z6s9k@eF92zUF#E|TQzcpz%L[3lhHq=g_9nu_BP] '"N	k<&lW!%{UdcwA8$[BN"@oPB%{.p4n &.aic]i	 q%/eDwmC9C2]%f"W.lsAx&f-]L}7#Zw7.B}`_P9f#3WFIlqo>c"(h-y6vg8VwbeA^)cq&!}UsI#Nt^3Y^*wWM}XC!m2-}<zT)Ee+lT
VoHgnwsCV9|?p*($s)M'8(;eSAlx}wq^$P	TQDLvg0fs R(I}NQDJaA["hc}x@{j qy+
@1w}PI Ec9#fM@"?G1'~:"".7IBL">)Qa0()Qa^V+p1XWG}PSJ@4tPA,Hv0n/F@/E R'E?G"_b qy*qy)ZA.wP^7JV=#cN`MP	kKm+YtK}Wr3<bbb0@h:\i@3^Kv{<.MB]k|KrX,v{$xA t)enky!Cq+<.<r>Gn2_!=e
;.JH\Fixy|nLt2NzHPkss|~[44rLm+G
yKy9 r/\HhRQyh@
D-h-sI16!|X.bipm{I=U-vF7Zb2BFxDI^q &6%t{f<cUp2Sj("
ve$}\~,54QrJgLF~6DU! Xr#\o$L> /ktdQ ((
Y$pkfiCHI|k"7 _AR()8cIrE<\-i""7osoO\L$77~7Mnt+m1S8YYam2{%
k(DS26]X Jo 2G;oXq[M}*.Rt! Fye{!Fh7NK,?
XC \>_D]l<d$oz?sqBII .k7T6B9cc m:[+!6}9sB6<Q6Yk@\
\ j2WSVo oprjlMA\4XDr98N'B+ITc{be%7[%9K%71`t#w>v^rBPS0X] {iS5'9R*&#1cGChl~r3b..]V\7-Z(NO|`fJwA	v.ux?g;R8,#Oo+i""iK;\7:tPw qJw
qJw	 mrX_(n|9V: 5E
GE+MsrF%Oo(?8?D)ghnb}%_00(	c&+]_AW}n|FTDcvz'gt (&//-E@R?D8$O'@EQ gaQ}yD "?XWG}P
QDMz4
Px( ]71|~/K,S NgTI\[:_f.-=<Ypw@.ssH^19eVgw-b-j"	n[FamJq"7n	0]r)h@IZ4L\pd^
qlTnA8KFpmIfhYrk7[GBlH5p	a}]|Jz4u3}nmY_),W#MKNy^XXpZ_k&ju|UUNFjh:a$c7:RavZnm({)Gg3SCMFF|'axGbeurf>64I5hMoRP8YKgVIb/7Yf ng0*\]3[uucMR}V8X_vYMp^y+HLq6{}1'xIp7nP<G"BI_~0a G68\;rDn>Ph#KZO+/xUxW&$7S979hj!/ARl]mH[;8jV ')jk)A,JKTY0s]t9 #o$\t+\,Rme;KzX{rw(,W|&/S4GjOuRf'v!-oVp+m*#cy B1,XglN >.BWN9/ cX,Hu{Nnx{v<j)(k]lu2fq R-V0C;-{u1G2norXUnN=JA$kuDg4ZE dB>aOo+a\ "tPw$=AE@@~VgUYQ.|~@
 6,MR>QD o_X "'gt2'gt^t%8>KEx}|09sdrjs@agSQSX</oWOp7h}\l;m{9izIdfx4K;c7=UKg 7h>/oi#cZ$fx8%QY1>H- tPmmq|_dX.8R;HHm Y8@!9q7vzb\.W1$T o4M<J-N26DT	&5;3{n^8bQiY	-`&^$gw`X:F w8]7vdbgY\>X;mrF`_by.:y!i'fnn%8qu1$;M;X`.p7nmY_jp4I7\#"Y4;a7]57 z/"sF878j5'pWU`>P\K#eOhZG2weVbx%{2h'#lQp~nqs@}TE,#3G7 .N{#exce ]	so%Xd^}z@/ec&glZga\N/sZSnORt/'{29 %\##P<l=6U%A {ByXg9.RHPZ"Whtp-(.\.-uYtuZAcs3]l=dR/ {FmogRp^[qNbrs+ep 8jR%F}.wE m-xhlzWBt~!l%bs]mH{eA9. boZ=]KCc.Zs2.@/
 76Li,F;l#It2ad$nn>8[tg[qvn@X7[P3"0a8oi:d=w%F
9syK63-,hmzhMSQ7.}D	 s(3,@En^Z<^t$6t-Wsn(\fx8%tm_0puzfs7N/oDp`ki;fx8%d6I{;V^t%J7cT	|MupC{ zeCSC~SgrC~9Zk,@+3qy??>^I"pa8y->)D/T/ }OpC#eN 4S3V-?E~#73+G'HB}N= !
JjL= !M$3053{L?Foig@Mf,FNKC] ! RwSehkR`s;%Xae*e.@%'F[5178b}Y[r+\zb6
queY%^d1R'#}ok$ rvnwnCEsl-krPSVNS%kcy8BTA \CMi6n&R]#@YLqIJvmu43w	Ms	kN:{96Qu?{AP^DhZ3haC1wdqeK!by@oE12C].z*"@sUl&7GM2C-r2;P	.u[s22@6LPNi%qk4/ok-H!vxsEq,[ fV+EHvX8k>jFFU1:0G%|t. YfQ- +^7dZq`m@n}[~8 }t^Lb K{&8sVk3zwcl#Y\WajMWd`>#-3<${G`\<uXA6xXS[NxlU'v(#qvX^au*oP.	+.GhS+P.ND&(`"e$jxk]]"$B~LpEA&akg}
rZ(o-xRr)Y=eO{\wtih4[_g?6JA0>pm#TL-l{`;.Lbt1fIFhmemlqrHnosfO8G~<^j;  #-!`P4mEYEl})fEx4ne 0u r[a!x>P$s(= !]E+\(EqyN#73 4_PQ} RNm_?U8OdEqyN#73 Lvg0FoigZE o($ zeCSC~j4J`N#73 QfE8<*3A;) 8jzeC@=^= !+jayZ  QE0|$0|$j(	$G1'~:({?C;!U?V "oKRG4QE>aDi-vQPkIuSm5|g#g]qf	=VjBFmJspoT}QLnd8].zl{=[gIlf[dZoswakubs[$.9jo$_B RBgr 9nI6"OfA9@Y'7-H !Y'Rz 3XrFj&'!.H,vZ#mno|dmJ7C.%.z-hNW$ON:8hA4RzH%ikZG'DFc/YGu/$6i(he,-8$7cC)$cxp:d$6r	6!c3MvC|@\/D:$%kK2']iF.GqXa@\feBMgf; xRw@X'^Q26e-An6BcK&!o$h@pq>QoCbu}a#kWYAca}kgsgXjL`YFm9^ZZ=i+jkjs;Pln}kAFl_}[p c6%Z/]3KE*p!kHY PC:77;Bs!dtyR< ]$M&V-#K8V5'[+ViGAFY {w?tmF6l8Oc83,Qtu%tYw&O/`5[MIN(*pQi`A=vAH<J:9dfdFlK h$VBRz{hmS/;A9~Y_bB>a1r(=ALrQ  PZ.uUVgTQDK>Si~ *(5JK;TQE
[>K`PP(ao<dy /dy -{0 Q& mjc4jbOuq0\H.S\-G*#L-GyD%-!aC4D- mkj'9,q#<@uS}Jx|-GWT
 Dy>aJ3gq$akKO$y 8zu\3k0NhoXl]k"xx6[,K] unZ<oq*|:5a/o!m;aX.^XF@"[+#m@7V_e~g#qAwu*Sk2m%N\CkO\-hhyU$4yrq\f4]4q[w f2qadjef{`I&dzyDD%YdqW68lw<'y7nKj.W :B@3Z g4YQp=f Kei{58Ln6Amv0(\mU*9MeR<qj\"#N6DM|mc%lbT?5ldGoD\ p`0m+{tM2NkLv7$O>&:G'B<5"p%s03I4CkS:Y xw_'K_z=!5L8l`I{9,
'588	hV]xVz2>k)*58?X:~X7
Bcir\?r`$:8>Xjoa`U=C:;Y{CT{i1L^lW`s=2V2NySTch7$"BA|a-i.S8.#~=]OmqeC+xdlc8B7u#A7h\N%x7q!N]kX:ejR`. RV.$`[x|5}9f;PQWjlWRg2qAgt8OXXVx[77-F9#,m{h #/n.~3spk5f>KOo(orIwuS}J3ao<jw(c51w ?Iw	kkdy E	#x1R$Lorm>}w?gr%[r#L-G]Igzj Syc51wZ 4.9{[$TN?)#a_% QSgr=9w QE8I!NE@-=$2'hl,-?DEQ'zl;(g>Kg>Fm#GlrVh[\U5_9~_"l_UE). ]z:Y`4"aY47@fUke{KA0^Z Ih-`hB?0:@8nwr7qsk)yt

wg}JG=rlty+&Vj%}1l=s}u`a7\tFu"0GZUQ.)ZNvu39>S9ymCJ~Y2jpoearI;u.%]e
e2PW.gG^k=}v^> !~(8p4"e7a4]v86:IxQf,d;3)eSy<#8]W8bT	XNZcs4oF@}k9-s[kc)b@ZIw+!t`1*VZ/Z.fJ<~2,.[~XF}z]%4IPZ.>:AMX#/it,rH&	-c9 QR++(3)%4X,s+maP"6f#YkEU .qA5^p
zlhfx~5HL~<NkQ&7{\hFrND8 <4.679xn/8@F9-GErsgR
8k4[^SR8`xdn[ep|+:7 9a{	}&p|J(r'zkM;T.#`0&NHvB[pdr6,!m%`U=$PF,Xm_S|D]O%ylFt/sb_
w2 DV9|?p*($s)M'8(;eSAlx}wq^$P	TQDLvg0fs R(I}NQDJaA["hc}x@e __ T@ _x~VeO N! |r[) _*?D w~q Q w k]N!?@??_><xwZHD~q Q w~^{ Sz^wu8F_~ZWs_-60Rm	xJ%"rEmC-J/}A0h^-wPC[B"U'fu5.uVI3gXnZC#e<.70w26b.s$hHD<\HYz  \\5o-g"d.vdK\A9V6assJ<F	&U..y;H<^zfnOG[
Q#kK}`0Ak&@8[N{KUlC+!l` ko(m<m">hZ!#EErDXcqNtBDu[[mJn+c$o-"Lb9j1Kr;+D[3MdBU8hgvk&pq*6 3UOHpNJk18:-7#%B.5VZ);TVw7",:Ry{)^j~ $3qK\r%DY#{'jLz;lA ke$&JN))+WbmnG
B@ICpI|001.R(p9eXk^Tqb8YIH)+f+7yb?ua.[iUu iFWo	)v[z-#{*.$L"-%`$sc1,R^fP@7yoN -lZo}>[66]%&"g[CtR%Cgu7xpp7I;1y>+Cved\B7B& 8DF,	6m8ZaHy-&hi	9xMf*GwTylw/"ePn.Rg4[\f^Ce{n& [_~ZZ7T2jVy[a_ARF_) _E _@??CT@ _)@  /A[+@E8Swtj S_ni~~q Q p<{N!}% .!  .1<;k58 XW} SN?(V'$S?@r{GlDn Zl6{M@V?D70KMOaH
;NOaH;?CppK|la_[cg5a{ZA&9=y);TG\Jg50BPijcg4 Oo)kje9pQq@]X};hkdgkhxY?"KrSdigkLNnl/RwP]XZ!7lcu+}
&r2 fWo/*,MnmLty yspKbGY g{ZlD\11t@pzXwKp[]Yyo ;p,j}R7w 6Iu^VDF6D#H9*H`DmP w*  j"N,7\Db6,r/b$f`R   k%.3^[Z'\r86rL7#ETt2{4o;+VE aL4o{
(IX#pWwKjb-kb\\ 3mD\ Z+/<z7a-DP\G+	7s\^tsH:h`jwrcKnZ<7e-6Yh[4_x#->ejj/b ,[y.-`c*b.OPQ5sF03"|[:`$b6qp$D/l]g$Zr 9)LfG6K%Gp3knhvnZ~kZ6d@8eL{mslR##;,jbZ4V-_D;67t7kSFI:S6h`@t_Ac ];L{PkVo\d3csq^26!u5O(U>4\j?:<{ss$(akQOQ8JYes]YRMj.6[e0 w+\b$YK*Xdc79aL%SevV Oi}&w+}?gLGfUhzrV0hg{t](dI(|7L@l|Vg$i,p^cg51oi~0ihagQ[wQw]#4&x7l6{M@,o,s^mOaH
vwI Xpr{DP52,b "jzG68 j(	=??>(GD{-?Eh "SWdM'z%Q Vbl}&(t8$mn;Al'UQ72;;<;:)_0/ nAtr.>@^e~lE*S276%eI#`nFBg0 e}0lnp"29f[F`f)&r4J{giS.Wjhl\9W.T\dNK!.69fzsIHIawbZ/! 6\-qmeua<;.H7[[8 0 1UI#;[`f<YoWh vk:B[f }]s4n"&^4 VTIzvga_+eL\P82 O3riN# ,%SmE~L6(m2].j*6dsNuARR ^Ky?{uZ:lGwMgDXbm7ieNDg naeqW+NXvg pl-ge`^m*hC2fN$#s~(:q"h
8LfYrU/fpqn(ZF)yR:B@q>Ze4lFm$/Fs;BL,X5nHi(,4^'GVl@Ve=V4&[^qR<\E 2b:6!k[e)4 m)P6A *L}D6/Yi9._LqG -ei{n5zg/
= \:zHO'!qVajnWz5Va4]=Sg+S:-r3kOkrAU`J23x$Q:.\:p[48h=6[ObEK.{Yd%q9\L7	n0r.0<u"_%IMvyH}ux!,M$r9xk<*.a})A+tjeSVy'^Ia%} Q_F)M4J(?U3@D>"G!DMqy 9w*yiEcqiD?~q} ??>+\X1Xy DMqy'!	$8[?~z+?~@f..ng =7#YT{,?3.lr@/Q10OFic@a9|?pQIfk#4(\aq2vJdgrrkL2H# xG`VkfeeF#&${014 oK\#!u+#$[d BT{;F(ib_- 7N*0w{6:hl`z0EKrN'XWC[	.4me4locG&~7)uu/<9-KI!,TlZ Inm*K9/`I$W=[&-FsXHIsMlGF/[U"7#^rml	zN<4jw@&6mR50.-%^RZpx #hY9=f\f|.MTATR>Aix*;9 E7J~a_9u#/2Foh:"JI[Tn>3cn<6-ah6qh09rWxg8$mJfT`v+sYn@%b=7Xw++Xis#nV&B)?iCmg z d ZjFQ^\p+JHKlV} rsGD`iACAZ%JDEbn,146-1	lGR` fUf7dv48,tl$aVFrrrD9#P4Vt Z3pB<2dUgr.4X@+"p{<GZ<h1zvaL<C@`Uxlv.kF. +'R	]D%r{H-/-
PLntS&"q=Kv8p
pwJ\ cx6	f{Z14\tBg@ZvC~%nsD3Y7%A,-6xHxQ^S=nX#qtS#U<T<.;M\5$@va> Nb|W%8~6|KCO5/+p\z MqF+9wMJ69 &<FicS?~}FicY!w =7#YT}NC]^# 1 (}N# 1 /A[$0FZ5^=7#F=YUxu[ :QE0|$0|$j(	$G1'~:({?C;!U?V "oKRG4QE>aDi.@0nVf.i oHfz|6"[2E`sG8ec6t04sdwmR#{ZzdZ\9BVKi`bs0pXS\\uDI4lvw-l K]#54egR8G PIu6i*=anFLw	l|`qAT"#ky9oS8nih58Yh%/_$",0kl7y#Pd:VEdm*N.mwPRRE]26+OmY[%]`Z\t/`70{u	aGZnA+2 5PSba)G2dbn`Hc"lM_Z2te=k".4cz,F
!4.{nr+K*2<ZEJ-n-%rZ sD}f&r]maJkn}%]Xb7JKda-|nl61tq. }^,WPNh{+OvEeyANO_>6$u.+g76KfMkXn"tbv\i/wkd&[R7r|/d&8F5tm{,bZKO
s`5@?n"KM"hr?ODU3XbQbZ;-pMcJX4\v*F0/QkgYY6naisJvm$1\q|.]%;\4$d@Mn{rbJ^umZLI$+[P%yprp_?E`I_;T^mR&Sd0HwbFP5tTPnhG>)}%U4 iz CM ?Dtu\9gV9Cr[x#'AQpsH$KESdq#;bU
H)+E
sr "]?rOo(TQD}%UGY"(W_X-[>D D 8 qiDN6bI1=vw 
{ JT@4h (-?*\ZvTpVbx'!:4.7<wz-?*qiMT@*X{\bSWd@1{ JT@0sg2oaLP)&p6hjB\iOM!~)0~}3^x"^S\u\[:n[ YXD3v9*XIRZC#dn%+lncr
`6*^z=Dy -|uZ_i:ef` y97!iIX	p9enT+t1@~z&kXl+9%ZT"CAuXJk]8kX[7E`C{v@44JcI':}G)@9Xz"3"LguBr!XebskuJI'nVb$e)B_Ltp-"Z{ixOZx)FI<9DX<f}GZ9c\i\1Lgo[ .&`_B#e/gk\5#=fMhzG/kb |7U-=[cepHMzS=Al9~ ][^},7va-waqU;Cpmdrt]5if<$L2L+sm9wcrm,EC[;Va?.nIk4sK(78z9 ]"vm\CuXy_%grc }J6/f#`F]o+h4FdksYZ4eVO^:+K-1<
69K7VAhK5fAR6Wbn`y++Om8=S1-m"{o
 Ex 7k<]rN.m
6nv+cS|}3Fc_{E[ k`|4LiTES.Fm	Dhj2~e]}<~p`WDFJEW27V[2Ky'2Bun^'`NJp!F#+-xkw/l-8*]1e<{\c r/$Wx=T{* q=Pt1\u; ZvT[O$akFxUi;n1jbxDU1I46aYiGPtFxV\ZvV	q06LG!E@D@mNq QD!Nz~~?}SQEvI==$2-:[<~Kg E@D$Sj/., ^6V:CLR+xcsnO&-=bpl#(9q kR@n\d="gd)#5Vm\ZM~f	.!]jKdfcApWc *%VZZ,]{U2rIq.6{lDQj"L"[vU5vE9AucexJF45H*FAvxS`H{i~euK@> KJ\$\L:=gr7.k^.~Dy,y [pb >9+Z:XiuVUoq6C`@'snc-+%
_b&B	pu906V`#/y"S@ega''ob#M~ab12PZ30tjGK}[M:E)Ag	o(jw|2c~Wn;1N'MeHM^}m8k$kRNwo;1MTKhid.^3 YwN2!q-.;{\+o"DV`.E45vyXgkb>eDl0:f-/V2Ic	k.q{fc	{"is%n_-VmC&'q;}}w%cZlI&4#y-^)m;G2Z y `^,FoZ/R{Ag\FEVNzV2c+v -b-=+KQ5rbK]F8CG)PMQ)#@.kWH$(iFmy
83iAv6Uo7$uQ{K8nxq<Ys/S:$e9(w.Q0q7[z_KRHffrn8E*l"]M4`!UcO|vp&"9/ )">Qe<B}|Yvp\{[RG$_J5 3{0t8/0wq^$W2%QE1/K;J(*'rRUi;QE(:#<~uDgn}xD!F=   Q hati@&/SSS[Jxc1sA B{Lj9>Iy
qyieDBI+E~)Oey0(RGN&{t7)a_@=)=,@o=*V+w8\KZUuY\+iq9(Z!>WAEHp\>,=GBzGk!\uEDAzvZUQGD^6%AmUnNMV=,65c r[\[ mn"hub-[$]@tNs7r2>KM'FN%Ohcs2CO n+6XA nUnzQ;MSl@7 fIyZ(@hXv=]y@h$\a^`q *C[1oR<)1NXv"ZM-l`]FhF8"/d?	xk!L?28	0+f!tp>.2W2!<{g9 "cC&S3Dr5NcEb$lp{Uq/qrvWP=@le,7{ /s|))#5 BN"upS8^'fu:YcfMqqm'>21x6I}Ad*FQ0A/F,dM;.*8 A6X-?q}(&&JCUp6;=QAt)F +],<\`K'Ezh#m,sFSG7$aH_FkBh$!}nL0Ah,w;cbV):
gY5md=GA{YYY\5zE,`nFD,#rzLl\e[sU4;F`.9'DkDr z:;>6F.c vAKN82*>U^;@s\A9V$T90bc(9[|h>$#st:#22dn,x a v&7L!oDJ'Uz3JI#x}&]bZN;--hz#+OI9ZXZ}Sn^@fBI(K7}]/6:gp_Lus	!#q ]k:/NzqJw*qJw+uSC=8E?z]?r  Q T34Gbc")hK;TRRD	]N-uN7Q>AJ  psMk}P(SN%7|&/Sm-ql(uN9[s|'OFN'#-  es BM<1<YEGJ0C}yD.dOAId.(|Vy0a?"vh]<L~'|	lUQ8zYxg|p.^"Sf8>,^|m)[`mU_M] j5SAe=atA.5Rgkz6_\%q.p(6gmHEW4gHapGY*5L^GcCMe56X\Ll\kdwpNveK&nNJKtQ+=ojQy6
lq=KCh"{E|-]i9o%/!Uh9Jsljp($|`Q-o,Z=tm7}u#ZeY{Tc~lA94hsGf:W.rIm.q\v`bcvZ5)'SrsKq?!l@[%<vvH8!b ,chY"@UVhlUmI&ey<W-v%Obqd/enCm-^*5&,D#`ghcm.7L$7|G6GpR |WSh*-k\\nQ8pHjSac6y*9h9up: ,X#c^3"0dSGfN.2]4XY%,2`A{%(iZGP#\
@5%\0_Wbd=!TRha-feaq58s6^]KjnB%M4 yLnp	/5m@Ss[z .ohf{= @/Hh^Eqi{WBGHnX`2^=T'px[qfs*Y &7+l3aa]m6.+kv[%+689Z5E.>Kd/F<2sSJ\R\3@+>n7E<h
[ AObkEfs'tt9,n2$HEGDlqOJp d8~8q>VD20'RizAg. 'D[N=	r$a\w=3'tQKA9-Yxi${nw[I+\p~TC:Ki~ wx[s4 J"xSM _4(K;T*y Janf w ry) w : ,K*)OJJo e[,(;3 /	 \/ Y)<1pF`Zvt9qgTtpZdq/f*4{&yvCxaV7p^Re"\mY\\TQWJHSQ,\y_3.7k3\;jx\,ZjeS6P^]x}8;AYI<3^mV<-}0A#:Yl4CT-`dc0,MN+<Lp Y-qPnI-kI{e|i#Mh{T@;p]!t rC*fhYk2YK1[8\ s~VyDgK2 &qk9[27=Ov07+c]4{/g=EgkEoYTJ6TTIi[Rd/eyg7P#l O>bKLmvq*H0n."%dUcb]4w#`	l<dfb[VwTES-\Vl87[4<18ad24,Fkx]vuVdXC~Y/^~py`VXF4j #9:<f>+f#;0p&x6mqcl-}\7,ar1nUY5$-`R<p(*saI5CpY3FR8[.&} +s)h>Xp8uI) e#[MuP%#|$joezTMv: 	m]tK\%td6}HM7x4;$)Ii$5+o+wUeb8sl%I?Fo6 3  X`fM;G;>ogUeh2,tWbosw+8pd`-oz[3t99fXMI-#,^	VV&i h8Wq!i836n!vD>^XSJi/Fy+!9=mln,-_72Xl XFU}.#.F~U/ 34QL:K#6G dX96U?Lg\ud6Ro^K\ex7!kI@.ASZA$b/#r;l`K4wq@Pgoa_E5sm	QEiI;1/@ 2w%)_F)@EQ 3XPtFxV=Bhc({b7(3M_2	cqc ]s}&@cV]n1@]3#_)f:G+K
L|e
SK!+V"`OzO,qp_+,OgG<o+Vv%1TC&aLNZ:+\G;,.Im@<4rACbyn}I=\RqgV5qmjJ[z<RC8|`JFs;][N0VAcxr?!m#CC[| eQG#:-3cgONy3L?J7hr12;MFCK#ulI l] 'z	pkME5PT<gStCn|q$N$}/ed! $q/} B.g H| ,c_{9G{.Jx\QoWt`#S@Df\]27=AZ9#scLfcZ3})etFo aV]m/ET0r6h
X];.={&\L`2^_l+Oc.{Pd96V2$UAl|7-5Q3v]ZshcVJX(.T?kA4DnFzY\]s{-Yq=!0cnlU#,q&fd\nn7HGeAG8IYhD\/\l&XWh<Cc[[5IRgo=r< \P99D
V27 G]FZ<y&$SHE$Xv%jVcq7ED=fF[:?RR:0f5gDEEr-Ts H `#E8H,sp7dDJHYF49r@;m"g7!_s<bPd<`jbiQoK`vm{U0fw#k^{Z[Z,uQB7\Aak*B~F zT\-F]pz4vf)r ^=9>2[D{W2@V;DbtP`jcAKUWt;;fZ4m6[:"Y,\]sKZFIeLVo#xQz9H/Sv,D(E[&M_0;<=\GqS&$G%:0AYSdZ9e24A"]8dqB>/@1/[0~P&)b%?7*p{bgWJQ={s3utaLDgn9hMcM_hcoz VNta7TQDGlM@x^m:v:V+fI[cecOc#q],fB`v_%9}7Bm	ZIa/o!`99qMQFE&5}x2.U3yFZ%x0!	X<X69E=WmK$4OQ
6)s<t#.&h:QmS6UEN#}sZu([u6Zwp,$sfQAd.4[3I})f!lu,t Z8H@Nr7&JV^5d`$4dHE{rmWc}c ;8B8,oVn##S!~pr^El:m pQZ) ?^+h
K[Slt\MDLxHcE.Fy7I4x2T\IML{?gY1Gg&S&'0,A!bQwgIjq#=KvlxXmTy7/	RnrS;Cq$N}Z'"(0AzV$Y0.-JX^p6~!%NYzY( un9-enFQvy`p.av:w"a	&z0Zr7D@+2_YD,0saiY!{{\E%`r`PdKk 7sEbi`XSSm{^x8]5NpU"pFu1py ]SM#ovKmc%mM6 7t3phZ7@I%8 F4dJ]W.ok2qMQ_;"07[`(.c'x0;-4TrNWVI`EAy.k:XHQ[wRJ[1	B-\#EuacZ@ db1 iWHFGsafV02g#sl=J~K7r2:Q[
SVD-69i }GR72iDay	niZ.(TnR e;s&~X.bF~E
s(vbm>}QEQwUIgzj(]K`o,OJOJAy)=D Ay+
&w/y#PSgr*iG_,3h9'#1!Lz^|W*vq_m _e;/L7+FZ[s%cG#dImvw/Wz	,{v J/?!^CP];hPeId5,=|9Y6*- \Fp9{7Qr_D$v T7^3a0\3.WKOJx/&,G:YpE-[g&FCU|tg5[)9wuaT<FRL-FmTbAj[2-Wu3&>M!d:irh`-u-l	2gb%Zny"jhYLfIcqn&a}U8QlScU+.w%+m-qpxsm+#madB:YT? d#^Hd/%pn`gu-,9-df
+=ZvS\@N6p\Y/_SZ[ f(L50j`3#\ tO^).dq7VJj##eO)`-aI'=|MWr>9 >[D|$VG2km.@;-$w_T/OmS?@ZQC( v+7{<:i|"MooP,wvUIlX|G5C.T961<jB-V"q604=F\aFy![znY/r_uTn?DmA+hb9UVs2&t ;%EKmb4UmFS/|Vh"97O]^h-D`av#7;*['X-7#=jA7i/Gt.3@YQ bpk.id1",o-vd%@q
 lv}HiAQ,n]mV+Hkjs^M+ ./h9%abR<rmcK=nG+n^M#i=%7!ms{2\ g:[) [Zy&o[o7N5e/Hrn/ewZ7_A3 bqfoe0(vIn-2F1i$-(]%?40T	Q9?z#sn+qN>v4= a 2N x< m1<1xpfvgwInS  SC;$EDgn;%fbXjhc(;3 (??>OOpQE
ZjM9pGm{xg
h)R=I5C@hmF:[<~%&>1|c^@	utt[ |18f,0h<n@CYA,7A<  nS/fnt&``c
|>X	#m@NIZv[G_~$U;u rtF{A]zn2o.YbC];<4c3Z6I&dstJeCgQvTFh\Yl eY<c{GZ19\uW${={* k	\+Bl*VUJYBpjhkK v"k^ex lL%F7-.}2Ig&q:%B^Z+GbxT,"D@WEm@,WGg q6thZTHTLoM3#^b6u[-;{xLeSDaqE\dEG#C{a|ag!d*qYNV 6fZW /qbbZf'mDFAc0/5Tiikb}_9Gh=@r *fisA (XE)p6#=m- p-!V1 4YV.CI1;xAR2Tiu;!jw4`s'1''ql`_Hv8A#4F/tWM8|$!\MQ~hV:N: 8u^@D
PBV5j Zc8_GxzJ*\g[@)<f[}%/eA}l6u^>OH:.2vok+2!VkA(6lWQK{YRi{faxmc%2sV;iXT3	eN#qXFq;&QvHTq$y<$Ud/nuCmuDX"y7;&X+THwV4U'o@w/BcNmLr%4mBsJi[sO,v|*s9hNmzwq[UQ;1/@ 2w%)_F)@EQ 3XPtFxV=BhcQDL6_4 /L6_4  Z(G1'~:qQIN(?@EDntQDC\6Sx`m=ICEXdbY;x'  6iK!\aY^Ggmj	W jVr2TB7:xl[YP,@DTi"}JD3n5=YrOin3U);-Tl*+ q84sbm^,z\9'+,ozqh-LopkIg:\u@-H#{DR1$~K* 9bw)>Lbj1g9"E;}FkjfG,lzVt`ZMEK4J23)2iq|-=im9 h3fF\]k'[;kH5eyZ3,0@z#:VKCp7=C/~fuBjap9,)W\^H@8E&16Kf'^I\f+bs
11b#a6)[nGNLR]	\hSX0mhFCM37,54Z:4It.cXZ_#o3%LoJ` XBLF\0k}W3F6^bi *b+-i}P]]dh''7L $"E5[Blzx:6A$[]|ts1<~iy.$f[VI\DtC@8MGK/IlV,a"mW	~K=/;\0d9D6fbmPJwr>F?]?5;lq[5iqXe5j0PfL&n[]JygP!3zIPl$gHQkE9Fa6siCI9#v>q0Z+E
s(vbm>}QEQwUIgzj(]K`o,OJOJ e!8~?SGUVc @N> v4	$VH I7Zq q)#Ow*}hT?o9fh L8~n@sLrQ3y ==P])\bq^RTV:hcX3?27@$-YFc,ik{67y'D,NL}3@]|8(3^f#7 C ^jf/eB:I]R]6&0J-uhg1-s:*b>huY%EqH#P@UBYvC,PDvZXaqz&>VdkE\h \C{hNj_x$1ch\F-C0XpRQ+r*x"+i|WS
7;r+d_	;Qm!_$7<7pR~Kb(2FCU7rs+47-XnK!<A9fRp8ihy Yl1#Yrns;vsu=[{l@*-~RL,][#Xwo^I$kY|4I',URMZ*1CV6%XW3HsFJAn9~"4/%(LZ|0Ur?UkL	/YKa{AqL\	rNclCDN2 +_c1q&-Zh<z^nU 4WLF" [r2m,H$A[6 ~p\:*uB$@	z<>bB,m< V@#H9|He9[,d.l6Rjl9wbMz)l9;"7_=`9gZA4X
7m3LbCDl'40nD1I{wa68X^V/;RG5qkh6RSP0;trwhUh;b2j).j|HX|;v-	n.NP(RF'9_11MXlWK4W)b\> 1|n^&3[@q=.|~VmVdbp%rl? *&B?mq ,MPfYo }jq2o,#q-.;2^ vwI [/i4,P(;3 (??>OOp(n'!;G@EKg`l (+4jTNU
vTJ@:\PkDPP74^0 +|J$d;P=h^	-3&9.UMF"Q,44Cm)sCP(vRp@h- Mx&$~,mg:i"F,jHykY/krjr1p"-nxv5I0  nd,_nW{  ExRrstSp $aR`$(2=AIX-Z2O@^I`e^H$en$^YZ"=SAd|+DK#m2,4ad^pc4@@z5\F:P]F,H"}xVl!KoDSN-\9}\v'L=b9Hk}Rz<k9 eEh[{Rz$3`\>seT5)MK4Nqbe [	6pvQCH-co$[FW)F'
y8w), \nz|L6)]S]z&C=`7q8\oklu x+QRlBGa}soq(+;*GS/1%Yiw[0:[AlpauA.]d7/K_&d.1Nb-f}[,NFS*\u/%#w  Uw f1i/*
r.j[Ug9\%p#MrF]d`^-hG_q%];WJ-}&
,vk;
geGag{m\PIvW::X77d.u*7pq]ib$uU7 '2p17u6Ami-7GR>$ 6!G]cBJrbZ"4d$n R_&H%$P&~1CX4TXI&\[LJ)"c9|_`&;3wQDU}N6w%( PtFxV
GC{^z'Q x2!nh4eOp3{R7)P#fc2	g
Ts|'p~`g	:Z'KmZ. ?@'fOmHP1.$a_@iCY4>$ T%eK-W!^sol" W fn/C(u!sLuNlA#],)iGY-I+B;]p!9j{u-R"su&NH7%ZFSP2H37	 t^vD9.7=Nk\ >~# ;TW%TX<mI{Z0-~4fsOeQ`-Xc	z{
'n5V&A:K6 3T@YLKs*TN1V<8:kmt d5"ZF jdp8D #kWUR2 &xAST%)");Fw&,Z'hkf _DL7(a.myNqN.Vtg/bk]( I&9k8G79/[#L$wvk%6	vmiqJ2"[sIouK!I&UFu5_UwU<Jv/Ic 7=A-Cbdpt-,9wgnlmH4Hvf.bE6c^SROfyErB[,gC04%s:	&(R$vZ'-hyU)4"L.Z2 z-0u9/}axg97Ke2}MCU:_Xy=[:M&-4g-H=<%ElZYC_s\vd75R&rmu)0F	2L`!%ame9KJ,-qWAxdPQ1"^(sZVlsQn4*9;958;r0<dFhht4'PRn(4pNoEOv	5FG(nDAM4c:^6^--K
A1`F/D;1Fy%"2T
qr\z3+LMq eQ|zouninz6 d;&q_=F>DFd:(8F |$a$d1Z-YpU6{J 
)3{R"(Ke!-.|~@CY4>$ THsrRot UK;T~ot TfO8Q =#;Y#84>%-Eg6Hcp{2iKQ;; QE0|$0|$j(	$G1'~:({?C;!U?V +'9h$dmK+\t`M=ke`oH`  !uRl.$,R)sb82
kaBE ,'M-RiM-\!M8[RTjnh}oEj` WAGI.jp/)::T]z$aaJqo8UX	Q&| 8gmZ`JvF0+r7lwMPn{2TmkpUvhQlbX8\|;If:/[<IVY#R9 ga]QCt3UT@vad 0s(Mx+S@i#LZD]k027<6(p^B&FRfHrE`&iU'^G<Z+p;hl3Bq^4w%u0}RRU	pnzIt8RnNILx$_"]i9ZH#Mc4md5#d \<I8[Q XGVk1D}	)<DoYN3)h>hOt{U|!|z413*"}Lpiz`,}4fX_,eG,6]& 6.5dvW5Hs,/AH,R2 4 ,*bI7!I:C#t:)sj?AIM]LC>Yn>oT	3kEw*|D%0C,mV\5	mZFX]t K:+C^,lo	0+"+EoQoV{,[c}9ki4R]H6k1	R sr:)\\!"&.anB^[U'fbJG :XNc$qd>7Qp',3B_gQDFl0lFI+^-1]_	ndk5QE%l<(1c;I.Pe+/	SWF2DCGqAbZj'rhxR61](s9mK;ru3K8 )G`H|ATdYHV9QE.|~LR (j>*,MPE@+o,-E"vwI C"vwI @ONd@OvfPSgrv~)goDLG7[p{'/8@ONd@<@yq'!C%oA@OwH*4O)2Jrtr#)V9gS54{ur2drxcH*I_%&E
P=q{U.E'a69vvDEJD|Q ^K@#!$	<c*\yHwHF#q&f7v:#csvuGfs:qv[
Qq|6c/k|s`{y2no _.c1BalLkNyIhC Z04G| `R ppehfVyl"iexZCMlJzkC..;RXN$Kf[ULM{7b3r9:t '{RR0L:w1\Ea; _]}VM%g^S~)sn+Z aB~GHo 53w(EhFc\z4N@4w^N [cajL.p~M"CK_Fl\IE:A2Kbj\rz8KkZah9^Ml6v@_ .L:w\fFd/Ak.w# 7ezKtnjHx4vpt-?&E<J^goFkqOeLj;N(%J)di4~M\0Yq[*6,.q,"K22e|)c3m/v*PrrrYj3#TWw#yeI_-lLjXT?`a uN47q:B ^]g0Sj5-1Oq ZKZ@D@7X{S8]GFl.NG)ssV&;7q',C\pzEi*
q<+&jsv`R6vC50jM
'%4-ns_-<Ji+,f*9}W<M6wZfu4o|)lP=p7*4;0b}"?5eU+F*k5iE5L,n<H!}hQ2h6qq:|nfBz0 Lt 1L:Jj\Tqcsl=(eo..g6'.M[_]q*GfK+8=4f3D/$U;?[| ;?[|1L2L.pHfsn'|p{' Y c94?H'rR'%8mC(c1F&][5Dgn5Ie4fXyG!E""9w"8?SMIkr; [Jw
qJw!NFY q7O>E7O>EN7O>E &'!u1NaYJw=)?E8Gh",otHsAqr3|ZNZ^/Z:LW<Z@jX^7)Pq YU)#2aJI" 2-Q	.yihUXiIelf[Q\Z'4ss!%/$Wj$s;F7B(kmiES;RmY2vtR9D.c<4;7;;V:H~eSW%?SCQ#pqth6#C}i.{\sD\I+cSlZ8[z\KH6^(]qY!AG)  j[7 X F5sl=m=mnRvh(2y\cS5k FH30@NrP2@}`|;.k]}! $wFK|4q}r=s3	{ZdxVi>!y(%{'-3#Y$7YEGI</FBCw*R@ccGjB;;'xm0w/5 8X^xxY5dKAjA'2vGsFPM&o;f;U%<g|90%[+`"`5cXff	@yPlR*M_+[@bP(qULZxot~g"u471kBcH	8n@mb6VN_\#'_ h} iFp'ul'lC5_Om!\.B\UE86%6sZ OZ6z^Gn0 ]HEkAv,W8^c-D_Vf\l.3XHsU9gb$w_Y$s]IEi/`o	eU+/d:'dsNakB9\Acb)D,I;ij;##b,.mKXqW>um#	k6Fq ]H4*k!	@)vM#	|7~*Xy Q5nWVW(,SAW{cn\mYDC*ix)8k7fS2(2fu GYg)eSx bn7O>EvNmcZ&;3w^)QaJFcq7\(tTtPw%)4n7b{BqJw[Jw
qJwh:#<~t,MWa{u"z17O>EgQ#*"1q;[ZTQ?K?@ )QINTs|'"(g0(>^)gr	N7(PgG;jnKA\h_!*{	%q3=`iQWh)3	=%esHlO%Rnlhq6.rVukA{,it]An#rUrvdHWV:Yj` sY-X\CwbvI uER.pP	9'".q[!ip%6c9S$fi~^4-hl|!5+GWmXei 8aWaH$YBhE5NGjH,crh^{B Fj!zan#Voq ha,IYhnmEGma^hA#<WFKGmXxhdn2\Qpo\#+EzQFiv>K]Y{f!ps4{k_k nE]v8s'$naUg::6%JRN"1Ut#^Y8*VP^bfmF.	*0Jk52it=\8^>_5fYd3F-XQ0JkZ -;Ti**C,l^kfu2^fJ3-d{a4}rvXv&7yPq<ky,F==
sxsubUPif#`Z~kur
XC#KHbg C\~<95kQL!%ee6uL#%Rw`ZNE h".9uL' HVhk]vgpkWKF+Db qU:K<[xAIkn  [$U8F y$ s\pg@wC$08|,I6vm 4#Pli!]DH1nn-,;Pv+7]k%iui#._  ,jH=iNScblPO#NM~I[W !H&$R[g}hbKM=kFrGfnS$y"2t{6
q:4H_#-/]HsO9jc6'z15WZbm.k%9u`GsI#$.qv}Hx	!?j6&?+zf]MN)qdVgUY2Q.|~@
 6,MR>QD o_X "'gt2'gt &^t%8>H	->HZ	 3?rfx:bOuSX</oB7N/o=yD%r>D<fxWhmxwjQr9*U'+A
eDph'z6Md,W%}"90Ipz n<|!s%:Zgv]/+NE_kPT_+W*?ldn+q7u]sqHU_gAkj4\-</~6sSS4c@cX/	"rM{.yg<{Oh9_24_a 4P+\C;}y4.A6quU%QWdfyem	j6ZH#Jn=l[O1X{YmHs!rVQd'hfZUun-NG{ WU_}]3Z1X[% }n~.u/Cb` X-a;}#W7nm RL5rVW,NJT+!4.014u&\Hdx"7x^uU Rh=MW\#$DrVb=5GJ1::p!$[{Vd7,cy|8or5Lv<aIK{T$" b$ x TI[SiSP[^IsF;|?ySH/d#E_'s` X'bTt,.';X74AEPrkD,.sr Rd:Z\u,%$#<;ze}JICMUREZm8]I!|7k([ap./`xum'1{y ou|D#Z&4k;^A NF[nOz$a<esF'R7*I3~a 8\er!>ylx2
jYtyyZcr-qfs_Kcxs;Asw, AEdSjc)kFr-v
T%b
:qbN#@3#:]btTx/$^_U{G5:`w([r k8tbU0..kx9oTE3je >Y#k/QFK>>J2h22q9u2Kl58$XOs[:)bv({[aGV@a\dtXM d#gE(z!6`urHvs9o{&3{Uu#RYIm[elf<udh9wdkbpIo7;)+vHpo.$4GRm{]KNa1kesjBh|A5/-i"6KYD9 .|~Yqtm_0puzM>Jqx}|K;UG.{2 h3 (3 -_X&TX$q^/oB'gtw7cT	|Mup)E@D@mNq QD!Nz~~?}SQEvI==$2-:[<~Kg k
4X[rDJjLSWd@d 	w\R6R3(M 3uK*d5 h$%8HbwHEZ-4Q9 JETWUi7LqV-lqC+{/	5[c6N1l8'D# pRL|HV I"sMj6 :dV<HH\.N6Ft0Q%x9,F5GqHOzIk9xkd#
1W,sz5hiRt}2*18z,6Uke`O2vAbzg$6+Gv6"v6_>pVF:t	4. s|y=bFD^D.EW\$mLqvh1fz y S	;/rHQ o1&KR2o2mn/ QxDX+$kyGUWTbvgX70vI3Mowp^8zt5EC-0^;N$c ^#Md 'w$YvjF8 a:_Evn`w)TW>f8})F'\\FNfA_]34l{6uY$_:%`mrdT;Eq=3-ss(]Jd$!D=|/zXX!-}s!{a "<nw,?I<d CvYl7td%hsM)YMZ#wnE:*zm[k}`2khq8-^)!%svnKA5qi)&:,t#oO/`7)]M2uR8r{i]49L2;}rrz;3ID&u.$sK9H\.U8G^HE8/}w)k<K6]!kKkvE.;XlF4_@B:(DnCwA8G2	\_^cZ-<09:W:jX^@;B#lE*XFRfvw]?,"Yp&|h7-A8-<})mrS6VfPNysq$[=m:.o34*jkCPG,w@]a-d/Wsn+`a%} Q_F)M4J(?U3@D>"GT/\VrYdL6_4 g3{L?b{i$W9069/?D C~q}.Q l:4dZqy0(#73+G'HDN= !_?TD= !M$305i/F@fE8<(YH <zeCSi.@1/zeCK@kWI)2R-\.hIy.N2j'C\e\J|FugJ;gM\9Y#kf1Du[W$xn	i:<8ICKoRXrmd`6t1#0tSa!iXZYcF8A:##EA3O 1t;.)6
" yci4G"zg93*dsX-6e\QCvnQikaXuj{9	.\L\f [#nJ6TJfb7.o*+#m14geLM.]QiDk-F}m Hq&WalH^UF46nt_3~Gp'yd;)eu-Cx(%g21 g?)Qfqu~\	$:o@"v.,(wD,hBAfFjm as|GD\
pnG5H[#v_F(h '\~gL^S[}TNczI)/;&I{tTkq	j`	*]?~3/H41iS4F8NJQMPI,WiqD`l 6Az#[eRm|DfkFlIsB5-kXBYl.kq M# dYrjJ=R,&d'`Wf.eY=&rD4;c>QPx&`/r_j`jA/ze/Ss	gw{T8>y3PHa8@9ML?m|wCUM,45W<N,yi5=A|X70s3K\8RJe;a=23M"ejAI6v=%DB{<tvPOi>Avd3+ffCcqb$M[-tN&\[Og1IiUE#\ fkL}PW=~"Y_,]2vLN7Uq$qqXlY@?tt<R{"ID-qu1KT?!KYy#3qy1Q 3Hmqrt rFOo(>RRa`pscfEIgzj]fE8<9LLV/@1/OJ eQ?K?@ )QINTs|'"(g0(>a_[+#>j(&?(Mz<
EQ .}\>ao2_=5Rs+s`.:4{p95}=X:#pYn=Ji 12p,N%V<i"-J[/!]!u@tkLXOz!m{3IWk!~>8nP8(rVR+ABI/_h8J3\ik+mg]p.&Ua{|s]E$z6 c	mrIl=)-`}D*1SI)JBm?1TGGawW0u-hQ:[CrH}
 _Lbhla@Wt}/{f
('gt-' %2@EQ ?UEz~OUw3eQD)x <YN?	UUx{N6>IbMBqZkv\|= Ie2589q5-V+;f{2,uFn:v FN0vZkLW[v!cU0xGkQ{lYk<.gR*8>.2y`o5hA<cg8G7+l5aUfo8\-h,nIi6kia'#miY5U%#.?,gm6ff
(fwYmn9[9yjPD6'b<BC{Gk!6_bx1">W7rg8}148wVREiL^6dYwM/g0IHRF cg0{i	06 {y)z?	@"\> : m>})v UQIgzjQw }z ;; ;; o<dy/T@yAm"Za%nG 68 LoX<`\7[$T#L-GD@whc58D!-?D<-G[%0I]S*)2w) mj rIw~#/LPao<km%eh$mC[.68\nAdu7;Ynp6+JGS53\Y '4m"20H~\}qmLm[FZzK!CKYX4qR12Ihibu} SO'k_vDcNlG%L8%X<nYnFbvA*'sG'uQ<}$_}GE3]<IclI2jxVWhR=4LO-;Y@3W5sK>32Jv5"ul<tI]/N'7weD\.siDgo9[%0KinF0c4hcwUDx 0FH#VEt[$.<"{Sgz ,o7nUQloao<T#Qi<sr:.cnrl.s]FW).YLT+p8mC#6%QE -f%crw/$x!P\o|n9i)]kYy${>ZWE \,-d5oQEv#X2~g'Qnnls0=nZpiA5xL):-vECQ4h3cgm
jFh.,&bqqtE#q+A#;bKm+yY|orKW0Jao< <dy%=#NNi9w mjc5Ul]bZ0H=O5#x1RNm yT@[yw*]%} -G[%  m+ mi_F)@[yT@4.9{[%Dgn}a=
  S kd3[ ke0  N!SC &,aq 5D~q h6,C[txCu{5D~q 5)2wx P <k 
! b&_ Sz ke~$RZ<htfq rG,rU-d)k	Sc JZAg@C-k`:',k{o6V8-bw33B}F%mWJZKUM,s]D*/oH:Y ZuzG;[kLWuE,oB`\-SdF?VC('"%>^IhGQp|O)d\.@ `}K%?#~G39]!+ij  puxp[6[oAUpou[7C	<~Y3nA?mO0WQ]r\'@C%C??3 N1<;k4  S kdG#n98po TGq WAq<X97  / jjsl^q .<0]  N! h.!  / b ^ k[;?h]F;xr0).d}Jq#.8pGjc>,1/ogv`9\M|F@n^u?U&k-og1$l \k!87Xo\UF{J\,VrI8ul lxE@!	'``~Zl4Ur6w-2C}2c u=Df ?k%n }0]5}#}l*+-\2<a'JyKXaq54rOB
uYquX26}icSr]J+ft|'hP _k/	~MoENNr?_/ORi9wg~GkQ??C&?kN?$P|_(+qe|H TGq  S;N!8[* \_) _ 'rR<cpa{)?? C??j8`}{~PG  /N~{QE0|$0|$j(	$G1'~:({?C;!U?V "oKRG4QE>a}\(=A^3Am_-? Qh|A9IY (YK}^h?rJ[QwV}%(%u-D+o 0QE %; H s|GQ#6_Fl] z("v "Eli CfO3A`~k?)&Uyb^8R\#acb;[ fTQi91TNNA	5:@lS*zPe^EiykHN7\1;<=d=7J!c,R_M4ScJ]{hy/y[]7C[<ARvzmZw(w#^,4Wj}!3dFaxinD<&!IxxKgCeKem 9ELT7/KWd{vSM]1k	c1T2hDL=WEK$S6unVqIMF}[ii@RQXNuB]={V=.mgNd)B,34QEH:g;T@z  QW~?d
+E
s(vbm>}QEQwUIgzj(]K`o,OJOJOaJpr{NT@&7-=vw ijcg4Dyp$_*8@&'$D $6&#=G@:ikLMZw	9=y&k``$R'z6{MS= \ 3qh3P3w	7'%89=y'* (44rklI;Y =6/l(O >OaJpr{NT@(486{MROQ%@:ijcg4D{@pyCpr{Ga"	9=y-i0 u!4YUi;cg51oJ6{MKkTi 0;Dg wwcL1ohcl6{MIT@k;fyqj~b?}	9=y"p,sH/=|UoO;U;@&OaI FN{KtLb o6mM %|"i6x;
eCfl9-am"XG;Ka!-[#b6qV^GHh?jhLOoI]uK<_/0`8p0B;5BZ;-ad2osUhQ@z/#_},p!6$H ,zU:ZEHd~NzNokUk!g ]'yA&/1,~^C	}f[jG >?g\6|7=IQ;:+i >QU:wBl&57!&OjNMFbfPQm!?$a7 [8Lo'%89=y'*.pr{MPY&wy@8ijcg4DHx9VRw3eS@&$i,pucg51oJ6{M@m _0,=a  '$DF9.i HLoIcg51oJ /sZH6'$3@&k=EdY1C{ QSgr=9w QE8I!NE@-=$2'hl,-?DEQ'zl;(g>fs~1@EQ NqUZNqU+t
;eS5E@y'6Rsn)*(;3w.})U}NIR "iAJJuQ >%% S#OG 6bjsl@  "v'hQD;heFm''4nu~l)ZFK-#M(ir0<y\gY1Y^'k{ o)nAGWPTIK"GCDHqEJ2zae_zqMb~}hah/#i =2<F:\asn4 F6|PTiG+.GeXHyQ[e<Ek=;.LN8h=y&5<ye2+a5+mr7hEm}!imFP49A T04]<Q}B0L0Rn Js, p0<uC,S&	t[ty{_";C-^hY+xk**('4rI;* _P[+tj/$W9wUQ;1/@ 2w%)_F)@EQ 3XPtFxV=BhcqyN=7#T@YUM.E
0|$FicS?~:8ekK!sK=7#9>IqyN=7#T@-`BC\>0( FicUS0qst<
  ^=7#YT*<m4sLG10OFicE(
XxX$<?|zoeG[>a<gP (.}z8>g;x>/+p\z 5@gYU8<Q [k%{Yg?~|A9@a?E8>Q 7pQ AZ *qyM* =7#2BdmmGY/?~q} ^# 1,0FZ4zW_@_Mqy
 u[ :8>' %2@a?E8>Q rDZp^qyaQ =7#"qe71~^# 1)a?DRx>{,?b 
{,?zoeGB66_-ia
li - Yas9>BFeRi?E	MS'	;G+cLs\%Sb.{	KCO!F`v5>Le>	<[g:2e[<-B;fDA146llk$k 9\*}<=R>ku}QP8(5~M[Z"FN>;aXl\(hDoKhVl,mNmjYAp6k2WJpa>6lY$s|f ]ja``Xc?F I3dz(F#|?}`<qM>h,k{cg6u\qfN>;SoLDq_[j?Lk7o*k\HMG5?ob 6mYiqX?G}MaVOq-No'xaYU8<Qk2qyow(9@a?E8>Q r >=7#6~\zoeG^W0qYFicS?~}g,@F.VHi~8<gP eKxU}% ^# 1)a?DR $0FZ5^=7#W}<w 'T'gt -eaH^-?(2)C	7@A5jbOtY|Nc^x1QmeN-?(vF{!G+75? Ytq9 E81Mz4
]eXYq=T{2|~/K
6x!!H^-?(T[qiSO=AY	 #A
q=P~1jF *-e\> lkd nQbx,q=P>}Qt1\ux1[Qwe^#HI@2Qe SA+o#:gIq0w QmeN-?( %	q06E=P{ @,Q,W=%$x1Fl]ceoF9q@A5Hq=R-?(T[qiSO ?E"9Mbx	*=Ue'5:Zn-?*qi@b;O.pP zGvt34o(v&9N1jbxIIa{=#ku3<py:}"FM6>-?*+\`B`rRo,y ;OZvTO)m1EK6aBc&sE;T.}Asg2oa^OZvPLrWe0 F{ @@`yxo{nCi@b:-8YO3^ ({ @jm>}8Z:yC:,MRxdf#Z5% @jA5 K`ItGrON?*ZvV	q06@0QE=vw#Sgr 5Qz~~?}STQDOpC"vI=zoA@4QE)2wM_I(+fs~1Kg>QE	UUUP@W<>TQDz)*u'6"(c9|_`Ba"eWZ4*(&?T47QE{X{X(?1>+"jslF 6 
('i"v( ;hO??>
(%G%GE@oAMh(M_Id2w9|?pEl} I;)4( O5F"OQzwq@%QE1/K;J(*'rRUi;QE(:#<~uDgn}xD!F==== ./backend/public/index.php ===
<?php
// backend/public/index.php

error_reporting(E_ALL);
ini_set('display_errors', 1);

use Slim\Factory\AppFactory;
use DI\Container;
use PawPath\api\AuthController;
use PawPath\api\ShelterController;
use PawPath\api\PetController;
use PawPath\api\QuizController;
use PawPath\api\AdoptionController;
use PawPath\api\AdminController;
use PawPath\middleware\AuthMiddleware;
use PawPath\middleware\RoleMiddleware;
use PawPath\api\BlogController;
use PawPath\api\ProductController;
use PawPath\api\UserProfileController;

require __DIR__ . '/../vendor/autoload.php';

// Create Container
$container = new Container();
AppFactory::setContainer($container);

// Create App
$app = AppFactory::create();

// Add body parsing middleware
$app->addBodyParsingMiddleware();

// Add error middleware
$app->addErrorMiddleware(true, true, true);

// Public routes
$app->post('/api/auth/register', function ($request, $response) {
    $controller = new AuthController();
    return $controller->register($request, $response);
});

$app->post('/api/auth/login', function ($request, $response) {
    $controller = new AuthController();
    return $controller->login($request, $response);
});

// Email verification routes
$app->post('/api/auth/verify-email', function ($request, $response) {
    $controller = new AuthController();
    return $controller->verifyEmail($request, $response);
});

$app->post('/api/auth/resend-verification', function ($request, $response) {
    $controller = new AuthController();
    return $controller->resendVerification($request, $response);
})->add(new AuthMiddleware());

// Protected routes group
$app->group('/api', function ($group) {

    $group->get('/auth/me', function ($request, $response) {
        $controller = new AuthController();
        return $controller->getCurrentUser($request, $response);
    });

    // User Profile routes
    $group->get('/profile', function ($request, $response) {
        $controller = new UserProfileController();
        return $controller->getProfile($request, $response);
    });

    $group->put('/profile', function ($request, $response) {
        $controller = new UserProfileController();
        return $controller->updateProfile($request, $response);
    });

    // Quiz routes
    $group->get('/quiz/start', function ($request, $response) {
        $controller = new QuizController();
        return $controller->startQuiz($request, $response);
    });
    
    $group->post('/quiz/submit', function ($request, $response) {
        $controller = new QuizController();
        return $controller->submitQuiz($request, $response);
    });
    
    $group->get('/quiz/history', function ($request, $response) {
        $controller = new QuizController();
        return $controller->getQuizHistory($request, $response);
    });
    
    $group->get('/quiz/{id}', function ($request, $response, $args) {
        $controller = new QuizController();
        return $controller->getQuizResult($request, $response, $args);
    });

    // Admin routes
    $group->get('/admin/stats', function ($request, $response) {
        $controller = new AdminController();
        return $controller->getStats($request, $response);
    })->add(new RoleMiddleware('admin'));

    $group->get('/admin/users', function ($request, $response) {
        $controller = new AdminController();
        return $controller->listUsers($request, $response);
    })->add(new RoleMiddleware('admin'));

    $group->put('/admin/users/{id}/role', function ($request, $response, $args) {
        $controller = new AdminController();
        return $controller->updateUserRole($request, $response, $args);
    })->add(new RoleMiddleware('admin'));

    $group->put('/admin/users/{id}/status', function ($request, $response, $args) {
        $controller = new AdminController();
        return $controller->updateUserStatus($request, $response, $args);
    })->add(new RoleMiddleware('admin'));

    $group->post('/admin/users/{id}/resend-verification', function ($request, $response, $args) {
        $controller = new AdminController();
        return $controller->resendVerification($request, $response, $args);
    })->add(new RoleMiddleware('admin'));

    // Admin shelter routes
    $group->get('/admin/shelters', function ($request, $response) {
        $controller = new AdminController();
        return $controller->listShelters($request, $response);
    })->add(new RoleMiddleware('admin'));

    $group->post('/admin/shelters', function ($request, $response) {
        $controller = new AdminController();
        return $controller->createShelter($request, $response);
    })->add(new RoleMiddleware('admin'));

    $group->get('/admin/shelters/{id}', function ($request, $response, $args) {
        $controller = new AdminController();
        return $controller->getShelter($request, $response, $args);
    })->add(new RoleMiddleware('admin'));

    $group->put('/admin/shelters/{id}', function ($request, $response, $args) {
        $controller = new AdminController();
        return $controller->updateShelter($request, $response, $args);
    })->add(new RoleMiddleware('admin'));

    $group->delete('/admin/shelters/{id}', function ($request, $response, $args) {
        $controller = new AdminController();
        return $controller->deleteShelter($request, $response, $args);
    })->add(new RoleMiddleware('admin'));
    
    // Shelter routes
    $group->post('/shelters', function ($request, $response) {
        $controller = new ShelterController();
        return $controller->createShelter($request, $response);
    });
    
    $group->get('/shelters', function ($request, $response) {
        $controller = new ShelterController();
        return $controller->listShelters($request, $response);
    });
    
    $group->get('/shelters/{id}', function ($request, $response, $args) {
        $controller = new ShelterController();
        return $controller->getShelter($request, $response, $args);
    });
    
    $group->put('/shelters/{id}', function ($request, $response, $args) {
        $controller = new ShelterController();
        return $controller->updateShelter($request, $response, $args);
    });
    
    $group->delete('/shelters/{id}', function ($request, $response, $args) {
        $controller = new ShelterController();
        return $controller->deleteShelter($request, $response, $args);
    });
    
    // Pet routes
    $group->post('/pets', function ($request, $response) {
        $controller = new PetController();
        return $controller->createPet($request, $response);
    });
    
    $group->get('/pets', function ($request, $response) {
        $controller = new PetController();
        return $controller->listPets($request, $response);
    });
    
    $group->get('/pets/{id}', function ($request, $response, $args) {
        $controller = new PetController();
        return $controller->getPet($request, $response, $args);
    });
    
    $group->put('/pets/{id}', function ($request, $response, $args) {
        $controller = new PetController();
        return $controller->updatePet($request, $response, $args);
    });
    
    $group->delete('/pets/{id}', function ($request, $response, $args) {
        $controller = new PetController();
        return $controller->deletePet($request, $response, $args);
    });
    
    // Pet trait routes
    $group->post('/pet-traits', function ($request, $response) {
        $controller = new PetController();
        return $controller->createTrait($request, $response);
    });
    
    $group->get('/pet-traits', function ($request, $response) {
        $controller = new PetController();
        return $controller->listTraits($request, $response);
    });

    $group->get('/pets/{id}/favorite', function ($request, $response, $args) {
        $userId = $request->getAttribute('user_id');
        $petId = (int) $args['id'];
        $service = new \PawPath\services\FavoriteService();
        
        try {
            $isFavorited = $service->isFavorited($userId, $petId);
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => ['is_favorited' => $isFavorited]
            ]));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    });

    // Add a pet to favorites
    $group->post('/pets/{id}/favorite', function ($request, $response, $args) {
        $userId = $request->getAttribute('user_id');
        $petId = (int) $args['id'];
        $service = new \PawPath\services\FavoriteService();
        
        try {
            $result = $service->addFavorite($userId, $petId);
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => $result
            ]));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    });

    // Remove a pet from favorites
    $group->delete('/pets/{id}/favorite', function ($request, $response, $args) {
        $userId = $request->getAttribute('user_id');
        $petId = (int) $args['id'];
        $service = new \PawPath\services\FavoriteService();
        
        try {
            $result = $service->removeFavorite($userId, $petId);
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => ['removed' => $result]
            ]));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    });

    // Get user's favorited pets
    $group->get('/favorites', function ($request, $response) {
        $userId = $request->getAttribute('user_id');
        $service = new \PawPath\services\FavoriteService();
        
        try {
            $favorites = $service->getUserFavorites($userId);
            $response->getBody()->write(json_encode([
                'success' => true,
                'data' => $favorites
            ]));
            return $response->withHeader('Content-Type', 'application/json');
        } catch (\Exception $e) {
            $response->getBody()->write(json_encode([
                'success' => false,
                'error' => $e->getMessage()
            ]));
            return $response->withHeader('Content-Type', 'application/json')
                           ->withStatus(400);
        }
    });

    $group->post('/pets/{id}/images', function ($request, $response, $args) {
        $controller = new PetController();
        return $controller->uploadImages($request, $response, $args);
    });

    $group->delete('/pets/{id}/images/{imageId}', function ($request, $response, $args) {
        $controller = new PetController();
        return $controller->deleteImage($request, $response, $args);
    });

    $group->put('/pets/{id}/images/{imageId}/primary', function ($request, $response, $args) {
        $controller = new PetController();
        return $controller->setPrimaryImage($request, $response, $args);
    });
    
    // Adoption Application routes
    $group->post('/adoptions', function ($request, $response) {
        $controller = new AdoptionController();
        return $controller->submitApplication($request, $response);
    });
    
    $group->get('/adoptions/user', function ($request, $response) {
        $controller = new AdoptionController();
        return $controller->getUserApplications($request, $response);
    });
    
    $group->get('/adoptions/shelter/{shelter_id}', function ($request, $response, $args) {
        $controller = new AdoptionController();
        return $controller->getShelterApplications($request, $response, $args);
    });
    
    $group->get('/adoptions/pet/{pet_id}', function ($request, $response, $args) {
        $controller = new AdoptionController();
        return $controller->getPetApplications($request, $response, $args);
    });
    
    $group->get('/adoptions/{id}', function ($request, $response, $args) {
        $controller = new AdoptionController();
        return $controller->getApplication($request, $response, $args);
    });
    
    $group->put('/adoptions/{id}/status', function ($request, $response, $args) {
        $controller = new AdoptionController();
        return $controller->updateApplicationStatus($request, $response, $args);
    });

    // Blog routes
    $group->post('/blog/posts', function ($request, $response) {
        $controller = new BlogController();
        return $controller->createPost($request, $response);
    });

    $group->get('/blog/posts', function ($request, $response) {
        $controller = new BlogController();
        return $controller->listPosts($request, $response);
    });

    $group->get('/blog/posts/{id}', function ($request, $response, $args) {
        $controller = new BlogController();
        return $controller->getPost($request, $response, $args);
    });

    $group->put('/blog/posts/{id}', function ($request, $response, $args) {
        $controller = new BlogController();
        return $controller->updatePost($request, $response, $args);
    });

    $group->delete('/blog/posts/{id}', function ($request, $response, $args) {
        $controller = new BlogController();
        return $controller->deletePost($request, $response, $args);
    });

    // Product routes
    $group->post('/products', function ($request, $response) {
        $controller = new ProductController();
        return $controller->createProduct($request, $response);
    });

    $group->get('/products', function ($request, $response) {
        $controller = new ProductController();
        return $controller->listProducts($request, $response);
    });

    $group->get('/products/{id}', function ($request, $response, $args) {
        $controller = new ProductController();
        return $controller->getProduct($request, $response, $args);
    });

    $group->put('/products/{id}', function ($request, $response, $args) {
        $controller = new ProductController();
        return $controller->updateProduct($request, $response, $args);
    });

    $group->delete('/products/{id}', function ($request, $response, $args) {
        $controller = new ProductController();
        return $controller->deleteProduct($request, $response, $args);
    });

})->add(new AuthMiddleware());

// Run the app
$app->run();
=== ./backend/public/.htaccess ===
RewriteEngine On

# If the request is for an actual file or directory, serve it directly
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Serve images from uploads directory
RewriteRule ^uploads/(.*)$ uploads/$1 [L]

# Route all other requests to index.php
RewriteRule ^ index.php [QSA,L]
=== ./backend/database/migrations/01_enhance_user_system.sql ===
-- Enhance User table
ALTER TABLE User 
ADD COLUMN role ENUM('adopter', 'shelter_staff', 'admin') NOT NULL DEFAULT 'adopter',
ADD COLUMN email_verified_at TIMESTAMP NULL,
ADD COLUMN account_status ENUM('pending', 'active', 'suspended') DEFAULT 'pending',
ADD COLUMN last_login TIMESTAMP NULL,
ADD COLUMN email_verification_token VARCHAR(100) NULL,
ADD COLUMN email_token_expires_at TIMESTAMP NULL;

-- Create UserProfile table
CREATE TABLE UserProfile (
    profile_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    phone VARCHAR(20),
    address TEXT,
    city VARCHAR(100),
    state VARCHAR(50),
    zip_code VARCHAR(20),
    housing_type ENUM('house', 'apartment', 'condo', 'other'),
    has_yard BOOLEAN,
    other_pets TEXT,
    household_members INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES User(user_id) ON DELETE CASCADE,
    INDEX idx_user_profile (user_id)
);

-- Create PasswordReset table
CREATE TABLE PasswordReset (
    reset_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    token VARCHAR(100) NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    used BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES User(user_id) ON DELETE CASCADE,
    INDEX idx_token (token),
    INDEX idx_user_reset (user_id, used)
);

-- Add indexes for performance
ALTER TABLE User
ADD INDEX idx_email (email),
ADD INDEX idx_status (account_status),
ADD INDEX idx_role (role);
=== ./backend/.env ===
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=pawpath
DB_USERNAME=root
DB_PASSWORD=Michael369!
APP_ENV=development
APP_DEBUG=true
APP_KEY=base64:VeryLongRandomStringForTesting123456789

# If you're using JWT for authentication
JWT_SECRET=AnotherRandomStringForJwtTesting123456789
IMAGE_UPLOAD_PATH=/home/woodmtaylor/pawpath-pet-adoption/backend/public/uploads/images
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=woodmtaylor@gmail.com
MAIL_PASSWORD="sitb myrd ekcg bwbi"
MAIL_FROM_ADDRESS=noreply@pawpath.com
MAIL_FROM_NAME="PawPath"
APP_URL=http://localhost:5173

=== ./backend/.env.example ===
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=pawpath
DB_USERNAME=root
DB_PASSWORD=

APP_ENV=development
APP_DEBUG=true
APP_KEY=base64:your-secret-key-here

# If you're using JWT for authentication
JWT_SECRET=your-jwt-secret-key-here
